%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Linear Algebra}}

\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{basics - math}
\date{Apr 11, 2025}
\release{}
\author{basics}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{intro::doc}}


\sphinxAtStartPar
This material is part of the \sphinxhref{https://basics2022.github.io/bbooks}{\sphinxstylestrong{basics\sphinxhyphen{}books project}}. It is also available as a \DUrole{xref,download,myst}{.pdf document}.

\sphinxAtStartPar
\sphinxstylestrong{Contents.}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Linear Algebra.} …, matrix factorization,…; basics of lots of numerical methods; \sphinxstylestrong{Vector and Tensor Algebra} provides the mathematical framework for manipulating vectors and tensors, the mathematical objects meant to represent \sphinxstylestrong{absolute quantities} \sphinxhyphen{} invariant under coordinate transformations \sphinxhyphen{} fundamental in geometry and physics.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Multivariable Calculus} provides the tools for working with continuous functions of many variables; \sphinxstylestrong{Differential Geometry} studies smooth curves, surfaces, volumes (and manifolds in general), within the framework of a Riemann structure, providing a metric to define distances, angles, curvatures and other geometric properties; \sphinxstylestrong{Vector and Tensor Calculus} studies vector and tensor fields defined on a manifold, along with their differentiation and integration, and thus being essential for a mature approach to geometry and physics;

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Functional analysis} and \sphinxstylestrong{Complex Calculus} (complex analysis, transforms,…)

\item {} 
\sphinxAtStartPar
ODEs

\item {} 
\sphinxAtStartPar
PDEs

\item {} 
\sphinxAtStartPar
Calculus of Variations: theoretical background; Lagrange multiplier method for constraints; sensitivty; gradient\sphinxhyphen{}based methods,…

\item {} 
\sphinxAtStartPar
Optimization

\end{itemize}



\sphinxstepscope


\part{Linear Algebra}

\sphinxstepscope


\chapter{Matrices}
\label{\detokenize{ch/linear-algebra/matrices:matrices}}\label{\detokenize{ch/linear-algebra/matrices:math-linear-algebra-matrix}}\label{\detokenize{ch/linear-algebra/matrices::doc}}
\sphinxAtStartPar
\(\mathbf{A} \in \mathbb{K}^{m,n} \) with usually \(\mathbb{K}^{m,n} = \mathbb{R}^{m,n}\) or \(\mathbb{C}^{m,n}\)

\sphinxAtStartPar
\sphinxstylestrong{Hermitian matrix.} The Hermitian matrix \(\mathbf{A}^*\) of a matrix \(\mathbf{A}\) is the transpose and complex conjugate matrix (if \(\mathbb{K} = \mathbb{C}\)),
\begin{equation*}
\begin{split}[\mathbf{A}^*]_{ij} = A^*_{ji} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with the notation of \(a^*\) for the complex conjugate of a numerical quantity.


\section{Subspaces}
\label{\detokenize{ch/linear-algebra/matrices:subspaces}}\label{\detokenize{ch/linear-algebra/matrices:math-linear-algebra-matrix-subspaces}}

\subsection{Range, Image}
\label{\detokenize{ch/linear-algebra/matrices:range-image}}\label{\detokenize{ch/linear-algebra/matrices:math-linear-algebra-matrix-subspaces-range}}\begin{equation*}
\begin{split}R(\mathbf{A}) = \left\{ \mathbf{y} \in \mathbb{K}^m \ | \ \exists \mathbf{x} \in \mathbb{K}^m \ , \text{ s.t. } \mathbf{A} \mathbf{x} = \mathbf{y} \right\}\end{split}
\end{equation*}
\sphinxAtStartPar
The range of a matrix \(\mathbf{A}\) is the linear space built on the columns of \(\mathbf{A}\), since the operation \(\mathbf{A} \mathbf{x}\) represents nothing but a linear combination of the columns of matrix.


\subsection{Null, Kernel}
\label{\detokenize{ch/linear-algebra/matrices:null-kernel}}\label{\detokenize{ch/linear-algebra/matrices:math-linear-algebra-matrix-subspaces-null}}\begin{equation*}
\begin{split}K(\mathbf{A}) = \left\{ \mathbf{x} \in \mathbb{K}^n \ | \ \mathbf{A} \mathbf{x} = \mathbf{0} \right\}\end{split}
\end{equation*}

\section{Theorem}
\label{\detokenize{ch/linear-algebra/matrices:theorem}}\label{\detokenize{ch/linear-algebra/matrices:math-linear-algebra-thms}}

\subsection{Orthogonality of \protect\(R(\mathbf{A})\protect\) and \protect\(K(\mathbf{A^*})\protect\)}
\label{\detokenize{ch/linear-algebra/matrices:orthogonality-of-r-mathbf-a-and-k-mathbf-a}}\label{\detokenize{ch/linear-algebra/matrices:math-linear-algebra-thms-raperpkah}}
\sphinxAtStartPar
The following holds,
\begin{equation*}
\begin{split}R(\mathbf{A}) \perp K(\mathbf{A^*}) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
meaning that \(\forall \mathbf{u} \in R(\mathbf{A})\) and \(\forall \mathbf{v} \in K(\mathbf{A}^*)\), \(\mathbf{u}^* \mathbf{v} = 0\).
\subsubsection*{Proof.}
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{u} & = \mathbf{A} \mathbf{x} \\
  \mathbf{0} & = \mathbf{A}^* \mathbf{v} 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and thus, premultiplication by \(\mathbf{x}^*\) of the second relation gives
\begin{equation*}
\begin{split}0 = \mathbf{x}^* \mathbf{0} = \underbrace{\mathbf{x}^* \mathbf{A}^*}_{=(\mathbf{A}  \mathbf{x})^* = \mathbf{u}^*} \mathbf{v} = \mathbf{u}^* \mathbf{v} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
This theorem becomes quite useful, e.g. for constrained linear systems and projections… (e.g. N\sphinxhyphen{}S, or other constrained linear systems…)

\sphinxAtStartPar
\sphinxstylestrong{todo} add links

\sphinxstepscope


\chapter{Matrix factorizations}
\label{\detokenize{ch/linear-algebra/matrix-factorization:matrix-factorizations}}\label{\detokenize{ch/linear-algebra/matrix-factorization:math-matrix-factorization}}\label{\detokenize{ch/linear-algebra/matrix-factorization::doc}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Singular Value Decomposition (SVD)}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Spectral decomposition} Eigenvalues, eigenvectors; Jordan canonical formula…

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{QR}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{LU}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Schur}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Cholesky} Symmetric positive definite matrices have Choleski decomposition,
\begin{equation*}
\begin{split}\mathbf{M} = \mathbf{L} \mathbf{L}^* \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\mathbf{L}\) lower triangular matrix. And thus quite easy to “invert”, for solving linear systems.

\end{itemize}

\sphinxstepscope


\section{Singular Value Decomposition}
\label{\detokenize{ch/linear-algebra/svd:singular-value-decomposition}}\label{\detokenize{ch/linear-algebra/svd:math-svd}}\label{\detokenize{ch/linear-algebra/svd::doc}}
\sphinxAtStartPar
Singular value decomposition of a matrix \(\mathbf{A} \in \mathbb{C}^{m,n}\)
\begin{equation*}
\begin{split}\mathbf{A}_{(m,n)} = \text{(SVD)} = \mathbf{U}_{(m,m)} \mathbf{S}_{(m,n)} \mathbf{V}^*_{(n,n)}\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\mathbf{U}^* \mathbf{U} = \mathbf{I}_{(m,m)}\), and \(\mathbf{V}^* \mathbf{V} = \mathbf{I}_{(n,n)}\), \(\mathbf{S} = \text{diag}\{ \sigma_i \}\), \(\sigma_i \ge 0\).

\sphinxAtStartPar
Exploiting the definition of matrix product, the SVD of matrix A can be written as
\begin{equation*}
\begin{split}\mathbf{A} = \sum_{i = \min(m,n)} \sigma_i \mathbf{u}_i \mathbf{v}^*_i \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
see also economic decomposition below.


\subsection{Properties}
\label{\detokenize{ch/linear-algebra/svd:properties}}\label{\detokenize{ch/linear-algebra/svd:math-svd-properties}}
\sphinxAtStartPar
\sphinxstylestrong{Relation with {\hyperref[\detokenize{ch/linear-algebra/matrices:math-linear-algebra-matrix-subspaces-range}]{\sphinxcrossref{\DUrole{std,std-ref}{range}}}} and {\hyperref[\detokenize{ch/linear-algebra/matrices:math-linear-algebra-matrix-subspaces-null}]{\sphinxcrossref{\DUrole{std,std-ref}{kernel}}}} the matrix.}
\begin{equation*}
\begin{split}\begin{aligned}
  \text{R}(\mathbf{A})   & = \{ \mathbf{u}_i | \sigma_i > 0 \} \\
  \text{K}(\mathbf{A})   & = \{ \mathbf{v}_i | \sigma_i = 0 \} \\
  \text{R}(\mathbf{A}^*) & = \{ \mathbf{v}_i | \sigma_i > 0 \} \\
  \text{K}(\mathbf{A}^*) & = \{ \mathbf{u}_i | \sigma_i = 0\} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
It’s immediate to prove {\hyperref[\detokenize{ch/linear-algebra/matrices:math-linear-algebra-thms-raperpkah}]{\sphinxcrossref{\DUrole{std,std-ref}{\(\text{R}(\mathbf{A}) \perp \text{K}(\mathbf{A^*})\)}}}}.

\sphinxAtStartPar
\sphinxstylestrong{Full or economic decomposition.} In general the \(\mathbf{S}\) of the full decompsition in not square.
\begin{equation*}
\begin{split}\mathbf{A} = \text{(SVD)} = \mathbf{U}_{(m,m)} \mathbf{S}_{(m,n)} \mathbf{V}^*_{(n,n)} = \mathbf{U}^e_{(m,k)} \mathbf{S}^e_{(k,k)} \mathbf{V}^{e *}_{(k,n)} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(k = \min(m,n)\).


\subsection{Applications}
\label{\detokenize{ch/linear-algebra/svd:applications}}\label{\detokenize{ch/linear-algebra/svd:math-svd-applications}}

\subsubsection{Solution of under\sphinxhyphen{}determined linear systems}
\label{\detokenize{ch/linear-algebra/svd:solution-of-under-determined-linear-systems}}

\subsubsection{Norms and optimization}
\label{\detokenize{ch/linear-algebra/svd:norms-and-optimization}}
\sphinxAtStartPar
If \(L^2\)\sphinxhyphen{}norm is used for vector norms, see {\hyperref[\detokenize{ch/linear-algebra/svd:svd-optimization-norm}]{\sphinxcrossref{Example 2.1.1}}}
\begin{equation*}
\begin{split}\text{Find } \max_{||\mathbf{x}||=1} ||\mathbf{A} \mathbf{x}||^2\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{x}^* \mathbf{A}^* \mathbf{A} \mathbf{x} = \mathbf{x}^* \mathbf{V} \mathbf{S}^* \underbrace{\mathbf{U}^* \mathbf{U}}_{\mathbf{I}} \mathbf{S} \underbrace{\mathbf{V}^* \mathbf{x}}_{\mathbf{z}}\end{split}
\end{equation*}
\sphinxAtStartPar
and \(\mathbf{z} = \mathbf{V}^* \mathbf{x}\) is unitary as well (since \(1= \mathbf{x}^* \mathbf{x} = \mathbf{z}^* \mathbf{V}^* \mathbf{V} \mathbf{z} = \mathbf{z}^* \mathbf{z} \)).

\sphinxAtStartPar
After defining \(\mathbf{S}_2 := \mathbf{S}^* \mathbf{S}\), the problem thus becomes
\begin{equation*}
\begin{split}\text{Find} \max_{||\mathbf{z}|| = 1} \mathbf{z}^* \mathbf{S}_2 \mathbf{z}\end{split}
\end{equation*}
\sphinxAtStartPar
Manipulating the objective function as \(\sum_{i} \sigma_i^2 |z_i|^2 \), the constraint optimization problem has global maximum \(\sigma_1^2\) (sorted singular values from the largest to the smalles) when \(\mathbf{z}_1 = (1,0,0,\dots,0)^T\). Going back to the original variable, optimal condition
\begin{itemize}
\item {} 
\sphinxAtStartPar
is achieved for \(\mathbf{x}_1 = \mathbf{v}_1\);

\item {} 
\sphinxAtStartPar
has value \(\max_{||\mathbf{x}||=1}||\mathbf{A}\mathbf{x}|| = \sigma_1^2\)

\item {} 
\sphinxAtStartPar
and the response of the system is \(\mathbf{y}_1 = \sigma_1 \mathbf{u}_1\) as
\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{y}_1
    := \mathbf{A} \mathbf{x}_1 
    = \mathbf{U} \mathbf{S} \mathbf{V}^* \mathbf{v}_1 
    = \sum_{k} \left( \sigma_k \mathbf{u}_k \mathbf{v}_k^* \right) \mathbf{v}_1 
    = \sigma_1 \mathbf{u}_1 \ .
  \end{aligned}\end{split}
\end{equation*}
\end{itemize}
\label{ch/linear-algebra/svd:svd-optimization-norm}
\begin{sphinxadmonition}{note}{Example 2.1.1 (Other norms \sphinxhyphen{} variations of the \protect\(L^2\protect\)\sphinxhyphen{}norm)}



\sphinxAtStartPar
This kind of problem may results as the discrete counterpart of a continuous problem, as an example from {\hyperref[\detokenize{ch/pde/fem:pde-fem}]{\sphinxcrossref{\DUrole{std,std-ref}{finite element methods}}}}, where \(\mathbf{x}\), \(\mathbf{y}\) contain the coefficients of the basis functions. In this case, the discrete counterpart of the continous norm\sphinxhyphen{}measure of the continuous fields may involve a “mass matrix” (symmetric, definite positive \sphinxhyphen{} and thus with Choloeski factorization…),
\begin{equation*}
\begin{split}\begin{aligned}
  \int_{\Omega_x} |x(\vec{r})|^2 d \vec{r} & \simeq \mathbf{x}^* \mathbf{M}_x \mathbf{x} \\
  \int_{\Omega_y} |y(\vec{r})|^2 d \vec{r} & \simeq \mathbf{y}^* \mathbf{M}_y \mathbf{y}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Continuous and discrete optimization problems are
\begin{equation*}
\begin{split}\text{Find } \max_{|x(\vec{r})|_{L^2(\Omega_x)}=1} |y|^2_{L^2(\Omega_y)} \end{split}
\end{equation*}\begin{equation*}
\begin{split}\text{Find } \max_{\mathbf{x}^*\mathbf{M}_x  \mathbf{x}=1} \mathbf{x}^* \mathbf{A}^* \mathbf{M}_y \mathbf{A} \mathbf{x} \end{split}
\end{equation*}
\sphinxAtStartPar
with the relation \(\mathbf{y} = \mathbf{A} \mathbf{x}\) between the discrete input and output.

\sphinxAtStartPar
This problem can be easily (and efficiently?) recast to the standard form of the problem, using {\hyperref[\detokenize{ch/linear-algebra/matrix-factorization:math-matrix-factorization}]{\sphinxcrossref{\DUrole{std,std-ref}{Cholesky decomposition}}}} of matrix \(\mathbf{M}_x = \mathbf{L}_x \mathbf{L}_x^*\), with the definition of the variable \(\mathbf{z} = \mathbf{L}_x^* \mathbf{x}\)
\begin{equation*}
\begin{split}\text{Find } \max_{||\mathbf{z}||=1} \mathbf{z}^* \mathbf{L}_x^{-1} \mathbf{A}^* \mathbf{L}_y \mathbf{L}_y^* \mathbf{A} \mathbf{L}_x^{-*} \mathbf{z} \end{split}
\end{equation*}
\sphinxAtStartPar
This problem can be efficiently solved with iterative algorithms to compute the SVD of the matrix \(\widetilde{\mathbf{A}} := \mathbf{L}_y^* \mathbf{A} \mathbf{L}_x^{-*}\), that doesn’t need the expensive full inversion of a matrix but only its action on a vector (instead of evaluating the inverse, a linear system \sphinxhyphen{} here triangular! Easier to solve \sphinxhyphen{} can be efficiently solved). Algorithms like \sphinxstylestrong{Arnoldi algorithm} evaluates the largest eigenvalues or singular values(if no options to set other goals) and the corresponding eigenvectors and singular vectors, alternating \sphinxstylestrong{power iterations} and \sphinxstylestrong{orthogonalization}. Here power iteration to evaluate the action of the matrix \(\widetilde{\mathbf{A}} = \mathbf{L}_y^* \mathbf{A}\mathbf{L}_x^{-*}\) on a generic vector \(\mathbf{z}\) is made of the following steps:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
solution of the linear system \(\mathbf{L}^*_x \mathbf{a} = \mathbf{z}\) \(\rightarrow \ \mathbf{a} = \dots\)

\item {} 
\sphinxAtStartPar
matrix\sphinxhyphen{}vector multiplication \(\mathbf{b} = \mathbf{A} \mathbf{a}\)

\item {} 
\sphinxAtStartPar
matrix\sphinxhyphen{}vector multiplication \(\mathbf{c} = \mathbf{L}^*_y \mathbf{b}\)

\end{enumerate}

\sphinxAtStartPar
Once the SVD is solved, with \(\mathbf{z}_1 = \mathbf{v}_1\)
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{x}_1 & = \mathbf{L}_x^{-*} \mathbf{v}_1 \\
  \mathbf{y}_1 & = \mathbf{A} \mathbf{x}_1 = \sigma_1 \mathbf{L}_y^{-*} \mathbf{u}_1 \\
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}

\sphinxstepscope


\chapter{Linear Systems}
\label{\detokenize{ch/linear-algebra/linear-systems:linear-systems}}\label{\detokenize{ch/linear-algebra/linear-systems:math-linear-algebra-linear-sys}}\label{\detokenize{ch/linear-algebra/linear-systems::doc}}
\sphinxAtStartPar
The linear system
\begin{equation*}
\begin{split}\mathbf{A} \mathbf{x} = \mathbf{b}\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\mathbf{A} \in \mathbb{R}^{m,n}\), \(\mathbf{x} \in \mathbb{R}^n\), \(\mathbf{b} \in \mathbb{R}^m\) has solution if there exists (at least) a vector \(\widetilde{\mathbf{x}}\) whose product with \(\mathbf{A}\) gives \(\mathbf{b}\).

\sphinxAtStartPar
\sphinxstylestrong{Condition for the existence of a solution.}
A solution exists if \(\mathbf{b}\) belongs to the {\hyperref[\detokenize{ch/linear-algebra/matrices:math-linear-algebra-matrix-subspaces-range}]{\sphinxcrossref{\DUrole{std,std-ref}{range of \(\mathbf{A}\)}}}}.

\sphinxAtStartPar
\sphinxstylestrong{Uniqueness of a solution.} If a solution \(\widetilde{\mathbf{x}}\) exists, it’s unique if the {\hyperref[\detokenize{ch/linear-algebra/matrices:math-linear-algebra-matrix-subspaces-null}]{\sphinxcrossref{\DUrole{std,std-ref}{kernel of \(\mathbf{A}\)}}}} is empty, \(K(\mathbf{A}) = \emptyset\). If the kernel is not empty,
\begin{equation*}
\begin{split}\mathbf{b} = \mathbf{A}(\widetilde{\mathbf{x}} + \mathbf{u}) =  \mathbf{A}\widetilde{\mathbf{x}} + \underbrace{\mathbf{A} \mathbf{u}}_{=\mathbf{0}} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
for \(\forall \mathbf{u} \in K(\mathbf{A})\), and thus an infinite number of solutions exists. Given a vector basis of the kernel \(\mathbf{K}(\mathbf{A})\), where \(\text{dim}\left( K(\mathbf{A}) \right) = n_K\), \(\{ \mathbf{u}_1, \dots, \mathbf{u}_{n_K} \}\), the general solution has \(n_K\) “degrees of arbitrarieness”, since the general solution of the problem is
\begin{equation*}
\begin{split}\widetilde{\mathbf{x}} + \sum_{i = 1}^{n_K} a_i \mathbf{u}_i = \widetilde{\mathbf{x}} + \mathbf{U} \mathbf{a} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} treat under\sphinxhyphen{}, det\sphinxhyphen{}, over\sphinxhyphen{}determined lin sys

\sphinxstepscope


\part{Multivariable Calculus}

\sphinxstepscope


\chapter{Introduction to multi\sphinxhyphen{}variable calculus}
\label{\detokenize{ch/multivariable/intro:introduction-to-multi-variable-calculus}}\label{\detokenize{ch/multivariable/intro:multivariable-calculus}}\label{\detokenize{ch/multivariable/intro::doc}}

\section{Function}
\label{\detokenize{ch/multivariable/intro:function}}\label{\detokenize{ch/multivariable/intro:multivariable-calculus-fun}}

\section{Limit}
\label{\detokenize{ch/multivariable/intro:limit}}\label{\detokenize{ch/multivariable/intro:multivariable-calculus-lim}}

\section{Derivatives}
\label{\detokenize{ch/multivariable/intro:derivatives}}\label{\detokenize{ch/multivariable/intro:multivariable-calculus-der}}

\section{Integrals}
\label{\detokenize{ch/multivariable/intro:integrals}}\label{\detokenize{ch/multivariable/intro:multivariable-calculus-int}}

\section{Theorems}
\label{\detokenize{ch/multivariable/intro:theorems}}

\subsection{Green’s lemma}
\label{\detokenize{ch/multivariable/intro:green-s-lemma}}\label{\detokenize{ch/multivariable/intro:multivariable-calculus-green-lemma}}\begin{equation*}
\begin{split}\begin{aligned}
  \int_{S} \frac{\partial F}{\partial y} dx dy & =     - \oint_{\partial S} F dx \\
  \int_{S} \frac{\partial G}{\partial x} dx dy & = \quad \oint_{\partial S} G dy   
\end{aligned}\end{split}
\end{equation*}\subsubsection*{Proof for simple domains.}

\sphinxAtStartPar
In a simple domain in  \(x\), so that the closed contour \(\partial S\) is delimited by the curves \(y=Y_1(x)\), \(y=Y_2(x) > Y_1(x)\), for \(x \in [x_1, x_2]\),
\begin{equation*}
\begin{split}\begin{aligned}
  \int_{S} \frac{\partial F}{\partial y} dx dy 
  & =   \int_{x=x_1}^{x_2} \int_{y = Y_1(x)}^{Y_2(x)} \frac{\partial F}{\partial y} dy \, dx = \\
  & =   \int_{x=x_1}^{x_2} \left[ F(x,Y_2(x)) - F(x,Y_1(x)) \right] dx = \\
  & = - \int_{x=x_1}^{x_2} F(x,Y_1(x)) - \int_{x=x_2}^{x_1} F(x, Y_2(x)) dx = \\
  & = - \oint_{\partial S} F(x,y) dx 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
In a simple domain in  \(y\), so that the closed contour \(\partial S\) is delimited by the curves \(x=X_1(y)\), \(x=X_2(y) > X_1(y)\) for \(y \in [y_1, y_2]\),
\begin{equation*}
\begin{split}\begin{aligned}
  \int_{S} \frac{\partial G}{\partial x} dx dy 
  & = \int_{y=y_1}^{y_2} \int_{x = X_1(y)}^{X_2(y)} \frac{\partial G}{\partial x} dx \, dy = \\
  & = \int_{y=y_1}^{y_2} \left[ G(X_2(y),y) - G(X_1(y),y) \right] dy = \\
  & = \int_{y=y_1}^{y_2} G(X_1(y),y) dy + \int_{y=y_2}^{y_1} G(X_2(y),y) dy = \\
  & = \oint_{\partial S} G(x,y) dy 
\end{aligned}\end{split}
\end{equation*}
\sphinxstepscope


\part{Differential Geometry}

\sphinxstepscope


\chapter{Introduction to Differential Geometry}
\label{\detokenize{ch/differential-geometry/intro:introduction-to-differential-geometry}}\label{\detokenize{ch/differential-geometry/intro:differential-geometry-intro}}\label{\detokenize{ch/differential-geometry/intro::doc}}

\section{Differential geometry in \protect\(E^3\protect\)}
\label{\detokenize{ch/differential-geometry/intro:differential-geometry-in-e-3}}

\subsection{Curves}
\label{\detokenize{ch/differential-geometry/intro:curves}}
\sphinxAtStartPar
Parametric representation of curve in 3\sphinxhyphen{}dimensional (Euclidean) space \(E^3\)
\begin{equation*}
\begin{split}\vec{r}(q)\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Differential, \(d \vec{r}\).}
\begin{equation*}
\begin{split}d \vec{r}(q) = \vec{r}'(q) \, d q \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Arc\sphinxhyphen{}length parameter, \(s\).} So that \(d s = |d \vec{r}(s)|\) and thus
\begin{equation*}
\begin{split}|d \vec{r}(s)| = |\vec{r}'(s)| \, |d s| \qquad \rightarrow \qquad |\vec{r}'(s)| = 1 \qquad \rightarrow \qquad \vec{r}'(s) = \hat{t}(s) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Frenet basis.} Using arc\sphinxhyphen{}length parameter, Frenet basis is naturally defined as the set \(\{ \hat{t}, \hat{n}, \hat{b} \}\):
\begin{itemize}
\item {} 
\sphinxAtStartPar
tangent unit vector, \(\hat{t}(s) = \vec{r}'(s)\),

\item {} 
\sphinxAtStartPar
normal unit vector, \(\hat{r}''(s) = \hat{t}'(s) =: \kappa(s) \, \hat{n}(s) \), with \(\kappa(s)\) local curvature

\item {} 
\sphinxAtStartPar
binormal unit vector, \(\hat{b}(s) = \hat{t}(s) \times \hat{n}(s)\)

\end{itemize}

\sphinxAtStartPar
Using a general parameter, \(t\), with some abuse of notation \(\vec{r}(t) = \vec{r}(s(t))\) and indicating \(\dot{()} = \frac{d}{dt}\),
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\dot{\vec{r}} = \frac{d s}{d t} \frac{d \vec{r}}{d s} = \dot{s} \hat{t}\)

\item {} 
\sphinxAtStartPar
\(\ddot{\vec{r}} = \dfrac{d}{dt} \dot{\vec{r}} = \dfrac{d}{dt} \left( \dot{s} \hat{t} \right) = \ddot{s} \hat{t} + \dfrac{ds}{dt} \dfrac{d}{ds} \hat{t} = \ddot{s} \hat{t} + \dot{s}^2 \kappa \, \hat{n}\)

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Osculator circle.} Circle with \(R(s) = \frac{1}{\kappa(s)}\), in plane orthogonal to \(\hat{b}(s)\), passing through \(\vec{r}(s)\), and thus center in \(\vec{r}_C(s) = \vec{r}(s) + \hat{n} R(s)\). Its parametric representation using its arc\sphinxhyphen{}length parameter \(p\), with \(\vec{r}(p=0) = \vec{r}(s)\) reads
\begin{equation*}
\begin{split}\vec{r}(p) = \vec{r}_C(s) + R(s) \left[ - \cos \left(\frac{p}{R(s)} \right) \hat{n}(s) + \sin \left(\frac{p}{R(s)}  \right)\hat{t}(s) \right] \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Its first and second order derivatives w.r.t. the arc\sphinxhyphen{}length \(p\) evaluated in \(p=0\), i.e. \(\vec{r} = \vec{r}(s)\) read:
\begin{itemize}
\item {} 
\sphinxAtStartPar
first derivative in \(p=0\),
\begin{equation*}
\begin{split}\left.\hat{t}(p)\right|_{p=0} = \left.\vec{r}'(p)\right|_{p=0} = \left.  \left[ \sin \left(\frac{p}{R(s)} \right) \hat{n}(s) + \cos \left(\frac{p}{R(s)}  \right)\hat{t}(s) \right] \right|_{p=0} = \hat{t}(s) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
i.e. the osculator circle has the same tangent as the curve in the point.

\item {} 
\sphinxAtStartPar
second derivative in \(p=0\),
\begin{equation*}
\begin{split}\left. \kappa(p) \hat{n}(p)\right|_{p=0} = \left.\vec{r}''(p)\right|_{p=0} = \frac{1}{R(s)} \left.  \left[ \cos \left(\frac{p}{R(s)} \right) \hat{n}(s) - \sin \left(\frac{p}{R(s)}  \right)\hat{t}(s) \right] \right|_{p=0} = \frac{1}{R(s)}\hat{n}(s) = \kappa(s) \hat{n}(s) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
i.e. the osculator circle has the same normal vector and curvature as the curve in the point.

\end{itemize}


\subsection{Surfaces}
\label{\detokenize{ch/differential-geometry/intro:surfaces}}\begin{equation*}
\begin{split}\vec{r}(q^1, q^2)\end{split}
\end{equation*}\begin{equation*}
\begin{split}d \vec{r} =
  \frac{\partial \vec{r}}{\partial q^1} \, d q^1 + \frac{\partial \vec{r}}{\partial q^2} \, d q^2 =
  \vec{b}_1 \, d q^1 + \vec{b}_2 \, d q^2
\end{split}
\end{equation*}
\sphinxAtStartPar
A third vector \(\vec{b}_3 := \hat{n}\) can be defined so that \(|\hat{n}| = 1\) and \(\hat{n} \cdot \vec{b}_{i} = 0\), \(i=1:2\). For \(i=1:2\), \(k=1:2\)
\begin{equation*}
\begin{split}\frac{\partial \vec{b}_i}{\partial q^j} = \Gamma_{ij}^k \vec{b}_k = \Gamma_{ij}^1 \vec{b}_1 + \Gamma_{ij}^2 \vec{b}_2 + \Gamma_{ij}^3 \vec{b}_3\end{split}
\end{equation*}
\sphinxAtStartPar
so that
\begin{equation*}
\begin{split}\Gamma_{ij}^{k} = \vec{b}^k \cdot \frac{\partial \vec{b}_i}{\partial q^j}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Normal vector.}
\begin{equation*}
\begin{split}\vec{n}(q^1, q^2) = \frac{\partial \vec{r}}{\partial q^1}(q^1, q^2) \times \frac{\partial \vec{r}}{\partial q^2}(q^1, q^2) = \vec{b}_1(q^1, q^2) \times \vec{b}_2(q^1, q^2)\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Tangent plane.}
\begin{equation*}
\begin{split}(\vec{r} - \vec{r}(q^1, q^2)) \cdot \vec{n}(q^1, q^2) = 0\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Length of elementary segment.}
\begin{equation*}
\begin{split}\begin{aligned}
|d \vec{r}|^2 
  & = d \vec{r} \cdot d \vec{r} = \\
  & = \left( \vec{b}_1 \, d q^1 + \vec{b}_2 \, d q^2 \right) \cdot \left( \vec{b}_1 \, d q^1 + \vec{b}_2 \, d q^2 \right) = \\
  & = g_{11} \, dq^1 \, dq^1 + g_{12} \, dq^1 \, dq^2 + g_{21} \, dq^2 \, dq^1 + g_{22} \, dq^2 \, d q^2 = g_{ij} \, dq^i \, dq^j 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Second order approximation.}
\begin{equation*}
\begin{split}\begin{aligned}
  \vec{r}(q^1 + d q^1, q^2 + d q^2) 
  & = \vec{r}(q_1, q_2) + \frac{\partial \vec{r}}{\partial q^i} \, dq^i + \frac{\partial^2 \vec{r}}{\partial q^i \partial q^j} \, dq^i \, dq^j = \\
  & = \vec{r}(q_1, q_2) + \vec{b}_{i} \, dq^i + \vec{b}_k \Gamma^{k}_{ij} \, dq^i \, dq^j +  \hat{n} \, \Gamma^{3}_{ij} \, dq^i \, dq^j 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that
\begin{equation*}
\begin{split}\begin{aligned}
\left[ \vec{r}(q^1 + d q^1, q^2 + d q^2) - \vec{r}(q^1, q^2) \right] \cdot \hat{n} 
 & = \Gamma^3_{ij} \, d q^i \, dq^j = \\
 & = \hat{n} \cdot \frac{\partial^2 \vec{r}}{\partial q^i \partial q^j} \, d q^i \, dq^j = \\
 & = \hat{n} \cdot \frac{\partial^2 \vec{r}}{\partial q^i \partial q^j} \, \vec{b}^i \cdot \vec{b}_k d q^k \, \vec{b}^j \cdot \vec{b}_l dq^l = \\
 & = \underbrace{d q^k \vec{b}_k}_{d \vec{r}} \cdot \left[ \hat{n} \cdot \frac{\partial^2 \vec{r}}{\partial q^i \partial q^j}  \vec{b}^i \otimes \vec{b}^j \right] \cdot \underbrace{d q^l \vec{b}_l}_{d\vec{r}}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Curvature tensor.}

\sphinxstepscope


\part{Vector and Tensor Algebra and Calculus}

\sphinxstepscope


\chapter{Tensor Algebra}
\label{\detokenize{ch/tensor-algebra-calculus/algebra:tensor-algebra}}\label{\detokenize{ch/tensor-algebra-calculus/algebra:id1}}\label{\detokenize{ch/tensor-algebra-calculus/algebra::doc}}

\section{Basis}
\label{\detokenize{ch/tensor-algebra-calculus/algebra:basis}}\label{ch/tensor-algebra-calculus/algebra:definition-0}
\begin{sphinxadmonition}{note}{Definition 6.1.1 (Basis)}


\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/algebra:definition-1}
\begin{sphinxadmonition}{note}{Definition 6.1.2 (Reciprocal basis)}



\sphinxAtStartPar
In a inner product space, the reciprocal basis of a given basis \(\{ \vec{b}_a \}_{a=1:d}\) is the set of vectors \(\{ \vec{b}_{b} \}_{b=1:d}\), s.t.
\begin{equation*}
\begin{split}\vec{b}^b \cdot \vec{b}_a = \delta_a^b \ .\end{split}
\end{equation*}\end{sphinxadmonition}


\section{Exterior algebra}
\label{\detokenize{ch/tensor-algebra-calculus/algebra:exterior-algebra}}\begin{equation*}
\begin{split}\land\end{split}
\end{equation*}

\section{Exterior product}
\label{\detokenize{ch/tensor-algebra-calculus/algebra:exterior-product}}
\sphinxAtStartPar
Generalization of the vector product

\sphinxstepscope


\chapter{Tensor Calculus in Euclidean Spaces}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-in-euclidean-spaces}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean::doc}}
\sphinxAtStartPar
This section deals with tensor calculus in Euclidean space or on manifolds embedded in Euclidean spaces, focusing on \(d\)\sphinxhyphen{}dimensional spaces with \(d \le 3\), with \sphinxstyleemphasis{inner product}.

\sphinxAtStartPar
This section may rely on results of {\hyperref[\detokenize{ch/differential-geometry/intro:differential-geometry-intro}]{\sphinxcrossref{\DUrole{std,std-ref}{differential geometry}}}}.


\section{Coordinates}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:coordinates}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-coordinates}}
\sphinxAtStartPar
A set of parameters \(\{q^a\}_{a=1:d}\) to represent vector (or point) in space,
\begin{equation*}
\begin{split}\vec{r}(q^a)\end{split}
\end{equation*}
\sphinxAtStartPar
if \(\vec{r} \in E^{d}\), \(a=1:d\).

\sphinxAtStartPar
In \(E^3\),
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Coordinate lines}, 2\sphinxhyphen{}parameter family of lines, keeping 2 coordinates constant. As an example, coordinate lines with constant \(q^2, \, q^3\)
\begin{equation*}
\begin{split}\vec{r}_1(q^1) = \vec{r}(q^1, \bar{q}^2, \bar{q}^3) \ .\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Coordinate surfaces,} 1\sphinxhyphen{}parameter family of surfaces, keeping 1 coordinate constant. As an example, coordinate surfaces with constant \(q^1\),
\begin{equation*}
\begin{split}\vec{r}_{23}(q^2, q^3) = \vec{r}(\bar{q}^1, q^2, q^3) \ .\end{split}
\end{equation*}
\end{itemize}
\label{ch/tensor-algebra-calculus/calculus-euclidean:definition-0}
\begin{sphinxadmonition}{note}{Definition 7.1.1 (Regular parametrization)}



\sphinxAtStartPar
If \(\frac{\partial \vec{r}}{\partial q^a} \ne 0\).
\end{sphinxadmonition}


\subsection{Natural basis}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:natural-basis}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-coordinates-natural-basis}}\label{ch/tensor-algebra-calculus/calculus-euclidean:definition-1}
\begin{sphinxadmonition}{note}{Definition 7.1.2 (Natural basis)}



\sphinxAtStartPar
Vectors of natural basis
\begin{equation*}
\begin{split}\vec{b}_a := \frac{\partial \vec{r}}{\partial q^a}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean:definition-2}
\begin{sphinxadmonition}{note}{Definition 7.1.3 (Reciprocal basis (\sphinxstylestrong{todo} move to Tensor Algebra))}



\sphinxAtStartPar
Given a basis \(\{ \vec{b}_a \}_{a}\), its reciprocal basis the set of vector \(\{ \vec{b}^b \}_b\) defined as
\begin{equation*}
\begin{split}\vec{b}^b \cdot \vec{b}_a = \delta_{a}^b \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
being \(\delta_a^b\) Kronecker delta.
\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean:definition-3}
\begin{sphinxadmonition}{note}{Definition 7.1.4 (Christoffel symbols)}



\sphinxAtStartPar
Christoffel symbols (of the \(2^{nd}\) kind) are defined as the components of the partial derivatives of the vectors of a natural basis w.r.t. the coordinates referred to the natural basis itself,
\begin{equation}\label{equation:ch/tensor-algebra-calculus/calculus-euclidean:def:christoffel:2}
\begin{split}\dfrac{\partial \vec{b}_a}{\partial q^b} = \Gamma_{ab}^c \, \vec{b}_c\end{split}
\end{equation}\end{sphinxadmonition}
\subsubsection*{Properties of Christoffel symbols}

\sphinxAtStartPar
Exploiting the definition of reciprocal basis, Christoffel symbols can be written as
\begin{equation*}
\begin{split}\Gamma_{ab}^c = \vec{b}^c \cdot \dfrac{\partial \vec{b}_a}{\partial q^b} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Symmetry.} Symmetry os the lower indices
\begin{equation*}
\begin{split}\Gamma_{ab}^{c} = \Gamma_{ba}^c \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
readily follows Schwartz theorem about partial derivatives
\begin{equation*}
\begin{split}\dfrac{\partial \vec{b}_a}{\partial q^b} = \dfrac{\partial}{\partial q^c}\dfrac{\partial \vec{r}}{\partial q^a} = \dfrac{\partial}{\partial q^a}\dfrac{\partial \vec{r}}{\partial q^b} = \dfrac{\partial \vec{b}_b}{\partial q^a}\end{split}
\end{equation*}

\section{Fields}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:fields}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-fields}}
\sphinxAtStartPar
Function of the points in space \(F: E^d \rightarrow V^r\), being \(V^r\) a space of tensors of order \(r\).


\section{Differential operators}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:differential-operators}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-differential-operators}}

\subsection{Directional derivative}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:directional-derivative}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-differential-operators-directional-derivative}}\begin{equation*}
\begin{split}F(\vec{r}) = F\left(\vec{r}\left(q^a\right)\right) = f(q^a)\end{split}
\end{equation*}\begin{equation*}
\begin{split}f(q^a + \beta \Delta q^a) = F(\vec{r}(q^a + \beta \Delta q^a))\end{split}
\end{equation*}\begin{equation*}
\begin{split}\vec{r}(q^a) + \alpha \vec{v} = \vec{r}(q^a + \beta \Delta q^a) \sim \vec{r}(q^a) + \frac{\partial \vec{r}}{\partial q^b} \beta \Delta q^b \end{split}
\end{equation*}\begin{equation*}
\begin{split}\alpha \vec{v} \sim \beta \frac{\partial \vec{r}}{\partial q^b}(q^a) \, \Delta q^b = \beta \vec{b}_b(q^a) \Delta q^b
\qquad \rightarrow \qquad \Delta q^b = \frac{\alpha}{\beta} \vec{b}^b(q^a) \cdot \vec{v} \end{split}
\end{equation*}
\sphinxAtStartPar
The directional derivative for an arbitrary vector \(\vec{v} \in V\)
\begin{equation*}
\begin{split}\frac{d}{d \alpha} F(\vec{r} + \alpha \vec{v})\bigg|_{\alpha = 0}\end{split}
\end{equation*}
\sphinxAtStartPar
is evaluated as the limit for \(\alpha \rightarrow 0\) of the incremental ratio
\begin{equation*}
\begin{split}\begin{aligned}
 \frac{F(\vec{r} + \alpha \vec{v}) - F(\vec{r})}{\alpha} 
 & \sim \frac{f(q^a + \beta \Delta q^a) - f(q^a)}{\alpha} = \\ 
 & \sim \frac{1}{\alpha} \frac{\partial f}{\partial q^b}(q^a) \beta \Delta q^b = \\
 & \sim \vec{v} \cdot \vec{b}^b(q^a) \frac{\partial f}{\partial q^b}(q^a) = \\
 & = \vec{v} \cdot \nabla F(\vec{r})
\end{aligned}\end{split}
\end{equation*}

\subsection{Gradient}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:gradient}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-differential-operators-gradient}}
\sphinxAtStartPar
The gradient is the differential operator is the first\sphinxhyphen{}order differential operator appearing in the definition of the directional derivative, \(\nabla F(\vec{r})\). It takes a tensor field \(F(\vec{r})\) of order \(r\) and gives a tensor field \(\nabla F(\vec{r})\) of order \(r+1\). Given a set of coordinates \(\{q^a\}_{a=1:d}\), the gradient can be written using the reciprocal basis of the natural basis as
\begin{equation}\label{equation:ch/tensor-algebra-calculus/calculus-euclidean:def:grad:q}
\begin{split}\nabla F(\vec{r}) = \vec{b}^b(\vec{r}) \frac{\partial F}{\partial q^b}(\vec{r})\end{split}
\end{equation}
\sphinxAtStartPar
\sphinxstylestrong{Examples.} …
\label{ch/tensor-algebra-calculus/calculus-euclidean:example-4}
\begin{sphinxadmonition}{note}{Example 7.3.1 (Gradient of a scalar field \sphinxhyphen{} with general coordinates \protect\(q^{a}\protect\))}



\sphinxAtStartPar
Applying the definition \eqref{equation:ch/tensor-algebra-calculus/calculus-euclidean:def:grad:q} of gradient operator, it readily follows
\begin{equation*}
\begin{split}\nabla F = \vec{b}^a \dfrac{\partial F}{\partial q^a}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean:example-5}
\begin{sphinxadmonition}{note}{Example 7.3.2 (Gradient of a vector field \sphinxhyphen{} with general coordinates \protect\(q^{a}\protect\))}



\sphinxAtStartPar
Applying the definition \eqref{equation:ch/tensor-algebra-calculus/calculus-euclidean:def:grad:q} of gradient operator, rule for the derivative of a product and the definition \eqref{equation:ch/tensor-algebra-calculus/calculus-euclidean:def:christoffel:2} of Christoffel symbols to write derivatives of base vectors,
\begin{equation*}
\begin{split}\begin{aligned}
  \nabla F 
  & = \vec{b}^a \dfrac{\partial}{\partial q^a} \left( F^b \vec{b}_b \right) = \\
  & = \vec{b}^a \left[ \dfrac{\partial F^b}{\partial q^a} \vec{b}_b + F^b \dfrac{\partial \vec{b}_b}{\partial q^a} \right] = \\
  & = \vec{b}^a \left[ \dfrac{\partial F^b}{\partial q^a} \vec{b}_b + F^b \, \Gamma_{ab}^c \, \vec{b}_c \right] = \\
  & = \vec{b}^a \otimes \vec{b}_b \left[ \dfrac{\partial F^b}{\partial q^a} + \Gamma_{ac}^b \, F^c \right] \ .
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean:example-6}
\begin{sphinxadmonition}{note}{Example 7.3.3 (Gradient of a \protect\(2^{nd}\protect\)\sphinxhyphen{}order tensor field \sphinxhyphen{} with general coordinates \protect\(q^{a}\protect\))}



\sphinxAtStartPar
Applying the definition \eqref{equation:ch/tensor-algebra-calculus/calculus-euclidean:def:grad:q} of gradient operator, rule for the derivative of a product and the definition \eqref{equation:ch/tensor-algebra-calculus/calculus-euclidean:def:christoffel:2} of Christoffel symbols to write derivatives of base vectors,
\begin{equation*}
\begin{split}\begin{aligned}
  \nabla F 
  & = \vec{b}^a \dfrac{\partial}{\partial q^a} \left( F^{bc} \vec{b}_b \otimes \vec{b}_c \right) = \\
  & = \vec{b}^a \left[ \dfrac{\partial F^{bc}}{\partial q^a} \vec{b}_b \, \vec{b}_c + F^{bc} \dfrac{\partial \vec{b}_b}{\partial q^a} \, \vec{b}_c + F^{bc} \vec{b}_b \dfrac{\partial \vec{b}_c}{\partial q^a} \right] = \\
  & = \vec{b}^a \left[ \dfrac{\partial F^{bc}}{\partial q^a} \vec{b}_b \, \vec{b}_c + F^{bc} \Gamma_{ab}^d \, \vec{b}_d \, \vec{b}_c + F^{bc} \, \Gamma_{d}^{ac} \, \vec{b}_b \, \vec{b}_d \right] = \\
  & = \vec{b}^a \otimes \vec{b}_b \otimes \vec{b}_c \left[ \dfrac{\partial F^{bc}}{\partial q^a} + \Gamma_{ad}^b \, F^{dc} + \Gamma^{c}_{ad} \, F^{bd}  \right] \ .
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}


\subsection{Divergence}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:divergence}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-differential-operators-divergence}}
\sphinxAtStartPar
Divergence opearator is a first\sphinxhyphen{}order differential operator that can be defined as the contraction of the first two indices of the gradient,
\begin{equation*}
\begin{split}\nabla \cdot F = C_{1}^{2}\left( \nabla F \right) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
It takes a tensor field \(F(\vec{r})\) of order \(r \ge 1\) and gives a tensor field \(\nabla \cdot F(\vec{r})\) of order \(r-1 \ge 0\).
\label{ch/tensor-algebra-calculus/calculus-euclidean:example-7}
\begin{sphinxadmonition}{note}{Example 7.3.4 (Divergence of a vector field \sphinxhyphen{} with general coordiantes \protect\(q^{a}\protect\))}



\sphinxAtStartPar
Applying contraction to the gradient of a vector field, it readily follows,
\begin{equation*}
\begin{split}\begin{aligned}
  \nabla \cdot \left( F^b \vec{b}_b \right)
  & = C_{1}^{2} \left( \nabla F \right) = \\
  & = C_1^2 \left( \vec{b}^a \otimes \vec{b}_b \left[ \dfrac{\partial F^b}{\partial q^a} + \Gamma_{ac}^b \, F^c \right] \right) = \\
  & = \dfrac{\partial F^a}{\partial q^a} + \Gamma_{ac}^a \, F^c
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean:example-8}
\begin{sphinxadmonition}{note}{Example 7.3.5 (Divergence of a \protect\(2^{nd}\protect\)\sphinxhyphen{}order tensor field \sphinxhyphen{} with general coordiantes \protect\(q^{a}\protect\))}



\sphinxAtStartPar
Applying contraction to the gradient of a vector field, it readily follows,
\begin{equation*}
\begin{split}\begin{aligned}
  \nabla \cdot \left( F^{bc} \vec{b}_b \otimes \vec{b}_c \right)
  & = C_{1}^{2} \left( \nabla F \right) = \\
  & = C_1^2 \left( \vec{b}^a \otimes \vec{b}_b \otimes \vec{b}_c \left[ \dfrac{\partial F^{bc}}{\partial q^a} + \Gamma_{ad}^b \, F^{dc} + \Gamma^{c}_{ad} \, F^{bd}  \right]  \right) = \\
  & = \vec{b}_c \, \left[ \dfrac{\partial F^{ac}}{\partial q^a} + \Gamma_{ad}^a \, F^{dc} + \Gamma^{c}_{ad} \, F^{ad}  \right] 
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}


\subsection{Laplacian}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:laplacian}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-differential-operators-laplacian}}
\sphinxAtStartPar
Laplacian operator is second\sphinxhyphen{}order differential operator that can be defined as the divergence of the gradient,
\begin{equation*}
\begin{split}\Delta F = \nabla^2 F = \nabla \cdot \nabla F \ .\end{split}
\end{equation*}\label{ch/tensor-algebra-calculus/calculus-euclidean:example-9}
\begin{sphinxadmonition}{note}{Example 7.3.6 (Laplacian of a scalar field \sphinxhyphen{} with general coordinates \protect\(q^a\protect\))}


\begin{equation*}
\begin{split}
\nabla \cdot \nabla F
  & = C_{1}^2 \left[ \nabla \left( \nabla F \right) \right] = \\
  & = C_{1}^2 \left[ \nabla \left( \vec{b}^a \dfrac{\partial F}{\partial q^a} \right) \right] = \\
  & = C_{1}^2 \left[ \nabla \left( \vec{b}_b \, g^{ab} \, \dfrac{\partial F}{\partial q^a} \right) \right] = \\
  & = C_{1}^2 \left[ \vec{b}^c \frac{\partial}{\partial q^c} \left( \vec{b}_b \, g^{ab} \, \dfrac{\partial F}{\partial q^a} \right) \right] = \\
  & = C_{1}^2 \left\{ \vec{b}^c \left[ \vec{b}_b \, \frac{\partial}{\partial q^c} \left( \, g^{ab} \, \dfrac{\partial F}{\partial q^a} \right) + g^{ab} \dfrac{\partial F}{\partial q^a} \dfrac{\partial \vec{b}_b}{\partial q^c} \right] \right\} = \\
  & = C_{1}^2 \left\{ \vec{b}^c \left[ \vec{b}_b \, \frac{\partial}{\partial q^c} \left( \, g^{ab} \, \dfrac{\partial F}{\partial q^a} \right) + g^{ab} \dfrac{\partial F}{\partial q^a} \, \Gamma_{bc}^d \, \vec{b}_d \right] \right \} = \\
  & = C_{1}^2 \left\{ \vec{b}^c \, \vec{b}_b \left[ \frac{\partial}{\partial q^c} \left( \, g^{ab} \, \dfrac{\partial F}{\partial q^a} \right) + g^{ad} \, \Gamma_{cd}^b \, \dfrac{\partial F}{\partial q^a} \right] \right \} = \\
  & = \frac{\partial}{\partial q^b} \left( \, g^{ab} \, \dfrac{\partial F}{\partial q^a} \right) + g^{ad} \, \Gamma_{bd}^b \, \dfrac{\partial F}{\partial q^a} \ .
\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean:example-10}
\begin{sphinxadmonition}{note}{Example 7.3.7 (Laplacian of a vector field \sphinxhyphen{} with general coordinates \protect\(q^a\protect\))}


\begin{equation*}
\begin{split}
\nabla \cdot \nabla F
  & = C_{1}^2 \left[ \nabla \left( \nabla F \right) \right] = \\
  & = C_{1}^2 \left\{ \nabla \left[ \vec{b}^a \, \vec{b}_b \left( \dfrac{\partial F^b}{\partial q^a} + \Gamma^{b}_{ac} F^c \right) \right] \right\} = \\
  & = C_{1}^2 \left\{ \nabla \left[ \vec{b}_c \, \vec{b}_b \,  g^{ac} \left( \dfrac{\partial F^b}{\partial q^a} + \Gamma^{b}_{ac} F^c \right) \right] \right\} = \\
  & = C_{1}^2 \left\{ \nabla \cdot \left((\nabla F)^{cb} \, \vec{b}_c \, \vec{b}_b \right) \right\} = \\
  & = C_{1}^2 \left\{ \vec{b}^a \, \vec{b}_c \, \vec{b}_b \, \left[ \dfrac{\partial (\nabla F)^{cb}}{\partial q^a} 
     + \Gamma_{ad}^c (\nabla F)^{db} + \Gamma_{ad}^b (\nabla F)^{cd} \right] \right\} = \\
  & = \vec{b}_b \, \left[ \dfrac{\partial (\nabla F)^{ab}}{\partial q^a} 
     + \Gamma_{ad}^a (\nabla F)^{db} + \Gamma_{ad}^b (\nabla F)^{ad} \right] = \ .
\end{split}
\end{equation*}\end{sphinxadmonition}


\subsection{Curl}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:curl}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-differential-operators-curl}}

\section{Integrals in \protect\(E^d\protect\), \protect\(d \le 3\protect\)}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:integrals-in-e-d-d-le-3}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals}}

\subsection{Line integrals}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:line-integrals}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-line}}

\subsubsection{Density}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:density}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-line-density}}
\sphinxAtStartPar
Integrals
\begin{equation*}
\begin{split} \int_{\vec{r}\in\gamma} F(\vec{r})\end{split}
\end{equation*}
\sphinxAtStartPar
represent the summation of contributions \(F(\vec{r})\) over elementary segments of path \(\gamma\), whose dimension is \(|d \vec{r}|\), i.e. implicitly means
\begin{equation*}
\begin{split}\int_{\vec{r}\in\gamma} F(\vec{r}) = \int_{\vec{r} \in \gamma} F(\vec{r}) \, |d \vec{r}| \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Given a regular parametrization of the curve \(\vec{r}(q^1)\) (with increasing \(q^1\) so that \(|dq^1| = dq^1\)), and the differential \(d \vec{r} = \vec{r}'(q^1) \, d q^1\), the integral can be written as an integral in the parameter \(q^1\)
\begin{equation*}
\begin{split}\int_{q=q^1_a}^{q^1_b} F(\vec{r}(q^1)) \, |\vec{r}'(q^1)| \, dq^1 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\vec{r}(q^1_a)\), \(\vec{r}(q^1_b)\) the extreme points of path \(\gamma\).


\subsubsection{Work}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:work}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-line-work}}
\sphinxAtStartPar
Integrals
\begin{equation*}
\begin{split}\int_{\vec{r} \in \gamma} F(\vec{r}) \cdot \hat{t}(\vec{r})\end{split}
\end{equation*}
\sphinxAtStartPar
implicitly mean
\begin{equation*}
\begin{split}\int_{\vec{r} \in \gamma} F(\vec{r}) \cdot \hat{t}(\vec{r}) = \int_{\vec{r} \in \gamma} F(\vec{r}) \cdot \hat{t}(\vec{r}) |d \vec{r}| = \int_{\vec{r} \in \gamma} F(\vec{r}) \cdot d \vec{r} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
as \(\hat{t} = \frac{d \vec{r}}{|d \vec{r}|}\).
Given a regular parametrization of the curve \(\vec{r}(q^1)\) (with increasing \(q^1\) so that \(|dq^1| = dq^1\)), and the differential \(d \vec{r} = \vec{r}'(q^1) \, d q^1\), the integral can be written as an integral in the parameter \(q^1\)
\begin{equation*}
\begin{split}\int_{q^1=q^1_a}^{q^1_b} F(\vec{r}(q^1)) \cdot \vec{r}'(q^1) \, dq^1\end{split}
\end{equation*}

\subsection{Surface integrals}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:surface-integrals}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-surface}}
\sphinxAtStartPar
Given two coordinates \(q^1, \, q^2\) describing a surface, \(\vec{r}(q^1, q^2)\) the elementary surface with unit normal reads
\begin{equation*}
\begin{split}\hat{n} \, dS = d \vec{r}_1 \times d \vec{r}_2 = \frac{\partial \vec{r}}{\partial q^1} \times \frac{\partial \vec{r}}{\partial q^2} \, dq^1 \, dq^2 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and the elementary surface thus reads
\begin{equation*}
\begin{split}|dS| = |\hat{n} dS| = \left| \frac{\partial \vec{r}}{\partial q^1} \times \frac{\partial \vec{r}}{\partial q^2} \, dq^1 \, dq^2  \right|\end{split}
\end{equation*}

\subsubsection{Density}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-surface-density}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:id1}}
\sphinxAtStartPar
Integrals
\begin{equation*}
\begin{split}\int_{\vec{r} \in S} F(\vec{r}) \end{split}
\end{equation*}
\sphinxAtStartPar
implicitly mean
\begin{equation*}
\begin{split}\int_{\vec{r} \in S} F(\vec{r}) = \int_{\vec{r} \in S} F(\vec{r}) |d S| \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Given regular parametrization of the surface, \(\vec{r}(q^1, \, q^2), \ (q^1, q^2) \in Q^{12}\), the integral can be written as the multi\sphinxhyphen{}dimensional integral in coordinates \(q^1, \ q^2\),
\begin{equation*}
\begin{split}\int_{\vec{r} \in S} F(\vec{r}) = \int_{(q^1,q^2) \in Q^{12}} F(\vec{r}(q^1,q^2)) \left| \frac{\partial \vec{r}}{\partial q^1} \times \frac{\partial \vec{r}}{\partial q^2}  \, dq^1 \, dq^2 \right|\end{split}
\end{equation*}

\subsubsection{Flux}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:flux}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-surface-flux}}
\sphinxAtStartPar
Integrals
\begin{equation*}
\begin{split}\int_{\vec{r} \in S} \hat{n}(\vec{r}) \cdot F(\vec{r}) \end{split}
\end{equation*}
\sphinxAtStartPar
implicitly mean
\begin{equation*}
\begin{split}\int_{\vec{r} \in S} \hat{n}(\vec{r}) \cdot F(\vec{r}) = \int_{\vec{r} \in S} \hat{n}(\vec{r}) \cdot F(\vec{r}) |dS| \end{split}
\end{equation*}
\sphinxAtStartPar
Given regular parametrization of the surface, \(\vec{r}(q^1, \, q^2), \ (q^1, q^2) \in Q^{12}\), the integral can be written as the multi\sphinxhyphen{}dimensional integral in coordinates \(q^1, \ q^2\),
\begin{equation*}
\begin{split}\int_{\vec{r} \in S} \hat{n}(\vec{r}) \cdot F(\vec{r}) = \int_{(q^1,q^2) \in Q^{12}} \frac{\partial \vec{r}}{\partial q^1} \times \frac{\partial \vec{r}}{\partial q^2} \cdot  F(\vec{r}(q^1,q^2))\, dq^1 \, dq^2 \end{split}
\end{equation*}

\subsection{Volume}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:volume}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-volume}}\begin{equation*}
\begin{split}dV = \frac{\partial \vec{r}}{\partial q^1} \cdot \frac{\partial \vec{r}}{\partial q^2} \times \frac{\partial \vec{r}}{\partial q^3} \, dq^1 \, dq^2 \, d q^3 \ . \end{split}
\end{equation*}

\subsubsection{Density}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-volume-density}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:id2}}
\sphinxAtStartPar
Integrals
\begin{equation*}
\begin{split}\int_{\vec{r} \in V} F(\vec{r})\end{split}
\end{equation*}
\sphinxAtStartPar
implicitly mean
\begin{equation*}
\begin{split}\int_{\vec{r} \in V} F(\vec{r}) = \int_{\vec{r} \in V} F(\vec{r}) \, |dV| \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Given regular parametrization of the volume, \(\vec{r}(q^1, \, q^2, \, q^3), \ (q^1, q^2, q^3) \in Q\), the integral can be written as the multi\sphinxhyphen{}dimensional integral in coordinates \(q^1, \, q^2, \, q^3\),
\begin{equation*}
\begin{split}\int_{\vec{r} \in V} F(\vec{r}) |d V| = \int_{(q^1,q^2,q^3) \in Q} F(\vec{r}(q^1,q^2,q^3))  \left| \frac{\partial \vec{r}}{\partial q^1} \cdot \frac{\partial \vec{r}}{\partial q^2} \times \frac{\partial \vec{r}}{\partial q^3} \, dq^1 \, dq^2 \, d q^3 \right| \ .\end{split}
\end{equation*}

\subsection{Theorems}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:theorems}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-theorems}}

\subsubsection{Gradient theorem}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:gradient-theorem}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-theorems-gradient}}\begin{equation*}
\begin{split}\int_{V} \nabla f = \oint_{\partial V} f \hat{n}\end{split}
\end{equation*}

\subsubsection{Divergence theorem}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:divergence-theorem}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-theorems-divergence}}\begin{equation*}
\begin{split}\int_{V} \nabla \cdot \vec{f} = \oint_{\partial V} \vec{f} \cdot \hat{n}\end{split}
\end{equation*}

\subsubsection{Curl theorem}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:curl-theorem}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean:tensor-calculus-integrals-theorems-curl}}\begin{equation*}
\begin{split}\int_{S} \left[ \nabla \times \vec{f} \right] \cdot \hat{n} = \oint_{\partial S} \vec{f} \cdot \hat{t}\end{split}
\end{equation*}
\sphinxstepscope


\section{Tensor Calculus in Euclidean Spaces \sphinxhyphen{} Cartesian coordinates in \protect\(E^3\protect\)}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:tensor-calculus-in-euclidean-spaces-cartesian-coordinates-in-e-3}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:tensor-calculus-cartesian}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian::doc}}
\sphinxAtStartPar
Using Cartesian coordinates \((q^1, q^2, q^3) = (r, \theta, z)\) and Cartesian base vectors (uniform in space, so that their derivatives are zero), a point in Euclidean vector space \(E^3\) can be represented as
\begin{equation*}
\begin{split}\vec{r} = x \, \hat{x} + y \, \hat{y} + z \, \hat{z} \ .\end{split}
\end{equation*}

\subsection{Natural basis, reciprocal basis, metric tensor, and Christoffel symbols}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:natural-basis-reciprocal-basis-metric-tensor-and-christoffel-symbols}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:tensor-calculus-cartesian-metric}}
\sphinxAtStartPar
Cartesian coordinates in Euclidean spaces are a very special coordinate system, with reciprocal basis everywhere coinciding with natural basis, with uniform basis in space (zero second\sphinxhyphen{}order derivative of space w.r.t. coordinates, and thus zero first order derivative of base vectors, and thus identically zero Christoffel symbols), and components of the metric tensor equal to the identity matrix
\begin{equation*}
\begin{split}\begin{cases}
  \vec{b}_1 = \vec{b}^1 = \hat{x} \\
  \vec{b}_2 = \vec{b}^2 = \hat{y} \\
  \vec{b}_3 = \vec{b}^3 = \hat{z} \\
\end{cases}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\left[g_{ab} \right] = \left[ g^{ab} \right] = \begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\Gamma_{ab}^c = 0 \qquad , \qquad \forall a,b,c = 1:3 \ .\end{split}
\end{equation*}

\subsection{Differential operators}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:differential-operators}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:tensor-calculus-cartesian-differential-operators}}

\subsubsection{Gradient}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:gradient}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:tensor-calculus-cartesian-differential-operators-gradient}}\label{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:example-0}
\begin{sphinxadmonition}{note}{Example 7.5.1 (Gradient of a scalar field)}


\begin{equation*}
\begin{split}\nabla F = \hat{x} \, \partial_x F + \hat{y} \, \partial_y F + \hat{z} \, \partial_z F_z\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:example-1}
\begin{sphinxadmonition}{note}{Example 7.5.2 (Gradient of a vector field)}


\begin{equation*}
\begin{split}\begin{aligned}
\nabla F 
  & = \nabla (F_x \hat{x} + F_y \hat{y} + F_z \hat{z}) = \\
  & = \hat{x} \otimes \hat{x} \, \partial_x F_x + \hat{x} \otimes \hat{y} \, \partial_x F_y + \hat{x} \otimes \hat{z} \, \partial_x F_z + \\
  & + \hat{y} \otimes \hat{x} \, \partial_y F_x + \hat{y} \otimes \hat{y} \, \partial_y F_y + \hat{y} \otimes \hat{z} \, \partial_y F_z + \\
  & + \hat{z} \otimes \hat{x} \, \partial_z F_x + \hat{z} \otimes \hat{y} \, \partial_z F_y + \hat{z} \otimes \hat{z} \, \partial_z F_z + \\
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:example-2}
\begin{sphinxadmonition}{note}{Example 7.5.3 (Gradient of a \protect\(2^{nd}\protect\)\sphinxhyphen{}order tensor field)}


\end{sphinxadmonition}


\subsubsection{Directional derivative}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:directional-derivative}}

\subsubsection{Divergence}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:divergence}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:tensor-calculus-cartesian-differential-operators-divergence}}\label{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:example-3}
\begin{sphinxadmonition}{note}{Example 7.5.4 (Divergence of a vector field)}


\begin{equation*}
\begin{split}\begin{aligned}
 \nabla \cdot F 
  & = \nabla \cdot \left( F_x \, \hat{x} + F_y \, \hat{y} + F_z \, \hat{z} \right) = \\
  & = \partial_x F_x + \partial_y F_y + \partial_z F_z \ .
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:example-4}
\begin{sphinxadmonition}{note}{Example 7.5.5 (Divergence of a \protect\(2^{nd}\protect\)\sphinxhyphen{}order tensor field)}


\begin{equation*}
\begin{split}\begin{aligned}
 \nabla \cdot F 
  & = \nabla \cdot \left( F_{ab} \vec{e}_a \otimes \vec{e}_b \right) = \\
  & = \vec{e}_c \dfrac{\partial F_{ab}}{\partial q^a} = \\
  & = \hat{x} \left[ \partial_x F_{xx} + \partial_y F_{yx} + \partial_z F_{zx} \right] + \\ 
  & + \hat{y} \left[ \partial_x F_{xy} + \partial_y F_{yy} + \partial_z F_{zy} \right] + \\ 
  & + \hat{z} \left[ \partial_x F_{xz} + \partial_y F_{yz} + \partial_z F_{zz} \right] \ .
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}


\subsubsection{Laplacian}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:laplacian}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:tensor-calculus-cartesian-differential-operators-laplacian}}\label{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:example-5}
\begin{sphinxadmonition}{note}{Example 7.5.6 (Laplacian of a scalar field)}


\begin{equation*}
\begin{split}\nabla^2 F = \partial_{xx} F + \partial_{yy} F + \partial_{zz} F\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-cartesian:example-6}
\begin{sphinxadmonition}{note}{Example 7.5.7 (Laplacian of a vector field)}


\end{sphinxadmonition}

\sphinxstepscope


\section{Tensor Calculus in Euclidean Spaces \sphinxhyphen{} cylindrical coordinates in \protect\(E^3\protect\)}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:tensor-calculus-in-euclidean-spaces-cylindrical-coordinates-in-e-3}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:tensor-calculus-cylindrical}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical::doc}}

\subsection{Cylindrical coordiantes and cylindrical coordinates}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:cylindrical-coordiantes-and-cylindrical-coordinates}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:tensor-calculus-cylindrical-coordinates}}
\sphinxAtStartPar
Using cylindrical coordinates \((q^1, q^2, q^3) = (r, \theta, z)\) and cylindrical base vectors (uniform in space, so that their derivatives are zero), a point in Euclidean vector space \(E^3\) can be represented as
\begin{equation*}
\begin{split}\vec{r} = r \cos \theta \, \hat{x} + r \sin \theta \, \hat{y} + z \, \hat{z} \ .\end{split}
\end{equation*}

\subsection{Natural basis, reciprocal basis, metric tensor, and Christoffel symbols}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:natural-basis-reciprocal-basis-metric-tensor-and-christoffel-symbols}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:tensor-calculus-cylindrical-metric}}\subsubsection*{Natural basis}

\sphinxAtStartPar
Natural basis reads
\begin{equation*}
\begin{split}\begin{cases}
\vec{b}_1 = \dfrac{\partial \vec{r}}{\partial q^1} = \dfrac{\partial \vec{r}}{\partial r     } = \cos \theta \, \hat{x} + \sin \theta \, \hat{y} \\
\vec{b}_2 = \dfrac{\partial \vec{r}}{\partial q^2} = \dfrac{\partial \vec{r}}{\partial \theta} = - r \sin \theta \, \hat{x} + r \cos \theta \, \hat{y} \\
\vec{b}_3 = \dfrac{\partial \vec{r}}{\partial q^3} = \dfrac{\partial \vec{r}}{\partial z     } = \hat{z} \\
\end{cases}\end{split}
\end{equation*}\subsubsection*{Metric tensor}

\sphinxAtStartPar
Covariant components of metric tensors,
\begin{equation*}
\begin{split}g_{ab} = \vec{b}_a \cdot \vec{b}_b \ , \end{split}
\end{equation*}
\sphinxAtStartPar
can be collected in the diagonal matrix
\begin{equation*}
\begin{split}\left[ g_{ab} \right] = \begin{bmatrix} 1 & 0 & 0 \\ 0 & r^2 & 0 \\ 0 & 0 & 1 \end{bmatrix} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
while its contra\sphinxhyphen{}variant components can be collected in the inverse matrix (easy to compute, since \(\left[ g_{ab} \right]\) is diagonal),
\begin{equation*}
\begin{split}\left[ g^{ab} \right] = \begin{bmatrix} 1 & 0 & 0 \\ 0 & \frac{1}{r^2} & 0 \\ 0 & 0 & 1 \end{bmatrix} \ .\end{split}
\end{equation*}\subsubsection*{Reciprocal basis}

\sphinxAtStartPar
Reciprocal basis is readily evaluated using \(\vec{b}^a = g^{ab} \, \vec{b}_b\),
\begin{equation*}
\begin{split}\begin{cases}
\vec{b}^1 =  \cos \theta \, \hat{x} + \sin \theta \, \hat{y} \\
\vec{b}^2 =  - \dfrac{1}{r} \sin \theta \, \hat{x} + \dfrac{1}{r} \cos \theta \, \hat{y} \\
\vec{b}^3 =  \hat{z} \\
\end{cases}\end{split}
\end{equation*}\subsubsection*{Physical basis}

\sphinxAtStartPar
Since metric tensor is diagonal, the cylindrical coordinate system is orthogonal, and its natural and reciprocal basis are orthogonal. A unit orthogonal basis, usually named \sphinxstylestrong{physical basis} with unit vector with no physical dimension, is evalated by normalization process,
\begin{equation*}
\begin{split}\begin{cases}
  \hat{r}      = \hat{b}_1 = \dfrac{\vec{b}_1}{g_{11}} = \dfrac{\vec{b}^1}{g^{11}} =  \cos \theta \, \hat{x} + \sin \theta \, \hat{y} \\
  \hat{\theta} = \hat{b}_2 = \dfrac{\vec{b}_2}{g_{22}} = \dfrac{\vec{b}^2}{g^{22}} = -\sin \theta \, \hat{x} + \cos \theta \, \hat{y} \\
  \hat{z}      = \hat{b}_3 = \dfrac{\vec{b}_3}{g_{33}} = \dfrac{\vec{b}^3}{g^{33}} =  \hat{z} \ .
\end{cases}\end{split}
\end{equation*}\subsubsection*{Derivatives of natural basis and Christoffel symbols}

\sphinxAtStartPar
Derivatives of the natural basis read
\begin{equation*}
\begin{split}\begin{aligned}
 \dfrac{\partial \vec{b}_1}{\partial q^1} & = \vec{0} \\
 \dfrac{\partial \vec{b}_2}{\partial q^2} & = -r \cos \theta \, \hat{x} - r \sin \theta \, \hat{y} = - q^1 \, \vec{b}_1 \\
 \dfrac{\partial \vec{b}_3}{\partial q^3} & = \vec{0} \\
 \dfrac{\partial \vec{b}_2}{\partial q^1} = \dfrac{\partial \vec{b}_1}{\partial q^2} & = -\sin \theta \, \hat{x} + \cos \theta \hat{y} = \dfrac{1}{q^1} \, \vec{b}_2 \\
 \dfrac{\partial \vec{b}_3}{\partial q^1} = \dfrac{\partial \vec{b}_1}{\partial q^3} & = \vec{0} \\
 \dfrac{\partial \vec{b}_3}{\partial q^2} = \dfrac{\partial \vec{b}_2}{\partial q^3} & = \vec{0} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that non\sphinxhyphen{}zero Christoffel symbols of a cylindrical coordinate system are
\begin{equation*}
\begin{split}\begin{aligned}
  & \Gamma_{12}^{2} = \Gamma_{21}^2 = \dfrac{1}{q^1} \\
  & \Gamma_{22}^{1} = - q^1 \ .
\end{aligned}\end{split}
\end{equation*}

\subsection{Differential operators}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:differential-operators}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:tensor-calculus-cylindrical-differential-operators}}

\subsubsection{Gradient}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:gradient}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:tensor-calculus-cylindrical-differential-operators-gradient}}\label{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:example-0}
\begin{sphinxadmonition}{note}{Example 7.6.1 (Gradient of a scalar field)}


\begin{equation*}
\begin{split}\begin{aligned}
  \nabla F 
  & = \vec{b}^a \dfrac{\partial F}{\partial q^a} = \\
  & = \hat{b}_a \, g^{aa} \, \dfrac{\partial F}{\partial q^a} = \\
  & = \hat{r} \, \dfrac{\partial F}{\partial  r} 
    + \hat{\theta} \, \dfrac{1}{r} \, \dfrac{\partial F}{\partial \theta}  
    + \hat{z} \dfrac{\partial F}{\partial z} \ . 
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:example-1}
\begin{sphinxadmonition}{note}{Example 7.6.2 (Gradient of a vector field)}




\begin{equation*}
\begin{split}\begin{aligned}
  \nabla F 
  & = \vec{b}^a \otimes \vec{b}_b \left[ \dfrac{\partial F^b}{\partial q^a} + \Gamma_{ac}^b \, F^c \right] = \\
  & = \dots = \\
  & =  \vec{b}^1 \otimes \vec{b}_1 \, \partial_1 F^1 
  && + \vec{b}^1 \otimes \vec{b}_2 \, \left[ \partial_1 F^2 + \Gamma_{12}^2 F^2 \right]
  && + \vec{b}^1 \otimes \vec{b}_3 \, \partial_1 F^3 \\
  &  + \vec{b}^2 \otimes \vec{b}_1 \, \left[ \partial_2 F^1 + \Gamma_{22}^1 F^2 \right]
  && + \vec{b}^2 \otimes \vec{b}_2 \, \left[ \partial_2 F^2 + \Gamma_{21}^2 F^1 \right]
  && + \vec{b}^2 \otimes \vec{b}_3 \, \partial_2 F^3 \\
  &  + \vec{b}^3 \otimes \vec{b}_1 \, \partial_3 F^1 
  && + \vec{b}^3 \otimes \vec{b}_2 \, \partial_3 F^2 
  && + \vec{b}^3 \otimes \vec{b}_3 \, \partial_3 F^3 \\
  &  = \hat{r     } \otimes \hat{r     } \, \partial_r F_r   
  && + \hat{r     } \otimes \hat{\theta} \, \frac{1}{r} \left[ \partial_r (r F_{\theta}) + F_{\theta} \right]
  && + \hat{r     } \otimes \hat{z     } \, \partial_r F_z \\
  &  + \hat{\theta} \otimes \hat{r     } \, \frac{1}{r} \left[ \partial_\theta F_r - r F_{\theta} \right]
  && + \hat{\theta} \otimes \hat{\theta} \, \left[ \partial_\theta \left( \frac{F_\theta}{r} \right) + \frac{F_r}{r} \right]
  && + \hat{\theta} \otimes \hat{z     } \, \frac{1}{r} \partial_{\theta} F_z \\
  &  + \hat{z     } \otimes \hat{r     } \, \partial_z F_x   
  && + \hat{z     } \otimes \hat{\theta} \, \frac{1}{r} \partial_\theta F_y   
  && + \hat{z     } \otimes \hat{z     } \, \partial_z F_z \ .
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:example-2}
\begin{sphinxadmonition}{note}{Example 7.6.3 (Gradient of a \protect\(2^{nd}\protect\)\sphinxhyphen{}order tensor field)}


\end{sphinxadmonition}


\subsubsection{Directional derivative}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:directional-derivative}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:tensor-calculus-cylindrical-differential-operators-directional-der}}

\subsubsection{Divergence}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:divergence}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:tensor-calculus-cylindrical-differential-operators-divergence}}\label{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:example-3}
\begin{sphinxadmonition}{note}{Example 7.6.4 (Divergence of a vector field)}


\begin{equation*}
\begin{split}\begin{aligned}
  \nabla \cdot \vec{F} 
  & = \dfrac{\partial F^a}{\partial q^a} + \Gamma_{ac}^a \, F^c = \\
  & = \dfrac{\partial F_r}{\partial r} + \dfrac{\partial}{\partial \theta}\left( \frac{F_\theta}{r} \right) + \frac{F_\theta}{r} + \dfrac{\partial F_z}{\partial z} \ .
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:example-4}
\begin{sphinxadmonition}{note}{Example 7.6.5 (Divergence of a \protect\(2^{nd}\protect\)\sphinxhyphen{}order tensor field)}


\end{sphinxadmonition}


\subsubsection{Laplacian}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:laplacian}}\label{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:example-5}
\begin{sphinxadmonition}{note}{Example 7.6.6 (Laplacian of a scalar field)}


\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-cylindrical:example-6}
\begin{sphinxadmonition}{note}{Example 7.6.7 (Laplacian of a vector field)}


\end{sphinxadmonition}

\sphinxstepscope


\section{Tensor Calculus in Euclidean Spaces \sphinxhyphen{} Spehrical coordinates in \protect\(E^3\protect\)}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:tensor-calculus-in-euclidean-spaces-spehrical-coordinates-in-e-3}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:tensor-calculus-spherical}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical::doc}}
\sphinxAtStartPar
Using spherical coordinates \((q^1, q^2, q^3) = (r, \phi, \theta)\) and spherical base vectors (uniform in space, so that their derivatives are zero), a point in Euclidean vector space \(E^3\) can be represented as
\begin{equation*}
\begin{split}\vec{r} = r \cos \theta \sin \phi \, \hat{x} + r \sin \theta \sin \phi \, \hat{y} + r \cos \phi \, \hat{z} \ .\end{split}
\end{equation*}

\subsection{Natural basis, reciprocal basis, metric tensor, and Christoffel symbols}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:natural-basis-reciprocal-basis-metric-tensor-and-christoffel-symbols}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:tensor-calculus-spherical-metric}}

\subsection{Differential operators}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:differential-operators}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:tensor-calculus-spherical-differential-operators}}

\subsubsection{Gradient}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:gradient}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:tensor-calculus-spherical-differential-operators-gradient}}\label{ch/tensor-algebra-calculus/calculus-euclidean-spherical:example-0}
\begin{sphinxadmonition}{note}{Example 7.7.1 (Gradient of a scalar field)}


\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-spherical:example-1}
\begin{sphinxadmonition}{note}{Example 7.7.2 (Gradient of a vector field)}


\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-spherical:example-2}
\begin{sphinxadmonition}{note}{Example 7.7.3 (Gradient of a \protect\(2^{nd}\protect\)\sphinxhyphen{}order tensor field)}


\end{sphinxadmonition}


\subsubsection{Directional derivative}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:directional-derivative}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:tensor-calculus-spherical-differential-operators-directional-der}}

\subsubsection{Divergence}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:divergence}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:tensor-calculus-spherical-differential-operators-divergence}}\label{ch/tensor-algebra-calculus/calculus-euclidean-spherical:example-3}
\begin{sphinxadmonition}{note}{Example 7.7.4 (Divergence of a vector field)}


\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-spherical:example-4}
\begin{sphinxadmonition}{note}{Example 7.7.5 (Divergence of a \protect\(2^{nd}\protect\)\sphinxhyphen{}order tensor field)}


\end{sphinxadmonition}


\subsubsection{Laplacian}
\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:laplacian}}\label{\detokenize{ch/tensor-algebra-calculus/calculus-euclidean-spherical:tensor-calculus-spherical-differential-operators-laplacian}}\label{ch/tensor-algebra-calculus/calculus-euclidean-spherical:example-5}
\begin{sphinxadmonition}{note}{Example 7.7.6 (Laplacian of a scalar field)}


\end{sphinxadmonition}
\label{ch/tensor-algebra-calculus/calculus-euclidean-spherical:example-6}
\begin{sphinxadmonition}{note}{Example 7.7.7 (Laplacian of a vector field)}


\end{sphinxadmonition}

\sphinxstepscope


\chapter{Time derivative of integrals over moving domains}
\label{\detokenize{ch/tensor-algebra-calculus/time-derivative-of-integrals:time-derivative-of-integrals-over-moving-domains}}\label{\detokenize{ch/tensor-algebra-calculus/time-derivative-of-integrals:tensor-calculus-time-derivative-of-integrals}}\label{\detokenize{ch/tensor-algebra-calculus/time-derivative-of-integrals::doc}}
\sphinxAtStartPar
Some results about time derivatives over moving domains are collected here.


\section{Volume density}
\label{\detokenize{ch/tensor-algebra-calculus/time-derivative-of-integrals:volume-density}}\label{\detokenize{ch/tensor-algebra-calculus/time-derivative-of-integrals:tensor-calculus-time-derivative-of-integrals-volume-density}}
\sphinxAtStartPar
\sphinxstylestrong{Reynolds transport theorem.}
Given a volume \(V(t)\) with boundary \(\partial V(t)\), whose points \(\vec{r} \in \partial V(t)\) have velocity \(\vec{v}_b\),
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{V(t)} f = \int_{V(t)} \dfrac{\partial f}{\partial t} + \oint_{\partial V(t)} f \vec{v}_b \cdot \hat{n} \ .\end{split}
\end{equation*}\subsubsection*{“Proof”}


\section{Flux across a surface}
\label{\detokenize{ch/tensor-algebra-calculus/time-derivative-of-integrals:flux-across-a-surface}}\label{\detokenize{ch/tensor-algebra-calculus/time-derivative-of-integrals:tensor-calculus-time-derivative-of-integrals-flux}}\begin{equation*}
\begin{split}\frac{d}{dt} \int_{S(t)} \vec{f} \cdot \hat{n} = \int_{S(t)} \frac{\partial \vec{f}}{\partial t} \cdot \hat{n} + \int_{S(t)} \nabla \cdot \vec{f} \,\, \vec{v}_b \cdot \hat{n} - \int_{\partial S(t)} \vec{v}_b \times \vec{f} \cdot \hat{t} \end{split}
\end{equation*}\subsubsection*{“Proof”}


\section{Work line integral along a line}
\label{\detokenize{ch/tensor-algebra-calculus/time-derivative-of-integrals:work-line-integral-along-a-line}}\label{\detokenize{ch/tensor-algebra-calculus/time-derivative-of-integrals:tensor-calculus-time-derivative-of-integrals-work}}\begin{equation*}
\begin{split}\frac{d}{dt} \int_{\ell(t)} \vec{f} \cdot \hat{t} =  \int_{\ell(t)} \frac{\partial \vec{f}}{\partial t} \cdot \hat{t} + \int_{\ell(t)} \nabla \times \vec{f} \cdot \vec{v}_b \times \hat{t} + \vec{f}_B \cdot \vec{v}_B - \vec{f}_A \cdot \vec{v}_A \end{split}
\end{equation*}\subsubsection*{“Proof”}

\sphinxstepscope


\part{Functional Analysis}

\sphinxstepscope


\chapter{Introduction to Functional Analysis}
\label{\detokenize{ch/functional-analysis/intro:introduction-to-functional-analysis}}\label{\detokenize{ch/functional-analysis/intro:functional-analysis}}\label{\detokenize{ch/functional-analysis/intro::doc}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Lebesgue integral

\item {} 
\sphinxAtStartPar
\(L^p\), \(H^p\) function spaces

\item {} 
\sphinxAtStartPar
Banach and Hilbert spaces

\end{itemize}

\sphinxstepscope


\chapter{Dirac’s delta}
\label{\detokenize{ch/functional-analysis/dirac-delta:dirac-s-delta}}\label{\detokenize{ch/functional-analysis/dirac-delta:functional-analysis-dirac-delta}}\label{\detokenize{ch/functional-analysis/dirac-delta::doc}}
\sphinxAtStartPar
Dirac’s delta \(\delta(x)\) is a distribution, or generalized function, with the following properties
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\end{enumerate}
\begin{equation}\label{equation:ch/functional-analysis/dirac-delta:dirac-delta:prop-1}
\begin{split}\int_{D} \delta(x-x_0) \, dx = 1  \quad \text{if $x_0 \in D$}\end{split}
\end{equation}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{1}
\item {} 
\end{enumerate}
\begin{equation}\label{equation:ch/functional-analysis/dirac-delta:dirac-delta:prop-2}
\begin{split}\int_{D} f(x) \delta(x-x_0) \, dx \quad \text{if $x_0 \in D$}\end{split}
\end{equation}
\sphinxAtStartPar
for \(\forall f(x)\) “regular” \sphinxstylestrong{todo} \sphinxstyleemphasis{what does regular mean?}


\section{Dirac’s delta in terms of regular functions}
\label{\detokenize{ch/functional-analysis/dirac-delta:dirac-s-delta-in-terms-of-regular-functions}}\label{\detokenize{ch/functional-analysis/dirac-delta:functional-analysis-dirac-delta-approximations}}

\subsection{Piece\sphinxhyphen{}wise constant}
\label{\detokenize{ch/functional-analysis/dirac-delta:piece-wise-constant}}\label{\detokenize{ch/functional-analysis/dirac-delta:functional-analysis-dirac-delta-approximations-box}}\begin{equation*}
\begin{split}\delta(x) \sim r_{\varepsilon}(x) = \begin{cases} \frac{1}{\varepsilon} & x \in \left[-\frac{\varepsilon}{2}, \frac{\varepsilon}{2} \right] \\ 0 & \text{otherwise} \end{cases}\end{split}
\end{equation*}\subsubsection*{Properties \sphinxhyphen{} proof.}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Unitariety
\begin{equation*}
\begin{split}\int_{x=-\infty}^{\infty} r_{\varepsilon}(x-x_0) \, dx = \int_{x=x_0-\frac{\varepsilon}{2}}^{x_0+\frac{\varepsilon}{2}} \frac{1}{\varepsilon} \, dx = 1 \ ,  \end{split}
\end{equation*}
\sphinxAtStartPar
for \(\forall \varepsilon\);

\item {} 
\sphinxAtStartPar
Shift property, using mean\sphinxhyphen{}value theorem of continuous functions
\begin{equation*}
\begin{split}\int_{x=-\infty}^{\infty} r_{\varepsilon}(x-x_0) f(x) \, dx = \int_{x=x_0-\frac{\varepsilon}{2}}^{x_0+\frac{\varepsilon}{2}} \frac{1}{\varepsilon} f(x) \, dx = \frac{1}{\varepsilon} \varepsilon f(\xi) \ ,  \end{split}
\end{equation*}
\sphinxAtStartPar
with \(\xi \in \left[x_0-\frac{\varepsilon}{2}, x_0+\frac{\varepsilon}{2}\right]\), for the mean value theorem. As \(\varepsilon \rightarrow 0\), \(\xi \rightarrow x_0\), and thus
\begin{equation*}
\begin{split}\int_{x=-\infty}^{\infty} r_{\varepsilon}(x-x_0) f(x) \, dx \rightarrow f(x_0) \end{split}
\end{equation*}
\end{enumerate}


\subsection{Piecewise\sphinxhyphen{}linear}
\label{\detokenize{ch/functional-analysis/dirac-delta:piecewise-linear}}\label{\detokenize{ch/functional-analysis/dirac-delta:functional-analysis-dirac-delta-approximations-hat}}\begin{equation*}
\begin{split}\delta(x) \sim t_{\varepsilon}(x) = \begin{cases} \frac{2}{\varepsilon} \left( 1 - \frac{2 |x|}{\varepsilon} \right) & x \in \left[-\frac{\varepsilon}{2}, \frac{\varepsilon}{2} \right] \\ 0 & \text{otherwise} \end{cases}\end{split}
\end{equation*}\subsubsection*{Properties \sphinxhyphen{} proof}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Unitariety
\begin{equation*}
\begin{split}\int_{x=-\infty}^{\infty} t_{\varepsilon}(x-x_0) \, dx = \int_{x=x_0-\frac{\varepsilon}{2}}^{x_0+\frac{\varepsilon}{2}} \frac{2}{\varepsilon} \left( 1 - \frac{2 |x|}{\varepsilon} \right) \, dx = \frac{1}{2} \varepsilon \frac{2}{\varepsilon} = 1 \ ,  \end{split}
\end{equation*}
\sphinxAtStartPar
for \(\forall \varepsilon\);

\item {} 
\sphinxAtStartPar
Shift property, using mean\sphinxhyphen{}value integration scheme in \(x \in \left[x_0-\frac{\varepsilon}{2}, x_0 \right]\),  \(x \in \left[x_0, x_0+\frac{\varepsilon}{2} \right]\) (\sphinxstylestrong{todo} \sphinxstyleemphasis{why?})
\begin{equation*}
\begin{split}\begin{aligned}
   \int_{x=-\infty}^{\infty} t_{\varepsilon}(x-x_0) f(x) \, dx
   & = \int_{x=x_0-\frac{\varepsilon}{2}}^{x_0+\frac{\varepsilon}{2}} \frac{2}{\varepsilon} \left( 1 - \frac{2 |x-x_0|}{\varepsilon} \right)  f(x) \, dx = \\
   & = \int_{x=x_0-\frac{\varepsilon}{2}}^{x_0} \frac{2}{\varepsilon} \left( 1 - \frac{2 |x-x_0|}{\varepsilon} \right)  f(x) \, dx 
     + \int_{x=x_0}^{x_0+\frac{\varepsilon}{2}} \frac{2}{\varepsilon} \left( 1 - \frac{2 |x-x_0|}{\varepsilon} \right)  f(x) \, dx = \\
   & = \frac{\varepsilon}{2} \frac{2}{\varepsilon} \left( 1 - \frac{2}{\varepsilon}\frac{\varepsilon}{4} \right)  f\left(x_0-\frac{\varepsilon}{4} \right) \, dx 
     + \frac{\varepsilon}{2} \frac{2}{\varepsilon} \left( 1 - \frac{2}{\varepsilon}\frac{\varepsilon}{4} \right)  f\left(x_0+\frac{\varepsilon}{4} \right) \, dx = \\
   & = \frac{1}{2} f\left( x_0 - \frac{\varepsilon}{4} \right) + \frac{1}{2} f\left( x_0 + \frac{\varepsilon}{4} \right)
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
As \(\varepsilon \rightarrow 0\)
\begin{equation*}
\begin{split}\int_{x=-\infty}^{\infty} t_{\varepsilon}(x-x_0) f(x) \, dx \rightarrow f(x_0) \end{split}
\end{equation*}
\end{enumerate}


\subsection{Gaussian approximation}
\label{\detokenize{ch/functional-analysis/dirac-delta:gaussian-approximation}}\label{\detokenize{ch/functional-analysis/dirac-delta:functional-analysis-dirac-delta-approximations-gaussian}}
\sphinxAtStartPar
For \(\alpha \rightarrow +\infty\),
\begin{equation*}
\begin{split}\varphi_{\alpha}(x) = \sqrt{\frac{\alpha}{\pi}}e^{-\alpha x^2} \sim \delta(x)\end{split}
\end{equation*}\subsubsection*{Properties \sphinxhyphen{} proof}

\sphinxAtStartPar
{\hyperref[\detokenize{ch/complex/fourier-transform:complex-fourier-transform}]{\sphinxcrossref{\DUrole{std,std-ref}{Fourier transform}}}} of \(\varphi_{\alpha}(x)\) reads
\begin{equation*}
\begin{split}\begin{aligned}
 \mathscr{F}\{ \varphi_{\alpha}(x) \}(k)
 & = \int_{x=-\infty}^{+\infty} \varphi_\alpha(x) e^{-ikx} \, dx = \\
 & = \int_{x=-\infty}^{+\infty} \sqrt{\frac{\alpha}{\pi}} e^{-\alpha x^2} e^{-ikx} \, dx = \\
 & = \sqrt{\frac{\alpha}{\pi}} \int_{x=-\infty}^{+\infty} e^{-\alpha \left( x + i \frac{k}{2 \alpha} \right)^2} \, dx \, e^{-\frac{k^2}{4 \alpha}} = \\
 & = \sqrt{\frac{\alpha}{\pi}} \, \sqrt{\frac{\pi}{\alpha}} \, e^{-\frac{k^2}{4 \alpha}} =  e^{-\frac{k^2}{4 \alpha}} \ ,\\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
for \(\alpha \rightarrow +\infty\),
\begin{equation*}
\begin{split}\mathscr{F}\{ \varphi_{\alpha}(x) \}(k) \rightarrow 1\end{split}
\end{equation*}
\sphinxAtStartPar
Fourier transform of Dirac’s delta is \(1\), as shown in \eqref{equation:ch/complex/fourier-transform:eq:complex:fourier:transform:properties:delta}, thus \(\varphi_\alpha(x) \rightarrow \delta(x)\) for \(\alpha \rightarrow +\infty\).


\subsection{Fourier anti\sphinxhyphen{}transform}
\label{\detokenize{ch/functional-analysis/dirac-delta:fourier-anti-transform}}\label{\detokenize{ch/functional-analysis/dirac-delta:functional-analysis-dirac-delta-approximations-fourier-transform}}
\sphinxAtStartPar
For \(a \rightarrow + \infty\),
\begin{equation}\label{equation:ch/functional-analysis/dirac-delta:eq:dirac:fourier-transform}
\begin{split}\delta(x) \sim  \int_{y=-a}^{+a} e^{i 2 \pi y x} \, dy = \frac{1}{2 \pi} \int_{k=-2\pi a}^{2 \pi a} e^{i k x} \, dk \ ,\end{split}
\end{equation}
\sphinxAtStartPar
or
\begin{equation*}
\begin{split}\delta \sim 2 \int_{y=0}^{a} \cos(2 \pi y x) \, dy \ .\end{split}
\end{equation*}\subsubsection*{Proof of the equilvanece}
\begin{equation*}
\begin{split}\begin{aligned}
  \delta(x)
  & \sim \frac{1}{2 \pi} \int_{k=-2\pi a}^{2 \pi a} e^{i k x} \, dk = \frac{1}{2 \pi} \left( \int_{k=-2\pi a}^{0} e^{i k x} \, dk +  \int_{0}^{k=2\pi a} e^{i k x} \, dk \right) = \frac{1}{2 \pi} \int_{k = 0}^{2 \pi a} \left( e^{ikx} + e^{ikx} \right) \, dx = \frac{1}{\pi} \int_{x=0}^{2 \pi a} \cos(k x) \, dk \\
  & = \int_{y=-a}^{+a} e^{i 2 \pi y x} \, dy = \dots = \int_{y = 0}^{a} (e^{i 2 \pi y x} + e^{i 2 \pi y x}) \, dy = 2 \int_{y=0}^{a} \cos(2 \pi y x) \, dy \ .
\end{aligned}\end{split}
\end{equation*}

\subsection{\protect\(\text{sinc}(x)\protect\) approximation}
\label{\detokenize{ch/functional-analysis/dirac-delta:text-sinc-x-approximation}}\label{\detokenize{ch/functional-analysis/dirac-delta:id1}}
\sphinxAtStartPar
For \(a \rightarrow +\infty\)
\begin{equation*}
\begin{split}\delta(x) \sim \frac{\sin(2 \pi x a)}{\pi x}\end{split}
\end{equation*}\subsubsection*{Proof}

\sphinxAtStartPar
Directly follows from integral of the approximation \eqref{equation:ch/functional-analysis/dirac-delta:eq:dirac:fourier-transform}
\begin{equation*}
\begin{split}\int_{y=-a}^{+a} e^{i 2 \pi y x} \, dy = \frac{1}{i 2 \pi x} \left. e^{i 2 \pi y x}\right|_{y=-a}^{+a} = \frac{1}{\pi x} \frac{e^{i 2 \pi a x} - e^{-i 2 \pi a x}}{2 i} = \frac{\sin(2 \pi x a)}{\pi x}\end{split}
\end{equation*}

\subsection{Fourier series}
\label{\detokenize{ch/functional-analysis/dirac-delta:fourier-series}}\label{\detokenize{ch/functional-analysis/dirac-delta:functional-analysis-dirac-delta-approximations-fourier-series}}
\sphinxAtStartPar
For \(x \in [-\pi, \pi]\), and \(N \rightarrow +\infty\), {\hyperref[\detokenize{ch/complex/fourier-series:complex-fourier-series}]{\sphinxcrossref{\DUrole{std,std-ref}{Fourier series}}}} of Dirac’s delta (train with period \(2\pi\)) reads
\begin{equation*}
\begin{split}\delta(x) \sim \frac{1}{2\pi}\sum_{n=-N}^{N} e^{i n x} = \frac{1}{2 \pi} \frac{\sin\left(\left(N+\frac{1}{2}\right)x\right)}{\sin\left( \frac{x}{2} \right)}\end{split}
\end{equation*}
\sphinxAtStartPar
or the \(T\)\sphinxhyphen{}periodic Dirac’s delta train,
\begin{equation*}
\begin{split}\delta(x) \sim \frac{1}{T}\sum_{n=-N}^{N} e^{i n \frac{2\pi}{T} x} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{Write the proof of the last expression, using the relation between complex exponentials and cosine and sine}
\subsubsection*{Proof}

\sphinxAtStartPar
Coefficients of the Fourier series of Dirac’s delta (train with period \(T = 2 \pi\)) are evaluated using the expression \eqref{equation:ch/complex/fourier-series:eq:fourier-series:exp:coeff}
\begin{equation*}
\begin{split}c_n = \frac{1}{2 \pi} \int_{-\pi}^{\pi} \delta(t) e^{-i n \frac{2\pi}{2 \pi}t} = \frac{1}{2\pi} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and thus the complex Fourier series \eqref{equation:ch/complex/fourier-series:eq:fourier-series:exp} of Dirac’s delta reads
\begin{equation*}
\begin{split}\delta(x) \sim \sum_{n=-\infty}^{+\infty} c_n e^{i n \frac{2\pi}{T}x} = \frac{1}{2 \pi} \sum_{n=-\infty}^{+\infty} e^{i n x}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Obs.} here, integration interval \([-\pi,\pi]\) to “avoid troubles” with Dirac’s delta on the extreme points of the interval (it would give \(1/2\) and \(1/2\) contributions on both extremes…)

\sphinxAtStartPar
It’s possible to write the \(T\)\sphinxhyphen{}periodic Dirac’s delta train as
\begin{equation*}
\begin{split}\delta(x) \sim \sum_{n=-\infty}^{+\infty} c_n e^{i n \frac{2\pi}{T}x} = \frac{1}{T} \sum_{n=-\infty}^{+\infty} e^{i n \frac{2\pi}{T} x}\end{split}
\end{equation*}

\phantomsection\label{\detokenize{ch/functional-analysis/dirac-delta:integral-e-x2}}\subsubsection*{Integral \protect\(\ I = \int_{-\infty}^{+\infty} e^{-\alpha x^2} \, dx\protect\)}
\begin{equation*}
\begin{split}\begin{aligned}
  I^2 
  & = \int_{x=-\infty}^{+\infty} e^{-\alpha x^2} \, dx \, \int_{y=-\infty}^{+\infty} e^{-\alpha y^2} \, dy = \\
  & = \int_{x=-\infty}^{+\infty} \int_{y=-\infty}^{+\infty} e^{-\alpha (x^2 + y^2)} \, dx \, dy = \\
  & = \int_{\theta=0}^{2\pi} \int_{r=0}^{+\infty} e^{-\alpha r^2} \, r \, dr \, d \theta = \\
  & = 2 \pi \frac{1}{2 \alpha} \int_{r=0}^{+\infty} e^{-\alpha r^2} d \left(\alpha r^2 \right) = \\
  & = \frac{\pi}{\alpha} \left[ - e^{\alpha r^2} \right]\bigg|_{r = 0}^{+\infty} = \frac{\pi}{\alpha} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxstepscope


\part{Complex Calculus}

\sphinxstepscope


\chapter{Complex Analysis}
\label{\detokenize{ch/complex/analysis:complex-analysis}}\label{\detokenize{ch/complex/analysis:id1}}\label{\detokenize{ch/complex/analysis::doc}}

\section{Complex functions, \protect\(f: \mathbb{C} \rightarrow \mathbb{C}\protect\)}
\label{\detokenize{ch/complex/analysis:complex-functions-f-mathbb-c-rightarrow-mathbb-c}}\label{\detokenize{ch/complex/analysis:complex-analysis-fun}}
\sphinxAtStartPar
A complex function \(f\) of complex variable \(z = x + i y\), \(f: \mathbb{C} \rightarrow \mathbb{C}\), can be written as
\begin{equation*}
\begin{split}f(z) = \tilde{u}(z) + i \tilde{v}(z) = u(x,y) + i v(x,y) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
as the sum of its real part \(u(z)\) and \(i\) times its imaginary part \(v(x,y)\). Here \(x,y \in \mathbb{R}\), while \(\tilde{u}(z), \tilde{v}(z): \mathbb{C} \rightarrow \mathbb{R}\) and \(u(x,y), v(x,y): \mathbb{R}^2 \rightarrow \mathbb{R}\). With some abuse of notation, tilde won’t be always explicitly written when arguments of real and imaginary parts of \(f\) functions won’t be written.


\subsection{Limit}
\label{\detokenize{ch/complex/analysis:limit}}\label{\detokenize{ch/complex/analysis:complex-analysis-fun-limit}}\begin{equation*}
\begin{split}\lim_{z \rightarrow z_0} f(z) = f(z_0) \qquad , \qquad \forall \varepsilon > 0 \ \exists \delta > 0 \ \text{ s.t. } \  |f(z) - f(z_0)| < \delta \ \forall z \text{ s.t. } |z - z_0| < \varepsilon, \ z \ne z_0 \ .\end{split}
\end{equation*}

\subsection{Derivative}
\label{\detokenize{ch/complex/analysis:derivative}}\label{\detokenize{ch/complex/analysis:complex-analysis-fun-derivative}}
\sphinxAtStartPar
Using the definition of {\hyperref[\detokenize{ch/complex/analysis:complex-analysis-fun-derivative}]{\sphinxcrossref{\DUrole{std,std-ref}{limit of complex functions}}}}, the derivative of a function \(f: \mathbb{C} \rightarrow \mathbb{C}\), if it exists, is the limit of incremental ratio,
\begin{equation*}
\begin{split}f'(z) = \lim_{\Delta z \rightarrow 0} \frac{f(z + \Delta z) - f(z)}{\Delta z} \ .\end{split}
\end{equation*}

\subsection{Line Integrals}
\label{\detokenize{ch/complex/analysis:line-integrals}}\label{\detokenize{ch/complex/analysis:complex-analysis-fun-line-integral}}
\sphinxAtStartPar
Given a line \(\gamma \in \mathbb{C}\), whose parametric form is \(z(s)\), with regular parametrization with parameter \(s \in [s_0, s_1]\),
\begin{equation*}
\begin{split}\int_{\gamma} f(z) \, dz = \int_{s=s_0}^{s_1} f(z(s)) \, z'(s) \, ds \ .\end{split}
\end{equation*}

\section{Holomorphic Functions \sphinxhyphen{} Analytic Functions}
\label{\detokenize{ch/complex/analysis:holomorphic-functions-analytic-functions}}\label{\detokenize{ch/complex/analysis:complex-analysis-holo-fun}}\label{ch/complex/analysis:definition-0}
\begin{sphinxadmonition}{note}{Definition 11.2.1}



\sphinxAtStartPar
A holomorphic function is a function whose {\hyperref[\detokenize{ch/complex/analysis:complex-analysis-fun-derivative}]{\sphinxcrossref{\DUrole{std,std-ref}{derivative}}}} exists.
\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{Examples of analytic functions.} \sphinxstylestrong{todo}…


\subsection{Cauchy\sphinxhyphen{}Riemann conditions}
\label{\detokenize{ch/complex/analysis:cauchy-riemann-conditions}}\label{\detokenize{ch/complex/analysis:complex-analysis-holo-fun-cauchy-riemann}}
\sphinxAtStartPar
For a holomorphic function \(f(z) = u(x,y) + i v(x,y)\), Cauchy\sphinxhyphen{}Riemann conditions
\begin{equation*}
\begin{split}\begin{cases}
u_{/x} = v_{/y} \\
u_{/y} = - v_{/x}
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
hold. The evaluation of the derivative once with \(\Delta z = \Delta x\) and once with \(\Delta z = i \Delta y\)
\begin{equation*}
\begin{split}\begin{aligned}
& f'(z) = \lim_{\Delta z \rightarrow 0} \frac{f(z+\Delta z) - f(z)}{\Delta z} = \\ 
& = \left\{
\begin{aligned}
  \lim_{\Delta x \rightarrow 0} \frac{f(x+\Delta x,y) - f(x,y)}{\Delta x} = \lim_{\Delta x \rightarrow 0} \frac{u(x+\Delta x,y) + i v(x+\Delta x,y) - u(x,y) - i v(x,y)}{\Delta x} = u_{/x} + i v_{/x} \\ 
  \lim_{\Delta y \rightarrow 0} \frac{f(x,y+\Delta y) - f(x,y)}{i \Delta y} = \lim_{\Delta y \rightarrow 0}  \frac{u(x,y+\Delta y) + i v(x,y+\Delta y) - u(x,y) - i v(x,y)}{i \Delta y} = -i u_{/y} + v_{/y} \\ 
\end{aligned}
\right.
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
provides the proof.


\subsection{Cauchy Theorem}
\label{\detokenize{ch/complex/analysis:cauchy-theorem}}\label{\detokenize{ch/complex/analysis:complex-analysis-holo-fun-cauchy-thm}}
\sphinxAtStartPar
For a holomorphic function \(f\), \(f: \Omega \subseteq \mathbb{C} \rightarrow \mathbb{C}\)
\begin{equation*}
\begin{split}\oint_{\gamma} f(z) \, dz = 0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
for \(\forall \gamma \subset \Omega\). Proof follows from {\hyperref[\detokenize{ch/multivariable/intro:multivariable-calculus-green-lemma}]{\sphinxcrossref{\DUrole{std,std-ref}{Green’s lemma}}}}, and {\hyperref[\detokenize{ch/complex/analysis:complex-analysis-holo-fun-cauchy-riemann}]{\sphinxcrossref{\DUrole{std,std-ref}{Cauchy\sphinxhyphen{}Riemann conditions}}}}
\begin{equation*}
\begin{split}\begin{aligned}
  \oint_{\gamma} f(z) dz & = \oint_{\gamma} \left( u(x,y) + i v(x,y) \right) \left( dx + i dy \right) = \\
  & = \oint_{\gamma} \left( u dx - v dy \right) + i \oint_{\gamma} \left( u dy + v dx \right) = \\
  & = - \int_{S} \left( \underbrace{u_{/y} + v_{/x}}_{=0} \right) \, dx \, dy + i \int_{S} \left( \underbrace{u_{/x} - v_{/y}}_{=0}  \right) \, dx \, dy = 0 \ .
\end{aligned}\end{split}
\end{equation*}

\section{Useful integrals}
\label{\detokenize{ch/complex/analysis:useful-integrals}}\label{\detokenize{ch/complex/analysis:complex-analysis-useful-int}}

\subsection{Independence of line integral for holomorphic functions}
\label{\detokenize{ch/complex/analysis:independence-of-line-integral-for-holomorphic-functions}}\label{\detokenize{ch/complex/analysis:complex-analysis-useful-int-path-independence}}
\sphinxAtStartPar
For a function \(f(z)\) analytic in \(D\), the line integral on paths \(\ell_{ab,i}\) with the same extreme points \(a\), \(b\) contained in \(D\) is independent on the path, but only depends on the extreme points \(a\), \(b\),
\begin{equation*}
\begin{split}\int_{\ell_{ab,1}} f(z) \, dz = \int_{\ell_{ab,2}} f(z) \, dz\end{split}
\end{equation*}
\sphinxAtStartPar
The proof readily follows, using {\hyperref[\detokenize{ch/complex/analysis:complex-analysis-holo-fun-cauchy-thm}]{\sphinxcrossref{\DUrole{std,std-ref}{Cauchy theorem}}}} applied to a function \(f(z): D \subseteq \mathbb{C} \rightarrow \mathbb{C}\), analytic in \(D\), and splitting the closed path \(\gamma\) into two paths \(\ell_1\), \(\ell_2\) with the same extreme points, \(\gamma = \ell_1 \cup (- \ell_2)\)
\begin{equation*}
\begin{split}0 = \oint_{\gamma} f(z) \, dz = \int_{\ell_1} f(z) \, dz + \int_{-\ell_2} f(z) \, dz = \int_{\ell_1} f(z) \, dz - \int_{\ell_2} f(z) \, dz \ .\end{split}
\end{equation*}

\subsection{Sum and difference of line integrals}
\label{\detokenize{ch/complex/analysis:sum-and-difference-of-line-integrals}}\label{\detokenize{ch/complex/analysis:complex-analysis-useful-int-path-independence-sum}}

\subsection{Integral of \protect\(z^n\protect\)}
\label{\detokenize{ch/complex/analysis:integral-of-z-n}}\label{\detokenize{ch/complex/analysis:complex-analysis-useful-int-path-independence-z-n}}
\sphinxAtStartPar
Given a path \(\gamma\) embracing \(z=0\) only once in counter\sphinxhyphen{}clockwise direction, and \(n \in \mathbb{Z}\)
\begin{equation*}
\begin{split}\oint_{\gamma} z^n \, dz = \left\{ \begin{aligned}  2 \pi i & \qquad \text{if $n = -1$} \\ 0 & \qquad \text{otherwise} \end{aligned} \right.\end{split}
\end{equation*}
\sphinxAtStartPar
Since \(z^n\) is analytic everywhere (\sphinxstylestrong{todo} \sphinxstyleemphasis{prove it! Add a section with proofs for common functions}) except for \(z=0\), it’s possible to evaluate the integral on a circle with center \(z=0\) and radius \(R\). Using polar expression of the complex numbers on the circle, \(z = R e^{i \theta}\), \(\theta \in [0, 2 \pi]\), \(R\) const, the differential becomes \(dz = i R e^{i \theta} d \theta\) and the integral
\begin{equation*}
\begin{split}\begin{aligned}
\oint_{\gamma} z^n \, dz
  & = \int_{\theta=0}^{2 \pi} \left( R e^{i\theta}\right)^n i R e^{i \theta} d \theta = \\
  & = i \int_{\theta=0}^{2 \pi} R^{n+1} e^{i (n+1) \theta} d \theta = \\
  & = \left\{ \begin{aligned}
    & \text{if $n=-1$} & : & \quad  i 2 \pi \\
    & \text{otherwise} & : & \quad  i R^{n+1} \frac{1}{i(n+1)} \left.e^{i(n+1)\theta}\right|_{\theta=0}^{2\pi} = \frac{R^{n+1}}{n+1} ( 1 - 1 ) = 0 \\
  \end{aligned} \right.\\
\end{aligned}\end{split}
\end{equation*}

\section{Meromorphic functions}
\label{\detokenize{ch/complex/analysis:meromorphic-functions}}\label{\detokenize{ch/complex/analysis:complex-analysis-mero-fun}}\label{ch/complex/analysis:definition-1}
\begin{sphinxadmonition}{note}{Definition 11.4.1}



\sphinxAtStartPar
A meromorphic function in a domain is a function holomorphic everywhere except for a (finite?) number of poles. \sphinxstylestrong{check}
\end{sphinxadmonition}


\subsection{Singularities}
\label{\detokenize{ch/complex/analysis:singularities}}\label{\detokenize{ch/complex/analysis:complex-analysis-singularities}}\label{ch/complex/analysis:definition-2}
\begin{sphinxadmonition}{note}{Definition 11.4.2 (Pole)}



\sphinxAtStartPar
A pole of order \(n\) of a function \(f(z)\) is a complex number \(a\) so that
\begin{equation*}
\begin{split}f(z) = \frac{\phi(z)}{(z-a)^n} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\phi(z)\) holomorphic in \(\phi(a) \ne 0\)
\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{Examples.} …
\label{ch/complex/analysis:definition-3}
\begin{sphinxadmonition}{note}{Definition 11.4.3 (Branch)}


\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{Examples.} \(f(z) = z^{\frac{1}{2}}\)
\label{ch/complex/analysis:definition-4}
\begin{sphinxadmonition}{note}{Definition 11.4.4 (Removable singularities)}


\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{Example.} \(f(z) = \frac{\sin z}{z}\)

\sphinxAtStartPar
\sphinxstylestrong{Other irregularities.}


\subsection{Laurent Series}
\label{\detokenize{ch/complex/analysis:laurent-series}}\label{\detokenize{ch/complex/analysis:complex-analysis-mero-fun-laurent}}
\sphinxAtStartPar
Given a function \(f(z)\), in a disk \(D_{a,\varepsilon}: 0 < |z-a| < \varepsilon\), its Laurent series centered in \(a\) is the convergent (to \(f(z)\), \sphinxstylestrong{todo} \sphinxstyleemphasis{which type of convergnence?}) series
\begin{equation}\label{equation:ch/complex/analysis:eq:laurent}
\begin{split}f(z) \sim \sum_{n=-\infty}^{+\infty} a_n (z-a)^n \ ,\end{split}
\end{equation}
\sphinxAtStartPar
with
\begin{equation}\label{equation:ch/complex/analysis:eq:laurent:coeff}
\begin{split}a_n = \frac{1}{2 \pi i}\int_{\gamma} f(z) \, (z-a)^{-(n+1)} \, dz\end{split}
\end{equation}
\sphinxAtStartPar
and \(\gamma\) embracing \(z = a\) once counter\sphinxhyphen{}clockwise. Proof follows immediately inserting the expressions of the coefficients \(a_n\) and using the {\hyperref[\detokenize{ch/complex/analysis:complex-analysis-useful-int-path-independence-z-n}]{\sphinxcrossref{\DUrole{std,std-ref}{integral of \(z^n\)}}}}. Evaluating the integral \eqref{equation:ch/complex/analysis:eq:laurent:coeff} of the coefficients of the Laurent series, using \eqref{equation:ch/complex/analysis:eq:laurent} to replace \(f(z)\) with its series
\begin{equation*}
\begin{split}\begin{aligned}
  a_n & = \frac{1}{2 \pi i}\oint_{\gamma} \sum_{m=-\infty}^{+\infty} a_m (z-a)^m (z-a)^{-(n+1)} = \\
  & = \frac{1}{2 \pi i} \oint_{\gamma} \sum_{m=-\infty}^{+\infty} a_m (z-a)^{m - n - 1}  \, dz = \\
  & = \frac{1}{2 \pi i} \oint_{\gamma} a_n \, z^{-1} \, dz = \\
  & = a_n \ . 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{Some freestyle with function and its convergent series…add some detail, and the meaning of convergence}


\subsection{Cauchy formula}
\label{\detokenize{ch/complex/analysis:cauchy-formula}}\label{\detokenize{ch/complex/analysis:complex-analysis-mero-fun-cauchy-formula}}
\sphinxAtStartPar
For an analytic function \(f(z)\),
\begin{equation*}
\begin{split}f(a) = \frac{1}{2 \pi i} \oint_{\gamma} \frac{f(z)}{z-a} \, dz\end{split}
\end{equation*}
\sphinxAtStartPar
Proof readily follows using the {\hyperref[\detokenize{ch/complex/analysis:complex-analysis-useful-int-path-independence-z-n}]{\sphinxcrossref{\DUrole{std,std-ref}{integral of \(z^n\)}}}} on the Taylor series of \(\frac{f(z)}{z-a}\) whose \(0^{th}\) order term reads \(f(a)\),
\begin{equation*}
\begin{split}\frac{1}{2\pi i} \oint_{\gamma} \frac{f(a)+\sum_{m=1}^{+\infty} f'(a) (z-a)^m}{z-a} \, dz = \frac{1}{2\pi i} \oint_{\gamma} \frac{f(a)}{z-a} \, dz = f(a) \frac{2 \pi i}{2 \pi i} = f(a) \ .\end{split}
\end{equation*}

\subsection{Residues}
\label{\detokenize{ch/complex/analysis:residues}}\label{\detokenize{ch/complex/analysis:complex-analysis-mero-fun-residues}}\label{ch/complex/analysis:definition-5}
\begin{sphinxadmonition}{note}{Definition 11.4.5 (Residue)}



\sphinxAtStartPar
The residue of function \(f\) in \(a\), \(\text{Res}(f,a)\) is a complex number \(R\) so that \(f(z) - \frac{R}{(z-a)}\) has analytic antiderivative in a disk \(D_{a,\varepsilon}: \ 0 < |z-a| < \varepsilon\).
\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{todo} Explain this definition. Couldn’t be possible to use \(\text{Res}(f,a) = \frac{1}{2 \pi i} \oint_{\gamma} f(z) \, dz = a_{-1}\) instead?

\sphinxAtStartPar
\sphinxstylestrong{Properties.}
\begin{itemize}
\item {} 
\sphinxAtStartPar
If \(f(z)\) is analytic in \(D_{a,\varepsilon}\) and has a pole of order \(n\) in \(z = a\), its Laurent series has \(a_m=0\) for \(m < n\) and reads
\begin{equation}\label{equation:ch/complex/analysis:eq:laurent:pole-n}
\begin{split}f(z) = \sum_{m=-n}^{+\infty} a_m (z-a)^m \ ,\end{split}
\end{equation}
\sphinxAtStartPar
with \(a_{-n} \ne 0\). Since \(f(z)\) has a pole of order \(n\) in \(z = a\), it can be written as
\begin{equation*}
\begin{split}f(z) = \frac{\phi(z)}{(z-a)^n} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\phi(z)\) analytic in \(D_{a,\varepsilon}\) and \(\phi(a) \ne 0\). Since \(\phi(z)\) is analytic, it has a Taylor series (or a Laurent series with non\sphinxhyphen{}negative powers),
\begin{equation*}
\begin{split}\phi(z) \sim \sum_{m=0}^{+\infty} b_m (z-a)^m \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
(\sphinxstylestrong{todo} \sphinxstyleemphasis{prove it! Extension of the real case. Add a link to the proof}) and thus
\begin{equation*}
\begin{split}f(z) \sim \sum_{m=0}^{+\infty} b_m (z-a)^{m-n} = \sum_{m=-n}^{+\infty} b_{m+n} (z-a)^{m} = \sum_{m=-n}^{+\infty} a_{m} (z-a)^m \ , \end{split}
\end{equation*}
\sphinxAtStartPar
with \(a_m = b_{m+n}\).

\item {} 
\sphinxAtStartPar
For simple closed path \(\gamma\) (embracing \(a\) only once counter\sphinxhyphen{}clokwise) in \(D_{a, \varepsilon}\),
\begin{equation}\label{equation:ch/complex/analysis:eq:residue-thm:0}
\begin{split}\oint_{\gamma} f(z) \, dz = 2 \pi i a_{-1} = 2 \pi i \text{Res}(f,a)\end{split}
\end{equation}
\sphinxAtStartPar
The proof readily follows, using the {\hyperref[\detokenize{ch/complex/analysis:complex-analysis-useful-int-path-independence-z-n}]{\sphinxcrossref{\DUrole{std,std-ref}{integral of \(z^n\)}}}} and Laurent series \eqref{equation:ch/complex/analysis:eq:laurent} of \(f(z)\),
\begin{equation*}
\begin{split}\oint_{\gamma} f(z) \, dz = \oint_{\gamma} \sum_{m=-\infty}^{+\infty} a_m (z-a)^m \, dz = 2 \pi i a_{-1} \ .\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
For a pole \(a\) of order \(n\), the following holds
\begin{equation*}
\begin{split}a_{-1} =  \frac{1}{(n+1)!} \lim_{z \rightarrow a} \frac{d^{n-1}}{dz^{n-1}} \left[ (z-a)^n \, f(z) \right]\end{split}
\end{equation*}
\sphinxAtStartPar
The proof follows using Laurent series \{eq\}`eq:laurent:pole\sphinxhyphen{}n\} for a function with pole of order \(n\), and evaluating the \((n-1)^{th}\) order derivative
\begin{equation*}
\begin{split}\begin{aligned}
   \frac{d^{n-1}}{dz^{n-1}} \left[ (z-a)^n f(z) \right] 
    & = \frac{d^{n-1}}{dz^{n-1}} \left[ (z-a)^n \sum_{m=-n}^{+\infty} a_n (z-a)^m \right] = \\
    & = \dfrac{d^{n-1}}{dz^{n-1}} \left[ \sum_{m=-n}^{+\infty} a_n (z-a)^{m+n} \right] = \\
    & = \dfrac{d^{n-1}}{dz^{n-1}} \left[ \sum_{m=0}^{+\infty} a_{m-n} (z-a)^{m} \right] = \\
    & = \dfrac{d^{n-2}}{dz^{n-2}} \left[ \sum_{m=0}^{+\infty} m a_{m-n} (z-a)^{m-1} \right] = \\
    & = \dfrac{d^{n-3}}{dz^{n-3}} \left[ \sum_{m=0}^{+\infty} m(m-1) a_{m-n} (z-a)^{m-2} \right] = \\
    & = \dots = \\
    & = \left[ \sum_{m=0}^{+\infty} m! \, a_{m-n} (z-a)^{m-n+1} \right] \\
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and then letting \(z \rightarrow a\), so that only the term with \(m-n+1 = 0\) survives
\begin{equation*}
\begin{split}\lim_{z \rightarrow a} \frac{d^{n-1}}{dz^{n-1}} \left[ (z-a)^n \sum_{m=-n}^{+\infty} a_n (z-a)^m \right] = (n-1)! \, a_{-1} \ .\end{split}
\end{equation*}
\end{itemize}


\subsection{Residue Theorem}
\label{\detokenize{ch/complex/analysis:residue-theorem}}\label{\detokenize{ch/complex/analysis:complex-analysis-mero-fun-residues-thm}}\label{ch/complex/analysis:theorem-6}
\begin{sphinxadmonition}{note}{Theorem 11.4.1 (Residue Theorem)}



\sphinxAtStartPar
Given \(f(z)\) with a finite number of poles \(p_n \in D\), then
\begin{equation*}
\begin{split}\int_{\gamma} f(z) \, dz = 2 \pi i \ \sum_{n} I(\gamma, p_n) \text{Res}(f,p_n) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
being \(\gamma\) a path in \(D\), and \(I(\gamma, p_n)\) the winding index of the path \(\gamma\) around pole \(p_n\) (+1 for each counter\sphinxhyphen{}clockwise loop, \sphinxhyphen{}1 for each clockwise loop).
\end{sphinxadmonition}

\sphinxAtStartPar
The proof readily follows extending the result for a single pole \eqref{equation:ch/complex/analysis:eq:residue-thm:0} to general number of poles and general paths \(\gamma\) embracing (with sign) each pole \(p_n\) \(I(\gamma,p_n)\) times, with the same techinques shown in section {\hyperref[\detokenize{ch/complex/analysis:complex-analysis-useful-int-path-independence-sum}]{\sphinxcrossref{\DUrole{std,std-ref}{Sum and difference of line integrals}}}}.


\subsection{Evaluation of integrals}
\label{\detokenize{ch/complex/analysis:evaluation-of-integrals}}

\subsection{Inverse Laplace Transform}
\label{\detokenize{ch/complex/analysis:inverse-laplace-transform}}
\sphinxAtStartPar
Given Laplace transform
\begin{equation*}
\begin{split}F(s) := \mathscr{L}\{f(t)\}(s) := \int_{t=0^-}^{+\infty} f(t) e^{-st} \, dt \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
the inverse transform can be evaluated as
\begin{equation*}
\begin{split}f(t) = \mathscr{L}^{-1}\{F(s)\}(t) := \lim_{T \rightarrow +\infty} \frac{1}{2 \pi i} \int_{s = a-iT}^{a+iT} e^{st} F(s) \, ds \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(a > \text{Re}\{p_n\}\) (\sphinxstylestrong{todo} \sphinxstyleemphasis{why?}) for each pole of the function \(F(s)\), evaluated on the vertical line \(s = a+iy\), \(y \in [-T,T]\), \(ds = i d y\),
\begin{equation*}
\begin{split}\begin{aligned}
  \lim_{T \rightarrow +\infty} \frac{1}{2 \pi i} \int_{s = a-iT}^{a+iT} e^{st} F(s) \, ds 
  & = \lim_{T \rightarrow +\infty} \frac{1}{2 \pi i} \int_{s = a-iT}^{a+iT} e^{st} \int_{\tau=0^-}^{+\infty} f(\tau) e^{-s\tau} \, d \tau  \, ds = \\
  & = \lim_{T \rightarrow +\infty} \frac{1}{2 \pi i} \int_{y = -T}^{T} e^{(a+iy)t} \int_{\tau=0^-}^{+\infty} f(\tau) e^{-(a+iy)\tau} \, d \tau  \, i dy = \\
  & = \lim_{T \rightarrow +\infty} \frac{1}{2 \pi} \int_{y = -T}^{T} \int_{\tau=0^-}^{+\infty} e^{iy(t-\tau)} e^{a(t-\tau)} f(\tau) \, d \tau  \, dy = \\
  & = \dots \\
  & = \int_{\tau=0^-}^{+\infty} \delta(t-\tau) e^{a(t-\tau)} f(\tau) d \tau = f(t) \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having used the transform of {\hyperref[\detokenize{ch/functional-analysis/dirac-delta:functional-analysis-dirac-delta}]{\sphinxcrossref{\DUrole{std,std-ref}{Dirac’s delta}}}} \(\delta(t) = \frac{1}{2\pi} \int_{\omega=-\infty}^{+\infty} e^{-j \omega t} \, d\omega\).

\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{Ohter approach: if \(a > \text{Re}\{p_n\}\), the contour built with the vertical line with real part \(a\) and the arc of circumference on its…}

\sphinxstepscope


\chapter{Laplace Transform}
\label{\detokenize{ch/complex/laplace:laplace-transform}}\label{\detokenize{ch/complex/laplace:complex-laplace}}\label{\detokenize{ch/complex/laplace::doc}}\begin{equation*}
\begin{split}\mathscr{L}\left\{ f(t) \right\}(s) := \int_{t=0^-}^{+\infty} e^{-st} f(t) \, dt = F(s) \ .\end{split}
\end{equation*}

\section{Inverse transform}
\label{\detokenize{ch/complex/laplace:inverse-transform}}\begin{equation*}
\begin{split}f(t) = \mathscr{L}^{-1}\left\{ F(s) \right\} = \dots\end{split}
\end{equation*}

\section{Properties}
\label{\detokenize{ch/complex/laplace:properties}}
\sphinxAtStartPar
\sphinxstylestrong{Linearity.}
\begin{equation*}
\begin{split}\mathscr{L}\{ a f(t) + b g(t) \}(s) = a F(s) + b G(s)\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{{\hyperref[\detokenize{ch/functional-analysis/dirac-delta:functional-analysis-dirac-delta}]{\sphinxcrossref{\DUrole{std,std-ref}{Dirac delta}}}}.}
\begin{equation*}
\begin{split}\mathscr{L}\left\{ \delta(t) \right\} = \int_{t=0^-}^{+\infty} \delta(t) \, e^{st} \, dt = 1 \end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Time delay.} If \(f(t) = 0\) for \(t < 0\) (“causality”), for \(\tau > 0\),
\begin{equation*}
\begin{split}\mathscr{L}\{ f(t-\tau) \}(s) = e^{-s \tau} F(s)\end{split}
\end{equation*}
\sphinxAtStartPar
Proof readily follows direct computation with change of variable \(z = t - \tau\), \(dt = dz\)
\begin{equation*}
\begin{split}\mathscr{L}\{ f(t - \tau) \}(s) = \int_{t=0^-}^{+\infty} f(t-\tau) e^{-s t} \, dt = \int_{z = - \tau}^{+\infty} f(z) e^{-s z } \, dz \, e^{-s \tau} = \int_{z = 0}^{+\infty} f(z) e^{-s z } \, dz \, e^{-s \tau} = e^{-s \tau} F(s) \ . \end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{“Frequency shift”}
\begin{equation*}
\begin{split}\mathscr{L}\{ f(t) e^{a t} \}(s) = F(s-a)\end{split}
\end{equation*}
\sphinxAtStartPar
Direct computation gives
\begin{equation*}
\begin{split}\mathscr{L}\{ f(t) e^{a t} \}(s) = \int_{t=0^-}^{+\infty} f(t) e^{a t} e^{-st} \, dt =  \int_{t=0^-}^{+\infty} f(t) e^{-(s-a)t} \, dt = F(s-a)\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Derivative.}
\begin{equation*}
\begin{split}\mathscr{L}\{ f'(t) \}(s) = s F(s) - f(0^-) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Proof readily follows direct computation, with integration by parts
\begin{equation*}
\begin{split}\mathscr{L}\{ f'(t) \}(s) = \int_{t=0^-}^{+\infty} f'(t) e^{-s t} \, dt = \left[ f(t) e^{-s t} \right]|_{t = 0^-}^{+\infty} + s \int_{t=0^-}^{+\infty} f(t) e^{-s t} \, dt = s F(s) - f(0^-) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
provided that \(\lim_{s \rightarrow +\infty} f(t) e^{-s t} = 0\).

\sphinxAtStartPar
\sphinxstylestrong{Integral.}
\begin{equation*}
\begin{split}\mathscr{L}\left\{ \int_{\tau=0}^{t} f(\tau) \, d \tau \right\}(s) = \frac{1}{s} F(s) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Proof readily follows direct computation, with integration by parts
\begin{equation*}
\begin{split}\mathscr{L}\left\{ \int_{\tau=0^-}^{t} f(\tau) \, d \tau \right\}(s) = \int_{t=0^-}^{+\infty} \int_{\tau=0^-}^{t} f(\tau) \, d \tau e^{-s t} \, dt = \left[ -\frac{e^{-st}}{s} \int_{\tau=0^-}^{t} f(\tau) \, d\tau \right]_{t=0}^{+\infty} + \frac{1}{s} \int_{t=0}^{+\infty} f(t) e^{-s t} \, dt = \frac{1}{s} F(s) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
provided that \(\int_{\tau=0^-}^{0} f(\tau) d \tau = 0\) and \(\lim_{t \rightarrow +\infty}\frac{e^{-st}}{s} \int_{\tau=0^-}^{+\infty} f(\tau) \, d \tau = 0\).

\sphinxAtStartPar
\sphinxstylestrong{Convolution.}
\begin{equation}\label{equation:ch/complex/laplace:laplace:convolution}
\begin{split}\begin{aligned}
  \mathscr{L}\left\{ f(t) \ast g(t) \right\} 
  & = \int_{t=0^-}^{+\infty} \int_{\tau=-\infty}^{+\infty} f(t-\tau) g(\tau) \, d \tau \, e^{-s t }\, dt = && (1) \\
  & = \int_{\tau=-\infty}^{+\infty} \int_{z=-\tau^-}^{+\infty} f(z) g(\tau) \, e^{-s (z + \tau)}\, d\tau \, dz = (2) \\
  & = \int_{z=0^-}^{+\infty} f(z) \, e^{-s z }\, dz \int_{\tau=0^-}^{+\infty} g(\tau) e^{-s \tau} = \\
  & = \mathscr{L}\{ f(t) \}(s) \, \mathscr{L}\{ g(t) \} (s) \ .
\end{aligned}\end{split}
\end{equation}
\sphinxAtStartPar
having performed the change of coordinates \(z = t - \tau\), \(\tau = \tau\), with unitary Jacobian,
\begin{equation*}
\begin{split}\frac{\partial(t,\tau)}{\partial(z,\tau)} = \partial_z t \partial_{\tau} \tau - \partial_z \tau \partial_z t =  1 \cdot 1 - 1 \cdot 0 = 1 ,\end{split}
\end{equation*}
\sphinxAtStartPar
given the proper description of the domain of integration summarised in the extremes of integration in (1), and causality \sphinxhyphen{} i.e. all the functions \(f(t)\) are identically zero for \(t < 0\) \sphinxhyphen{} in (2).

\sphinxAtStartPar
\sphinxstylestrong{Initial value.} If …
\begin{equation*}
\begin{split}f(0^+) = \lim_{s \rightarrow + \infty} s F(s)\end{split}
\end{equation*}
\sphinxAtStartPar
From direct computation,
\begin{equation*}
\begin{split}\begin{aligned}
 \lim_{s \rightarrow +\infty} s F(s)
 & = \lim_{s \rightarrow +\infty} s \int_{t = 0^-}^{+\infty} f(t) \, e^{-st} \, dt = \\
 & = \lim_{s\rightarrow + \infty} \left\{ \left[s \left(-\frac{e^{-st}}{s}\right)f(t) \right]\bigg|_{t=0}^{+\infty} + \int_{t=0}^{+\infty} e^{-st} f'(t) \, dt \right\} = \\
 & = \lim_{s \rightarrow +\infty} \left\{ \left[-e^{-st} f(t) \right]\bigg|_{t=0}^{+\infty} + \int_{t=0}^{+\infty} e^{-st} f'(t) \, dt \right\} = \\
 & = f(0) \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
provided that \(\lim_{s \rightarrow +\infty} \lim_{t \rightarrow +\infty} e^{-s t} f(t) = 0\) and \(\lim_{s \rightarrow + \infty} \int_{t=0}^{+\infty} e^{-st} f'(t) \, dt = 0\).

\sphinxAtStartPar
\sphinxstylestrong{Final value.} If …
\begin{equation*}
\begin{split}f(+\infty) = \lim_{s \rightarrow 0} s F(s)\end{split}
\end{equation*}
\sphinxAtStartPar
From direct computation (\sphinxstylestrong{todo} \sphinxstyleemphasis{check and/or explain proof}),
\begin{equation*}
\begin{split}\begin{aligned}
 \lim_{s \rightarrow 0} s F(s)
 & = \lim_{s \rightarrow 0} s \int_{t = 0^-}^{+\infty} f(t) \, e^{-st} \, dt = \\
 & = \lim_{s \rightarrow 0} \left\{ \left[s \left(-\frac{e^{-st}}{s}\right)f(t) \right]\bigg|_{t=0}^{+\infty} + \int_{t=0}^{+\infty} e^{-st} f'(t) \, dt \right\} = \\
 & = \lim_{s \rightarrow 0} \left\{ \left[-e^{-st} f(t) \right]\bigg|_{t=0}^{+\infty} + \int_{t=0}^{+\infty} e^{-st} f'(t) \, dt \right\} = \\
 & = f(0) + f(+\infty) - f(0) = f(+\infty) \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
provided that \(\lim_{s \rightarrow 0} \lim_{t \rightarrow +\infty} e^{-s t} f(t) = 0\).

\sphinxstepscope


\chapter{Fourier Transforms}
\label{\detokenize{ch/complex/fourier:fourier-transforms}}\label{\detokenize{ch/complex/fourier:complex-fourier}}\label{\detokenize{ch/complex/fourier::doc}}
\sphinxAtStartPar
Fourier transforms are linear transformations of functions usually relating a physical domain of time and/or space, with a domain of frequency and/or wave\sphinxhyphen{}vectors.

\sphinxAtStartPar
Fourier transforms can be useful in:
\begin{itemize}
\item {} 
\sphinxAtStartPar
highlighting the frequency content of functions

\item {} 
\sphinxAtStartPar
solving problems: sometimes, it can be easier to transform a problem in frequency domain, solve it in frequency domain, and transform the solution back to the physical domain

\end{itemize}
\subsubsection*{Contents.}

\sphinxAtStartPar
{\hyperref[\detokenize{ch/complex/fourier-series:complex-fourier-series}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{Fourier series}}}}}. Fourier series is defined for finite\sphinxhyphen{}domain or periodic, time\sphinxhyphen{}continuous functions, or \sphinxhyphen{} more generally \sphinxhyphen{} continuous functions in the physical domain.

\sphinxAtStartPar
{\hyperref[\detokenize{ch/complex/fourier-transform:complex-fourier-transform}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{Fourier transform}}}}}. Fourier transform is defined for infinite\sphinxhyphen{}domain non\sphinxhyphen{}periodic, time\sphinxhyphen{}continuous functions, or \sphinxhyphen{} more generally \sphinxhyphen{} continuous functions in the physical domain.

\sphinxAtStartPar
{\hyperref[\detokenize{ch/complex/fourier-transforms:complex-fourier-transforms}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{Relations between Fourier transforms and sampling}}}}}. Fourier series, Fourier transform, discrete time Fourier transform and discrete Fourier transforms are presented, and their relations discussed. Fundamental results about \sphinxstylestrong{evenly\sphinxhyphen{}spaced sampling} seamlessly follows, as \sphinxstylestrong{Shannon\sphinxhyphen{}Nyquist theorem}, {\hyperref[\detokenize{ch/complex/fourier-transforms:thm-shannon-nyquist}]{\sphinxcrossref{Theorem 13.3.1}}}, shows.

\sphinxAtStartPar
Different Fourier transforms exist, depending if the original function is:
\begin{itemize}
\item {} 
\sphinxAtStartPar
time discrete/time continuous

\item {} 
\sphinxAtStartPar
periodic/non\sphinxhyphen{}periodic

\end{itemize}

\sphinxstepscope


\section{Fourier Series}
\label{\detokenize{ch/complex/fourier-series:fourier-series}}\label{\detokenize{ch/complex/fourier-series:complex-fourier-series}}\label{\detokenize{ch/complex/fourier-series::doc}}
\sphinxAtStartPar
For a \(T\)\sphinxhyphen{}periodic function,
\begin{equation*}
\begin{split}g(t) \sim \frac{a_0}{2} + \sum_{n=1}^{+\infty} \left[ a_n \, \cos\left( n \frac{2\pi}{T} t \right) + b_n \, \sin\left( n \frac{2 \pi }{T} t \right) \right] \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} Prove it with properties of integrals of \(\sin\) and \(\cos\) over \(t \in \left[ 0, T \right]\); prove convergence to average value at jumps

\sphinxAtStartPar
The exponential form reads
\begin{equation}\label{equation:ch/complex/fourier-series:eq:fourier-series:exp}
\begin{split}g(t) \sim \sum_{n=-\infty}^{+\infty} c_n e^{i n \frac{2 \pi }{T}t} \ ,\end{split}
\end{equation}
\sphinxAtStartPar
where
\begin{equation}\label{equation:ch/complex/fourier-series:eq:fourier-series:exp:coeff}
\begin{split}c_n = \frac{1}{T} \int_{t=0}^{T} f(t) \, e^{-i n \frac{2\pi}{T} t} \ .\end{split}
\end{equation}\subsubsection*{Proof}

\sphinxAtStartPar
Exploiting the properties of integrals of complex exponentials with \(k \in \mathbb{Z}\)
\begin{equation*}
\begin{split}\int_{t=0}^{T} e^{i k \frac{2 \pi}{T} t} \, dt = 
\begin{cases}
\frac{1}{i k \frac{2 \pi}{T}} \left.\left[ e^{ik \frac{2\pi}{T} t} \right]\right|_{t=0}^{T} = 0 & \hfill \qquad \text{if $ k \ne 0$} \\
T & \hfill \text{if $ k = 0$}
\end{cases}
\end{split}
\end{equation*}\begin{equation*}
\begin{split}\int_{t=0}^{T} f(t) e^{-i m \frac{2 \pi}{T} t} \, dt
 \sim \int_{t=0}^{T} \sum_{n=-\infty}^{+\infty} c_n e^{i n \frac{2 \pi }{T}t}  e^{-i m \frac{2 \pi}{T} t}
 \sim \sum_{n=-\infty}^{+\infty} c_n \sim \int_{t=0}^{T} e^{i (n-m) \frac{2 \pi }{T}t} 
 \sim T \, c_m \ .
\end{split}
\end{equation*}
\sphinxstepscope


\section{Fourier Transform}
\label{\detokenize{ch/complex/fourier-transform:fourier-transform}}\label{\detokenize{ch/complex/fourier-transform:complex-fourier-transform}}\label{\detokenize{ch/complex/fourier-transform::doc}}
\sphinxAtStartPar
\sphinxstylestrong{Contents}: {\hyperref[\detokenize{ch/complex/fourier-transform:complex-fourier-transform-def}]{\sphinxcrossref{\DUrole{std,std-ref}{definition}}}}; {\hyperref[\detokenize{ch/complex/fourier-transform:complex-fourier-transform-properties}]{\sphinxcrossref{\DUrole{std,std-ref}{properties}}}}; {\hyperref[\detokenize{ch/complex/fourier-transform:complex-fourier-transform-inverse}]{\sphinxcrossref{\DUrole{std,std-ref}{inverse transform}}}}; {\hyperref[\detokenize{ch/complex/fourier-transform:complex-fourier-transform-plancherel}]{\sphinxcrossref{\DUrole{std,std-ref}{Plancherel’s theorem}}}}; {\hyperref[\detokenize{ch/complex/fourier-transform:complex-fourier-transform-uncertainty}]{\sphinxcrossref{\DUrole{std,std-ref}{uncertainty relation}}}}


\subsection{Definition}
\label{\detokenize{ch/complex/fourier-transform:definition}}\label{\detokenize{ch/complex/fourier-transform:complex-fourier-transform-def}}
\sphinxAtStartPar
…
\begin{equation*}
\begin{split}\mathscr{F}\left\{ g(t) \right\}(f) := \int_{t = -\infty}^{+\infty} g(t) \, e^{-i 2 \pi f t} \, dt .\end{split}
\end{equation*}

\subsection{Properties}
\label{\detokenize{ch/complex/fourier-transform:properties}}\label{\detokenize{ch/complex/fourier-transform:complex-fourier-transform-properties}}
\sphinxAtStartPar
\sphinxstylestrong{Linearity}

\sphinxAtStartPar
\sphinxstylestrong{{\hyperref[\detokenize{ch/functional-analysis/dirac-delta:functional-analysis-dirac-delta}]{\sphinxcrossref{\DUrole{std,std-ref}{Dirac delta}}}}.}
\begin{equation}\label{equation:ch/complex/fourier-transform:eq:complex:fourier:transform:properties:delta}
\begin{split}\mathscr{L}\left\{ \delta(t) \right\} = \int_{t=-\infty}^{+\infty} \delta(t) \, e^{-i 2 \pi f t} \, dt = 1 \end{split}
\end{equation}
\sphinxAtStartPar
\sphinxstylestrong{Time delay.}

\sphinxAtStartPar
\sphinxstylestrong{Derivative.}

\sphinxAtStartPar
\sphinxstylestrong{Integral.}

\sphinxAtStartPar
\sphinxstylestrong{Initial value.}

\sphinxAtStartPar
\sphinxstylestrong{Final value.}


\subsection{Inverse Fourier Transform}
\label{\detokenize{ch/complex/fourier-transform:inverse-fourier-transform}}\label{\detokenize{ch/complex/fourier-transform:complex-fourier-transform-inverse}}
\sphinxAtStartPar
Under the assumptions …\sphinxstylestrong{todo}, the inverse Fourier transform reads
\begin{equation*}
\begin{split}\mathscr{F}^{-1}\left\{ G(f) \right\}(t) := \int_{f = -\infty}^{+\infty} G(f) \, e^{i 2 \pi f t} \, df .\end{split}
\end{equation*}\subsubsection*{Proof using Dirac’s delta expression.}
\begin{equation*}
\begin{split}\begin{aligned}
\mathscr{F}^{-1}\left\{ G(f) \right\}(t) := \int_{f = -\infty}^{+\infty} G(f) \, e^{i 2 \pi f t} \, df 
  & = \int_{f = -\infty}^{+\infty} \int_{\tau=-\infty}^{+\infty} g(\tau) e^{-i 2 \pi f \tau} \, e^{i 2 \pi f t} \, df = \\ 
  & = \int_{f = -\infty}^{+\infty} \int_{\tau=-\infty}^{+\infty} g(\tau) e^{-i 2 \pi f \tau} \, e^{i 2 \pi f t} \, df = \\ 
  & = \int_{f = -\infty}^{+\infty} \int_{\tau=-\infty}^{+\infty} g(\tau) e^{i 2 \pi f (t-\tau)} \, df = \\ 
  & = \int_{\tau=-\infty}^{+\infty} g(\tau) \delta(t-\tau) \, d\tau = g(t) \ . 
\end{aligned}\end{split}
\end{equation*}\subsubsection*{Proof using dominated convergence theorem and Fubini’s lemma.}

\sphinxAtStartPar
\sphinxstylestrong{Proof.} By the \sphinxstyleemphasis{dominated convergence theorem}, it follows that
\begin{equation*}
\begin{split}\begin{aligned}
  \int_{\mathbb{R}} e^{i 2 \pi x \xi} F(\xi) \, d \xi
  & = \lim_{\varepsilon \rightarrow 0} \int_{\mathbb{R}} \underbrace{e^{-\pi \varepsilon^2 \xi^2 + i 2 \pi x \xi}}_{G(\xi;x,\varepsilon)} F(\xi) \, d \xi = \\
  & = \lim_{\varepsilon \rightarrow 0} \int_{\mathbb{R}} g(y;x,\varepsilon) f(y) \, dy = \\
  & = \lim_{\varepsilon \rightarrow 0} \int_{\mathbb{R}} \varphi_{\varepsilon}(x-y) \, f(y) \, dy = \\
  & = \int_{\mathbb{R}} \delta(x-y) \, f(y) \, dy = f(x)
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Lemma 1.} The Fourier transform of function \(\varphi(t):= e^{-\pi|t|^2}\) reads
\begin{equation*}
\begin{split}\begin{aligned}
\mathscr{F}\{ \varphi(t) \}(\omega) 
 & = \int_{t=-\infty}^{+\infty} \varphi(t) e^{-i \omega t} \, dt = \\ 
 & = \int_{t=-\infty}^{+\infty} e^{-\pi|t|^2} e^{-i \omega t} \, dt = \\
 & = \int_{t=-\infty}^{+\infty} e^{-\pi \left( t^2 + i \frac{\omega}{\pi} t - \frac{\omega^2}{4 \pi^2}  \right)} \, dt \, e^{- \frac{\omega^2}{4 \pi^2}} = \\
 & = \int_{t=-\infty}^{+\infty} e^{-\pi \left( t + i \frac{\omega}{2 \pi}  \right)^2} \, dt \, e^{- \frac{\omega^2}{4 \pi}} = \\
 & = e^{- \frac{\omega^2}{4 \pi}} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having evaluated {\hyperref[\detokenize{ch/functional-analysis/dirac-delta:integral-e-x2}]{\sphinxcrossref{\DUrole{std,std-ref}{the integral \(\int_{-\infty}^{+\infty} e^{-\alpha x^2}\)}}}} with \(\alpha = \pi\). \sphinxstylestrong{todo} \sphinxstyleemphasis{justify the result for complex exponential. Use Bromwich contour integrals}

\sphinxAtStartPar
\sphinxstylestrong{Lemma 2.} Fourier transform of \(f(\alpha t)\), \(\alpha > 0\)
\begin{equation*}
\begin{split}\mathscr{F}\{ f(\alpha t) \}(\omega) = \int_{\mathbb{R}} f(\alpha t) e^{-j\omega t} \, dt = \int_{\tau \in \mathbb{R}} f(\tau) e^{-j \frac{\omega}{\alpha} \tau} \, d\tau \frac{1}{\alpha} = \frac{1}{\alpha} F\left(\frac{\omega}{\alpha} \right) \end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Lemma 3.} \(\frac{1}{\varepsilon} \varphi\left(\frac{t}{\varepsilon} \right) \rightarrow \delta(x)\) for \(\varepsilon \rightarrow 0\)
\begin{equation*}
\begin{split}\mathscr{F}\left\{\frac{1}{\varepsilon}\varphi\left(\frac{t}{\varepsilon} \right) \right\}(\omega) = \frac{1}{\varepsilon} \varepsilon e^{-\frac{\omega^2}{4 \pi \varepsilon^2}} = e^{-\frac{\omega^2}{4 \pi \varepsilon^2}}\end{split}
\end{equation*}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{-1}
\item {} 
\sphinxAtStartPar
Fourier transform

\end{enumerate}
\begin{equation*}
\begin{split}G(f) = \int_{t=-\infty}^{\infty} e^{-i \omega t} g(t) \, dt\end{split}
\end{equation*}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\end{enumerate}
\begin{equation*}
\begin{split}g(t) = e^{i \alpha t} \psi(t)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathscr{F}\{ g(t) \}(\omega) = \int_{t=-\infty}^{+\infty} g(t) e^{-i \omega t} \, dt = \int_{t=-\infty}^{+\infty} \psi(t) e^{i \alpha t} e^{-i \omega t} \, dt =  \int_{t=-\infty}^{+\infty} \psi(t) e^{-i (\omega-\alpha) t} \, dt = \mathscr{F}\{ \psi(t) \}(\omega-\alpha) \ .\end{split}
\end{equation*}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{1}
\item {} 
\end{enumerate}
\begin{equation*}
\begin{split}\psi(t) = \phi(\alpha t)\end{split}
\end{equation*}\begin{equation*}
\begin{split}
\mathscr{F}\{ \psi(t) \} 
 = \int_{t=-\infty}^{+\infty} \psi(t) e^{-i \omega t} \, dt 
 = \int_{t=-\infty}^{+\infty} \phi(\alpha t) e^{-i \omega t} \, dt 
 = \int_{\tau = -\infty}^{+\infty} \phi(\tau) e^{-i \frac{\omega}{\alpha} \tau} \, \frac{d \tau}{\alpha} 
 = \frac{1}{\alpha} \mathscr{F}\{ \phi(t) \}\left( \frac{\omega}{\alpha} \right) \ .
\end{split}
\end{equation*}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{2}
\item {} 
\sphinxAtStartPar
Fubini’s theorem

\item {} 
\end{enumerate}
\begin{equation*}
\begin{split}\varphi(t):= e^{-\pi t^2}\end{split}
\end{equation*}\begin{equation*}
\begin{split}
\mathscr{F}\{ \varphi(t) \} 
 = \int_{t=-\infty}^{+\infty} \varphi(t) e^{-i \omega t} \, dt 
 = \int_{t=-\infty}^{+\infty} e^{-\pi t^2} e^{-i \omega t} \, dt 
\end{split}
\end{equation*}\begin{equation*}
\begin{split}0 = \oint_{\gamma} e^{-\alpha |z|^2} \, dz = \int_{\dots} \dots\end{split}
\end{equation*}\begin{equation*}
\begin{split}z = R e^{i \theta}, \quad dz = i R e^{i \theta} d \theta\end{split}
\end{equation*}\begin{equation*}
\begin{split}\int_{C/4} e^{-\alpha |z|^2} \, dz = \int_{\theta=0}^{\frac{\pi}{2}} e^{-\alpha R^2} i R e^{i\theta} d \theta = i R e^{-\alpha R^2 } \frac{e^{-i \theta}}{i}|_{\theta= 0}^{\frac{\pi}{2}}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \int_{t=0}^{+\infty} e^{-\pi t^2} e^{-i \omega t} \, dt 
  & = \int_{t=0}^{+\infty} e^{-\left( \pi t^2 + i \omega t - \frac{\omega^2}{4 \pi} \right)} \, dt \, e^{-\frac{\omega^2}{4 \pi}} = \\
  & = \int_{t=0}^{+\infty} e^{-\pi \left( t + i \frac{\omega}{2 \pi} \right)^2} \, dt \, e^{-\frac{\omega^2}{4 \pi}} \\
\end{aligned}\end{split}
\end{equation*}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{4}
\item {} 
\sphinxAtStartPar
\(\varphi_{\varepsilon}(t) = \frac{1}{\varepsilon^n} \varphi\left( \frac{t}{\varepsilon} \right)\), \(t \in \mathbb{R}^n\), is an approximation of Dirac’s delta for \(\varepsilon \rightarrow 0\), so that
\begin{equation*}
\begin{split}\begin{aligned}
      & \lim_{\varepsilon \rightarrow 0} \int_{t = -\infty}^{+\infty} \varphi_{\varepsilon}(t- \tau) f(t) \, dt = f(\tau) \\
      & \lim_{\varepsilon \rightarrow 0} \int_{t = -\infty}^{+\infty} \varphi_{\varepsilon}(t) \, dt = 1 \\
    \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
As the Fourier transform \(\mathscr{F}\left\{\varphi_{\varepsilon}(t)\right\}(\omega) \rightarrow 1\) for \(\varepsilon \rightarrow 0\), then \(\varphi_{\varepsilon}(t) \rightarrow \delta(t)\).

\end{enumerate}




\subsection{Plancherel’s theorem}
\label{\detokenize{ch/complex/fourier-transform:plancherel-s-theorem}}\label{\detokenize{ch/complex/fourier-transform:complex-fourier-transform-plancherel}}
\sphinxAtStartPar
…assumptions…\sphinxstylestrong{todo}
\begin{equation*}
\begin{split}\int_{f=-\infty}^{+\infty} |G(f)|^2 \, df = \int_{t=-\infty}^{+\infty} |g(t)|^2 \, dt \end{split}
\end{equation*}\subsubsection*{Proof}
\begin{equation*}
\begin{split}\begin{aligned}
\int_{f=-\infty}^{+\infty} |G(f)|^2 \, df 
& = \int_{f=-\infty}^{+\infty} G(f)^* G(f) \, df =  \\
& = \int_{f=-\infty}^{+\infty} \left( \int_{t_1=-\infty}^{+\infty} g(t_1) e^{-i 2 \pi f t_1} dt_1 \right)^* \left( \int_{t_2=-\infty}^{+\infty} g(t_2) e^{-i 2 \pi f t_2} dt_2  \right) \, df =  \\
& =  \int_{t_1, t_2=-\infty}^{+\infty} g^*(t_1) \, g(t_2) \, \int_{f=-\infty}^{+\infty} e^{i 2 \pi f ( t_1 - t_2 )} \, df \, dt_1 \, dt_2 =  && (1) \\
& =  \int_{t_1, t_2=-\infty}^{+\infty} g^*(t_1) \, g(t_2) \, \delta( t_1 - t_2 ) \, dt_1 \, dt_2 = && (2) \\
& =  \int_{t_1=-\infty}^{+\infty} g^*(t_1) \, g(t_1) \, dt_1 = && (3) \\
& =  \int_{t_1=-\infty}^{+\infty} |g(t_1)|^2 \, dt_1 \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having used (1) the approximation \eqref{equation:ch/functional-analysis/dirac-delta:eq:dirac:fourier-transform} of Dirac’s delta, and (2) property \eqref{equation:ch/functional-analysis/dirac-delta:dirac-delta:prop-2} of Dirac’s delta, and (3) the expression of the absolute value of complex functions \(g^*(t_1) g(t_1) = |g(t_1)|^2\).


\subsection{Uncertainty relation}
\label{\detokenize{ch/complex/fourier-transform:uncertainty-relation}}\label{\detokenize{ch/complex/fourier-transform:complex-fourier-transform-uncertainty}}
\sphinxstepscope


\section{Relations between Fourier transforms}
\label{\detokenize{ch/complex/fourier-transforms:relations-between-fourier-transforms}}\label{\detokenize{ch/complex/fourier-transforms:complex-fourier-transforms}}\label{\detokenize{ch/complex/fourier-transforms::doc}}
\sphinxAtStartPar
Some freestyle in changing order of summations and integrals, and use of generalized functions here…check it!

\sphinxAtStartPar
Different Fourier transforms exist, depending if the original function is:
\begin{itemize}
\item {} 
\sphinxAtStartPar
time discrete/time continuous

\item {} 
\sphinxAtStartPar
periodic/non\sphinxhyphen{}periodic

\end{itemize}

\sphinxAtStartPar
namely,
\begin{itemize}
\item {} 
\sphinxAtStartPar
FS, Fourier series: time continuous, periodic function (or finite domain, with a periodic extension)

\item {} 
\sphinxAtStartPar
FT, Fourier transform: time continuous, non\sphinxhyphen{}periodic function

\item {} 
\sphinxAtStartPar
DTFT, discrete\sphinxhyphen{}time Fourier transform: time didscrete, infinite\sphinxhyphen{}length sequence

\item {} 
\sphinxAtStartPar
DFT, discrete Fourier transform: time discrete, finite\sphinxhyphen{}length sequence (and then with a periodic extension)

\end{itemize}


\subsection{Fourier transform of integrable functions}
\label{\detokenize{ch/complex/fourier-transforms:fourier-transform-of-integrable-functions}}\label{\detokenize{ch/complex/fourier-transforms:complex-fourier-transform}}\begin{equation*}
\begin{split}F(\nu) := \mathscr{F}\left\{f(t)\right\}(\nu) := \int_{t=-\infty}^{+\infty} f(t) e^{-i 2 \pi \nu t} \, dt \ ,\end{split}
\end{equation*}

\subsection{Fourier transform of the sum of shifted integrable functions}
\label{\detokenize{ch/complex/fourier-transforms:fourier-transform-of-the-sum-of-shifted-integrable-functions}}\label{\detokenize{ch/complex/fourier-transforms:complex-fourier-series}}
\sphinxAtStartPar
The infinite sum of a shifted integrable function is defined as
\begin{equation*}
\begin{split}\tilde{f}_T(t) = \sum_{n=-\infty}^{+\infty} f(t - nT) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Its Fourier transform reads
\begin{equation*}
\begin{split}\begin{aligned}
  \mathscr{F}\left\{ \tilde{f}_T(t) \right\}(\nu)
  & = \int_{t=-\infty}^{+\infty} \tilde{f}_T(t) e^{-i 2 \pi \nu t} \, dt = \\
  & = \sum_{n=-\infty}^{+\infty} \int_{t=-\infty}^{+\infty} f(t-nT) e^{-i 2 \pi \nu t} \, dt = && (1) \\
  & = \sum_{n=-\infty}^{+\infty} F(\nu) e^{-i 2 \pi \nu n T} = && (2) \\
  & = F(\nu) \sum_{n=-\infty}^{+\infty} e^{-i 2 \pi \nu n T} = && (3) \\
  & = \Delta \nu \, F(\nu) \, \text{III}_{\Delta \nu}(\nu) \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having used properties of Fourier transform of shifted function in (1), and the properties of Dirac’s comb in (3), having defined the frequency resolution
\begin{equation*}
\begin{split}\Delta \nu := \frac{1}{T} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
This Fourier transform is proportional to the Fourier transform of the original function, sampled in frequency with elementary frequency \(\Delta \nu\).


\subsection{Fourier transform of the a function sampled with a Dirac comb \sphinxhyphen{} DTFT}
\label{\detokenize{ch/complex/fourier-transforms:fourier-transform-of-the-a-function-sampled-with-a-dirac-comb-dtft}}\label{\detokenize{ch/complex/fourier-transforms:complex-fourier-dtft}}
\sphinxAtStartPar
Fourier transform of the original function sampled with \(\Delta t \, \text{III}_{\Delta t}(t)\) reads
\begin{equation*}
\begin{split}\begin{aligned}
\mathscr{F}\left\{ \Delta t \, f(t) \, \text{III}_{\Delta t}(t) \right\}
 & = \Delta t \int_{t=-\infty}^{+\infty} f(t) \, \text{III}_{\Delta t}(t) e^{-i 2 \pi \nu t} \, dt =  \\
\end{aligned}\end{split}
\end{equation*}\begin{equation}\label{equation:ch/complex/fourier-transforms:eq:dtft:1}
\begin{split}\begin{aligned}
 & \sim \Delta t \frac{1}{\Delta t} \int_{t=-\infty}^{+\infty} f(t) \, \sum_{n=-\infty}^{+\infty} e^{i n \frac{2 \pi}{\Delta t} t} e^{-i 2 \pi \nu t} \, dt =  \\
 & = \sum_{n=-\infty}^{+\infty}  \int_{t=-\infty}^{+\infty} f(t) \, e^{-i 2 \pi \left( \nu - n \overline{\nu} \right) t} \, dt =  \\
 & = \sum_{n=-\infty}^{+\infty} F\left(\nu - n \overline{\nu} \right) = \text{DTFT}(f(t); \Delta t) \ ,
\end{aligned}\end{split}
\end{equation}
\sphinxAtStartPar
i.e. equals the periodic sum of the Fourier of the original function, with period
\begin{equation*}
\begin{split}\overline{\nu} := \frac{1}{\Delta t} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
From this last sentence and from the {\hyperref[\detokenize{ch/complex/fourier-transforms:complex-fourier-useful-properties-symmetry}]{\sphinxcrossref{\DUrole{std,std-ref}{symmetry properties of Fourier transform}}}}, \sphinxstylestrong{Nyquist\sphinxhyphen{}Shannon sampling theorem} follows seamlessly.
\label{ch/complex/fourier-transforms:thm-shannon-nyquist}
\begin{sphinxadmonition}{note}{Theorem 13.3.1 (Nyquist\sphinxhyphen{}Shannon sampling theorem)}



\sphinxAtStartPar
In order to \sphinxstylestrong{avoid aliasing} the sampling frequency must be twice the maxiumum%
\begin{footnote}[1]\sphinxAtStartFootnote
Usually there’s no such a frequency above which the signal is exactly zero, but usually there’s a frequency above which the spectrum of the signal is approximately zero, i.e. below a threshold where it can be treated as zero, and introduce no aliasing.
%
\end{footnote} frequency in the signal,
\begin{equation*}
\begin{split}\nu_s \ge 2 \nu_{max} \ .\end{split}
\end{equation*}\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{todo} check alternative expressions if using the definition of train of impulses instead of the Fourier series of Dirac’s comb.
\begin{equation}\label{equation:ch/complex/fourier-transforms:eq:dtft:2}
\begin{split}\begin{aligned}
 & = \Delta t \int_{t=-\infty}^{+\infty} f(t) \sum_{k=-\infty}^{+\infty} \delta(t - k \Delta t) \, e^{-i 2 \pi \nu t} \, dt = \\
 & = \Delta t \sum_{k=-\infty}^{+\infty} f(k \Delta t)  e^{-i 2 \pi \nu k \Delta t} = \text{DTFT}\left( f(t); \Delta t \right) 
\end{aligned}\end{split}
\end{equation}

\subsection{Fourier transform of the sum of shifted integral functions sampled with a Dirac comb}
\label{\detokenize{ch/complex/fourier-transforms:fourier-transform-of-the-sum-of-shifted-integral-functions-sampled-with-a-dirac-comb}}\label{\detokenize{ch/complex/fourier-transforms:complex-fourier-dft}}
\sphinxAtStartPar
Fourier transform of the periodic sum
\begin{equation*}
\begin{split}\Delta t \, \tilde{f}(t) \, \text{III}_{\Delta t}(t) = \Delta t \, \sum_{n=-\infty}^{+\infty} f(t-nT) \, \text{III}_{\Delta t}(t) \end{split}
\end{equation*}
\sphinxAtStartPar
reads
\begin{equation*}
\begin{split}\begin{aligned}
\mathscr{F}\left\{ \Delta t \, \tilde{f}(t) \, \text{III}_{\Delta t}(t) \right\}(\nu) 
  & = \Delta t \int_{t=-\infty}^{+\infty} \sum_{n=-\infty}^{+\infty} f(t-nT) \sum_{k=-\infty}^{+\infty} \delta(t-k \Delta t) \, e^{-i 2 \pi \nu t } \, dt = \\
  & = \Delta t \sum_{n=-\infty}^{+\infty} \sum_{k=-\infty}^{+\infty} f(k \Delta t - nT) \, e^{-i 2 \pi \nu k \Delta t } = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and defining \(k \Delta \tau_n := k \Delta t - nT\),
\begin{equation*}
\begin{split}\begin{aligned}
& = \Delta t \sum_{n=-\infty}^{+\infty} \sum_{k=-\infty}^{+\infty} f(k \Delta \tau_n) e^{-i 2 \pi \nu k \Delta \tau_n} e^{-i 2 \pi \nu n T} = \\
& = \underbrace{\Delta t \sum_{k=-\infty}^{+\infty} f(k \Delta \tau_n) e^{-i 2 \pi \nu k \Delta \tau_n}}_{=\text{DTFT}(f(t), \Delta t)} \, \underbrace{\sum_{n=-\infty}^{+\infty} e^{-i 2 \pi \nu n T}}_{= \Delta \nu \, \text{III}_{\Delta \nu}(\nu)} = \\
& = \text{DTFT}(f(t), \Delta t) \, \Delta \nu \, \text{III}_{\Delta \nu}(\nu) \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
 \sphinxstylestrong{todo} \sphinxstylestrong{check!} check the change of coordinates that makes DTFT appear

\sphinxAtStartPar
 \sphinxstylestrong{todo} \sphinxstylestrong{check!} what follows
or, using the relation between \(\Delta t\) and \(T = N \Delta t\), \(\Delta \nu = \frac{1}{T}\), and thus
\begin{equation*}
\begin{split}\Delta t \, \Delta \nu = \Delta t \, \frac{1}{T} = \frac{1}{N} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
it follows
\begin{equation*}
\begin{split}
 = \frac{1}{N} \sum_{k=-\infty}^{+\infty} f(k \Delta \tau_n) e^{-i 2 \pi \nu k \Delta \tau_n} \ \text{III}_{\Delta \nu}(\nu) \ .
\end{split}
\end{equation*}



\subsection{Useful properties}
\label{\detokenize{ch/complex/fourier-transforms:useful-properties}}\label{\detokenize{ch/complex/fourier-transforms:complex-fourier-useful-properties}}

\subsubsection{Dirac’s comb \protect\(\text{III}_T(t)\protect\)}
\label{\detokenize{ch/complex/fourier-transforms:dirac-s-comb-text-iii-t-t}}\label{\detokenize{ch/complex/fourier-transforms:complex-fourier-useful-properties-dirac-comb}}
\sphinxAtStartPar
Dirac comb \(\text{III}_T(t)\) is defined as a train of Dirac’s delta
\begin{equation*}
\begin{split}\text{III}_T(t) = \sum_{m=-\infty}^{+\infty} \delta(t-mT) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Coefficients \eqref{equation:ch/complex/fourier-series:eq:fourier-series:exp:coeff} of the Fourier series \eqref{equation:ch/complex/fourier-series:eq:fourier-series:exp} of a \(T\)\sphinxhyphen{}periodic train of Dirac delta for \(t \in \left[-\frac{T}{2}, \frac{T}{2} \right]\), read
\begin{equation*}
\begin{split}c_n = \frac{1}{T} \int_{t=0}^{T} \delta(t) \, e^{-i n \frac{2\pi}{T} t} = \frac{1}{T} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and thus the Fourier series of Dirac comb \(\text{III}_T(t)\) reads
\begin{equation*}
\begin{split}\text{III}_T(t) = \sum_{m=-\infty}^{+\infty} \delta(t-mT) \sim \frac{1}{T} \sum_{n=-\infty}^{+\infty} e^{i n \frac{2\pi}{T} t} \ .\end{split}
\end{equation*}

\subsubsection{Symmetry of Fourier transform}
\label{\detokenize{ch/complex/fourier-transforms:symmetry-of-fourier-transform}}\label{\detokenize{ch/complex/fourier-transforms:complex-fourier-useful-properties-symmetry}}

\bigskip\hrule\bigskip


\sphinxstepscope


\part{Calculus of Variations}

\sphinxstepscope


\chapter{Introduction to Calculus of Variations}
\label{\detokenize{ch/calculus-variations/intro:introduction-to-calculus-of-variations}}\label{\detokenize{ch/calculus-variations/intro:calculus-variations-intro}}\label{\detokenize{ch/calculus-variations/intro::doc}}
\sphinxAtStartPar
Calculus of variation deals with variations \sphinxhyphen{} i.e. “small changes” \sphinxhyphen{} of functions and functionals.

\sphinxAtStartPar
The meaning of the term functional may vary on the subfield of interest. In the field of calculus of variation, a \sphinxstylestrong{functional} can be defined as a function of function, i.e. a function whose argument is another function.
\subsubsection*{Fields and applications}

\sphinxAtStartPar
Fields and applications related to calculus of variations (give some examples below):
\begin{itemize}
\item {} 
\sphinxAtStartPar
gradient\sphinxhyphen{}based techniques like some methods in:
\begin{itemize}
\item {} 
\sphinxAtStartPar
optimization, either free or constrained (via Lagrange multiplier methods)

\item {} 
\sphinxAtStartPar
sensitivity

\end{itemize}

\item {} 
\sphinxAtStartPar
classical mechanics and physics in general:
\begin{itemize}
\item {} 
\sphinxAtStartPar
analytical mechanics: \sphinxhref{https://basics2022.github.io/bbooks-physics-mechanics/ch/lagrange.html}{Lagrangian formulation} and \sphinxhref{https://basics2022.github.io/bbooks-physics-mechanics/ch/hamilton.html}{Hamiltonian formulation} of classical mechanics

\end{itemize}

\item {} 
\sphinxAtStartPar
…

\end{itemize}
\subsubsection*{Examples}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Lagrange equations for general problem

\item {} 
\sphinxAtStartPar
examples:
\begin{itemize}
\item {} 
\sphinxAtStartPar
brachistochrone for minimum time,…

\item {} 
\sphinxAtStartPar
catenary, i.e. static solution of wire and cables with neglibile bending stiffness

\item {} 
\sphinxAtStartPar
isoperimetric inequality, i.e. circle is the plane closed curve with given perimeter enclosing the largest area

\end{itemize}

\item {} 
\sphinxAtStartPar
sensitivity of results to parameters. Some interesting sensitivity, both in time and trasnformed domains
\begin{itemize}
\item {} 
\sphinxAtStartPar
characteristics of a system:
\begin{itemize}
\item {} 
\sphinxAtStartPar
equilibria

\item {} 
\sphinxAtStartPar
eigenvalues

\item {} 
\sphinxAtStartPar
…

\end{itemize}

\end{itemize}

\item {} 
\sphinxAtStartPar
optimal control methods

\end{itemize}


\section{Lagrange equations}
\label{\detokenize{ch/calculus-variations/intro:lagrange-equations}}\label{\detokenize{ch/calculus-variations/intro:calculus-variations-lagrange}}
\sphinxAtStartPar
Given the functional \(S\), with arguments a function \(q(t)\) and the independent variable \(t\),
\begin{equation*}
\begin{split}S[q(t),t] = \int_{t=t_0}^{t_1} L(\dot{q}(t), \, q(t), \, t) \, dt\end{split}
\end{equation*}
\sphinxAtStartPar
its variation w.r.t. the function \(q(t)\) reads
\begin{equation*}
\begin{split}\delta S[q(t), t] = \lim_{\varepsilon \rightarrow 0} \frac{1}{\varepsilon} \left( S[q(t)+\varepsilon w(t), \, t] - S[q(t),\, t]\right)\end{split}
\end{equation*}
\sphinxAtStartPar
where the function \(w(t)\) is arbitrary, among those satisfying the constraint of the problems: as an example here, if the function \(q(t)\) has prescribed values \(q^*\) for some values of the independent variable, \(t^*\), the variation \(w(t)\) of the function \(q(t)\) is zero there, \(w(t^*)\) so that the variated function \(q(t) + \varepsilon w(t)\) satisfies the constraint as well, i.e. \(q(t^*) + \varepsilon w(t^*) = q^*\).

\sphinxAtStartPar
\sphinxstylestrong{Variation involves only small changes of function arguments}, since these ones are the elements that can be effectively changed, while the independent variable is not.

\sphinxAtStartPar
Direct computation of the variation gives
\begin{equation*}
\begin{split}\begin{aligned}
\delta S[q(t), t]
  & = \lim_{\varepsilon \rightarrow 0} \frac{1}{\varepsilon} \left( S[q(t)+\varepsilon w(t), \, t] - S[q(t),\, t]\right) = \\
  & = \lim_{\varepsilon \rightarrow 0} \frac{1}{\varepsilon} \left( \int_{t = t_0}^{t_1}  L(\dot{q}(t)+\varepsilon w(t), \, q(t)+\varepsilon w(t), \, t) - \int_{t=t_0}^{t_1}  L(\dot{q}(t), \, q(t), \, t) \, dt \right) = \\
  & = \lim_{\varepsilon \rightarrow 0} \frac{1}{\varepsilon} \int_{t = t_0}^{t_1} \left( L(\dot{q}(t)+\varepsilon w(t), \, q(t)+\varepsilon w(t), \, t) - L(\dot{q}(t), \, q(t), \, t) \right) \, dt = \\
  & = \lim_{\varepsilon \rightarrow 0} \frac{1}{\varepsilon} \int_{t = t_0}^{t_1} \left\{ L(\dot{q}(t), \, q(t), \, t) + \varepsilon \left[ \frac{\partial L}{\partial \dot{q}} \dot{w}(t) + \frac{\partial L}{\partial q} w(t) \right] + o(\varepsilon) - L(\dot{q}(t), \, q(t), \, t) \right\} \, dt = \\
  & = \lim_{\varepsilon \rightarrow 0} \frac{1}{\varepsilon} \int_{t = t_0}^{t_1} \left\{ \varepsilon \left[ \frac{\partial L}{\partial \dot{q}} \dot{w}(t) + \frac{\partial L}{\partial q} w(t) \right] + o(\varepsilon) \right\} \, dt = \\
  & = \int_{t = t_0}^{t_1} \left\{ \frac{\partial L}{\partial \dot{q}} \dot{w}(t) + \frac{\partial L}{\partial q} w(t) \right\} \, dt = \\
  & = \left.\left[ w(t) \frac{\partial L}{\partial \dot{q}} \right]\right|_{t=t_0}^{t_1} + \int_{t = t_0}^{t_1} \left\{ - \dfrac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}} \right) + \frac{\partial L}{\partial q} \right\} w(t) \, dt \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
The solution depends on the boundary conditions at the extreme points \(t_0\), \(t_1\). \sphinxstylestrong{If} the value of the function \(q(t)\) is prescribed in \(t_0\) and \(t_1\), \(q(t_0) = q_0\), \(q(t_1) = q_1\), then its variation is zero, \(w(t_0) = w(t_1) = 0\), for the reason that has been discussed above. The variation of the functional with prescribed boundary values of the argument function thus reads
\begin{equation*}
\begin{split}\delta S[q(t), t] = \int_{t = t_0}^{t_1} \left\{ - \dfrac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}} \right) + \frac{\partial L}{\partial q} \right\} \delta q(t) \, dt \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
having called \(w(t) =: \delta q(t)\) to stress that is the variation of function \(q(t)\). This notation \sphinxhyphen{} it’s just notation, it has no special properties \sphinxhyphen{} could be useful if the functional depends on several arguments.

\sphinxAtStartPar
\sphinxstylestrong{Stationary conditions, \(\delta S = 0\).} Stationary condition of the functional \(S\) implies that \(\delta S = 0\) for all the possible variations of the argument function, \(\forall \delta q(t)\). This condition implies that the integrand is identically zero, i.e. \sphinxstylestrong{Lagrange equations},
\begin{equation*}
\begin{split}\frac{d}{dt}\left( \frac{\partial L}{\partial \dot{q}} \right) - \frac{\partial L}{\partial q} = 0 \ ,\end{split}
\end{equation*}

\subsubsection*{Higher\sphinxhyphen{}order derivatives}

\sphinxAtStartPar
\sphinxstylestrong{Method 1.} If the Lagrangian function \(L\) depends on higher order derivatives,
\begin{equation*}
\begin{split}L \left(q^{(n)}(t), \, q^{(n-1)}(t), \, \dots, \, q'(t), \, q(t), \, t \right)\end{split}
\end{equation*}
\sphinxAtStartPar
it’s possible to recast the problem defining the \(n\)\sphinxhyphen{}dimensional function, \(\mathbf{q}(t)\),
\begin{equation*}
\begin{split}\mathbf{q}(t) = \left( q^0(t), q^1(t), \dots, q^{n-1}(t) \right) := \left(q(t), q'(t), \dots, q^{(n-1)}(t) \right) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
With some abuse of notation in \(L\), the functional \(S\) can be recasted as
\begin{equation*}
\begin{split}\begin{aligned}
  S[q(t),t] 
  & = \int_{t=t_0}^{t_1} L(q^{(n)}(t), \, \dots, \, q(t), \, t) \, dt = \\
  & = \int_{t=t_0}^{t_1} L(\dot{\mathbf{q}}(t), \, \mathbf{q}(t), \, t) \, dt \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{Add constraints on components of \(\mathbf{q}(t)\)?}

\sphinxAtStartPar
Repeating the computation, the variation of the functional reads
\begin{equation*}
\begin{split}\delta S[\mathbf{q}(t), t] = \left.\left[ \delta \mathbf{q}^T(t) \frac{\partial L}{\partial \dot{\mathbf{q}}} \right]\right|_{t=t_0}^{t_1} + \int_{t = t_0}^{t_1} \delta \mathbf{q}^T(t) \, \left\{ - \dfrac{d}{dt} \left( \frac{\partial L}{\partial \dot{\mathbf{q}}} \right) + \frac{\partial L}{\partial \mathbf{q}} \right\} \, dt \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Method 2.} …




\subsection{Euler\sphinxhyphen{}Beltrami equation}
\label{\detokenize{ch/calculus-variations/intro:euler-beltrami-equation}}\label{\detokenize{ch/calculus-variations/intro:calculus-variations-euler-beltrami}}
\sphinxAtStartPar
If the Lagrangian function \(L\) is not an explicit function of the independent variable, \(L(q'(x),q(x))\), Euler\sphinxhyphen{}Berltrami equation follows from the derivative of the Lagrangian,
\begin{equation*}
\begin{split}\begin{aligned}
  \frac{d L}{dx} 
  & = \frac{\partial L}{\partial q'} q''(x) + \frac{\partial L}{\partial q} q' = \\
  & = \frac{\partial L}{\partial q'} q'' + \dfrac{d}{dx} \left( \frac{\partial L}{\partial q'} \right) q' = \\
  & = \dfrac{d}{dx} \left( \frac{\partial L}{\partial q'} q' \right) \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and thus
\begin{equation*}
\begin{split}
\dfrac{d}{dx} \left[ L - q' \dfrac{\partial L}{\partial q'} \right] = 0
\qquad \rightarrow \qquad
L - q' \dfrac{\partial L}{\partial q'} = C \quad \text{const.}
\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Note 1.} While Lagrange equations are a set of \(N\) equations if the functional depends on \(N\) argument functions \(q_k(t)\), \(k=1:N\), Euler\sphinxhyphen{}Beltrami equation is an equation only. Indeed for multiple argument functions
\begin{equation*}
\begin{split}\begin{aligned}
  \frac{d L}{dx} 
  & = \frac{\partial L}{\partial q'_k} q''_k(x) + \frac{\partial L}{\partial q_k} q'_k = \\
  & = \frac{\partial L}{\partial q'_k} q''_k + \dfrac{d}{dx} \left( \frac{\partial L}{\partial q'_k} \right) q'_k 
    = \dfrac{d}{dx} \left( \frac{\partial L}{\partial q'_k} q'_k \right) \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
where Einstein’s summation notation of repeated index is used. Euler\sphinxhyphen{}Beltrami thus reads
\begin{equation*}
\begin{split}L(q_l'(x),q_l(x)) - q'_k(x) \frac{\partial L}{\partial q'_k}(q'_l(x), q_l(x)) = C \  .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Note 2.} If the Lagrangian function is an explicit function of the independent variable \(x\), \(L(q'(x), q(x), x)\), it’s not hard to realize that  the derivative of the Lagrangian function, along with the use of the Lagrange equation, gives
\begin{equation*}
\begin{split}\dfrac{d}{dx} \left[ L - q' \dfrac{\partial L}{\partial q'} \right] = \dfrac{\partial L}{\partial x} \ .\end{split}
\end{equation*}\label{ch/calculus-variations/intro:example-0}
\begin{sphinxadmonition}{note}{Example 14.1.1 (Euler\sphinxhyphen{}Beltrami with \protect\(L(q'(x),q(x),x)\protect\), Hamiltonian, energy and E.Noether)}



\sphinxAtStartPar
Euler\sphinxhyphen{}Beltrami equation shows that if \(L(q'(x), q(x))\), thus \(L - q' \partial_{q'} L\) is constant, (or an integral of motion in dynamics). In analytical mechanics (\sphinxhref{https://basics2022.github.io/bbooks-physics-mechanics/ch/lagrange.html}{Lagrange mechanics}, \sphinxhref{https://basics2022.github.io/bbooks-physics-mechanics/ch/hamilton.html}{Hamiltonian mechanics}), Lagrangian and Hamiltonian functions of a system read
\begin{equation*}
\begin{split}\begin{aligned}
  L(\dot{q}_k(t), q_k(t), t) & = T(\dot{q},q,t) + U(q,t) \\
  H(p,q,t) & := p_k \dot{q}_k - L = \dot{q}_k \frac{\partial L}{\partial \dot{q}^k} - L \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having used the common definition of the generalized momenta \(p_k := \frac{\partial L}{\partial \dot{q}^k}\). It should be immediate to realize that the Hamiltonian is just the quantity appearing in Euler\sphinxhyphen{}Beltrami equation (or in its “modified version” if \(\partial_t L \ne 0\)), and thus
\begin{equation*}
\begin{split}\dfrac{d H}{d t} = \dfrac{\partial L}{\partial t} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
In mechanics, if \(\partial_t L = 0\), the Hamiltonian is a constant of motion. In this case, it can be prove that the Hamiltonian is equal to the eneergy of the system.
\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{Classical examples.}
\label{ch/calculus-variations/intro:example-1}
\begin{sphinxadmonition}{note}{Example 14.1.2 (Brachistochrone)}



\sphinxAtStartPar
Find the trajectory…
\begin{itemize}
\item {} 
\sphinxAtStartPar
Elementary length: \(ds = v \, dt\)

\item {} 
\sphinxAtStartPar
Energy: \(E(y) = \frac{1}{2} m v^2 - m g y + C\). Setting \(E = 0\) at starting point, from rest, at \(y_0 = 0\), it implies \(C=0\); thus \(v = \sqrt{2gy}\)

\item {} 
\sphinxAtStartPar
\(x(s), \, y(s)\),

\item {} 
\sphinxAtStartPar
\(ds = \sqrt{dx^2 + dy^2} = \sqrt{1+y'^2(x)} \, dx\)

\end{itemize}
\begin{equation*}
\begin{split}T = \int_{t_0}^{t_1} \, dt = \int_{s_0}^{s_1} \frac{ds}{v} = \int_{x_0}^{x_1} \frac{\sqrt{1+y'^2(x)}}{\sqrt{2gy(x)}} \, dx\end{split}
\end{equation*}
\sphinxAtStartPar
The Lagrangian doesn’t explicitly depend on \(x\), thus Euler\sphinxhyphen{}Beltrami equation can be used. Partial derivative of the Lagrangian function w.r.t. \(q'\) reads
\begin{equation*}
\begin{split}\frac{\partial L}{\partial y'} = ... = \frac{1}{\sqrt{2 g y} \sqrt{1+y'^2}} y' \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and thus Euler\sphinxhyphen{}Beltrami equation reads
\begin{equation*}
\begin{split}C = L - q' \frac{\partial L}{\partial y'} = \frac{ 1 + y'^2 - y'^2}{\sqrt{2 g y} \sqrt{1+y'^2}} = \frac{1}{\sqrt{2 g y} \sqrt{1+y'^2}}\end{split}
\end{equation*}
\sphinxAtStartPar
Squaring \(2 g C^2 = \frac{1}{y(1+y'^2)}\), it’s possible to write
\begin{equation*}
\begin{split}y(x) = \frac{1}{2gC^2(1+y'^2(x))} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
Making the substitution \(y(x)' = \dots\)
\end{sphinxadmonition}
\label{ch/calculus-variations/intro:example-2}
\begin{sphinxadmonition}{note}{Example 14.1.3 (Catenary)}


\end{sphinxadmonition}
\label{ch/calculus-variations/intro:example-3}
\begin{sphinxadmonition}{note}{Example 14.1.4 (Isoperimetric problem)}


\end{sphinxadmonition}

\sphinxstepscope


\part{Ordinary Differential Equations}

\sphinxstepscope


\chapter{Introduction to Ordinary Differential Equations}
\label{\detokenize{ch/ode/intro:introduction-to-ordinary-differential-equations}}\label{\detokenize{ch/ode/intro:ode}}\label{\detokenize{ch/ode/intro::doc}}
\sphinxstepscope


\chapter{Linear Time\sphinxhyphen{}Invariant Systems}
\label{\detokenize{ch/ode/lti:linear-time-invariant-systems}}\label{\detokenize{ch/ode/lti:ode-lti}}\label{\detokenize{ch/ode/lti::doc}}
\sphinxAtStartPar
A linear time invariant system is governed by a linear ODE with constant coefficients. These equations can be recast as a first order system of ODEs,
\begin{equation*}
\begin{split}\begin{cases}
  \dot{\mathbf{x}} = \mathbf{A} \mathbf{x} + \mathbf{B} \mathbf{u} \\
       \mathbf{y}  = \mathbf{C} \mathbf{x} + \mathbf{D} \mathbf{u} \\
  \mathbf{x}(0^-) = \mathbf{x}_0
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Exploiting the {\hyperref[\detokenize{ch/ode/lti:ode-lti-matrix-properties}]{\sphinxcrossref{\DUrole{std,std-ref}{properties of matrix exponential}}}} the general expression of the state can be written as the sum of the free response to initial condition and the forced response.
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{x}(t) & = e^{\mathbf{A}t} \mathbf{x}_0 + \int_{\tau=0^-}^{t} e^{\mathbf{A}(t-\tau)} \mathbf{B} \mathbf{u} (\tau) \, d \tau \\
  \mathbf{y}(t) & = \mathbf{C} e^{\mathbf{A}t} \mathbf{x}_0 + \mathbf{C} \int_{\tau=0^-}^{t} e^{\mathbf{A}(t-\tau)} \mathbf{B} \mathbf{u} (\tau) \, d \tau  + \mathbf{D} \mathbf{u}(t) \\
\end{aligned}\end{split}
\end{equation*}\subsubsection*{Proof in time domain}

\sphinxAtStartPar
Multipying by \(e^{-\mathbf{A} t}\),
\begin{equation*}
\begin{split}\begin{aligned}
  e^{-\mathbf{A}t} ( \dot{x}(t) - \mathbf{A} \mathbf{x}(t) ) & = e^{-\mathbf{A} t} \mathbf{B} \mathbf{u}(t) \\
    \dfrac{d}{dt} \left( \mathbf{x} e^{-\mathbf{A}t} \right) & = e^{-\mathbf{A} t} \mathbf{B} \mathbf{u}(t) \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and integrating from \(0^-\) to a generic time value \(t\),
\begin{equation*}
\begin{split}e^{-\mathbf{A}t} \mathbf{x}(t) - \mathbf{x}_0 = \int_{\tau=0^-}^{t} e^{-\mathbf{A}\tau} \mathbf{B} \mathbf{u} (\tau) \, d \tau\end{split}
\end{equation*}
\sphinxAtStartPar
The state \(\mathbf{x}(t)\) can be written as the sum of the free response and a force response. The general expression of the state and the output as a function reads
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{x}(t) & = e^{\mathbf{A}t} \mathbf{x}_0 + \int_{\tau=0^-}^{t} e^{\mathbf{A}(t-\tau)} \mathbf{B} \mathbf{u} (\tau) \, d \tau \\
  \mathbf{y}(t) & = \mathbf{C} e^{\mathbf{A}t} \mathbf{x}_0 + \mathbf{C} \int_{\tau=0^-}^{t} e^{\mathbf{A}(t-\tau)} \mathbf{B} \mathbf{u} (\tau) \, d \tau  + \mathbf{D} \mathbf{u}(t) \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Laplace domain.}
The {\hyperref[\detokenize{ch/complex/laplace:complex-laplace}]{\sphinxcrossref{\DUrole{std,std-ref}{Laplace transform}}}} of the problem reads
\begin{equation*}
\begin{split}\begin{cases}
   s \hat{\mathbf{x}} = \mathbf{A} \hat{\mathbf{x}} + \mathbf{B} \hat{\mathbf{u}} + \mathbf{x}_0 \\
     \hat{\mathbf{y}} = \mathbf{C} \hat{\mathbf{x}} + \mathbf{D} \hat{\mathbf{u}} \\
\end{cases}\end{split}
\end{equation*}\begin{equation*}
\begin{split}(s\mathbf{I} - \mathbf{A}) \hat{\mathbf{x}} = \mathbf{B} \hat{\mathbf{u}} + \mathbf{x}_0\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \hat{\mathbf{x}}(s) & = (s\mathbf{I} - \mathbf{A})^{-1} \mathbf{x}_0 + (s\mathbf{I} - \mathbf{A})^{-1} \mathbf{B} \hat{\mathbf{u}}(s) \\
  \hat{\mathbf{y}}(s) & = \mathbf{C} (s\mathbf{I} - \mathbf{A})^{-1}\mathbf{x}_0 + \left[ \mathbf{C} (s\mathbf{I} - \mathbf{A})^{-1} \mathbf{B} + \mathbf{D} \right] \hat{\mathbf{u}}(s)
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Performing inverse Laplace transform allows to go back to time domain (just use Laplace inverse transform of a matrix exponential, and the formula \eqref{equation:ch/complex/laplace:laplace:convolution} for Laplace transform of convolution).


\section{Impulsive force}
\label{\detokenize{ch/ode/lti:impulsive-force}}
\sphinxAtStartPar
The effect of an impulsive force at time \(t=0\) is equivalent to an instantaneous change in the initial state, from time \(0^-\) before the impulse to time \(0^+\) after the impulse. Splitting the input \(\mathbf{u}(t)\) as the sum of impulsive input and regular input,
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{u}(t) & = \mathbf{u}_r(t) + \mathbf{u}_\delta \delta(t) \\
  \hat{\mathbf{u}}(s) & = \hat{\mathbf{u}}_r(s) + \mathbf{u}_\delta \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
the solution in time and Laplace domain reads
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{x}(t)
  & = e^{\mathbf{A}t} \mathbf{x}_0 + \int_{\tau=0^-}^{t} e^{\mathbf{A}(t-\tau)} \mathbf{B} \left( \mathbf{u}_r (\tau) + \mathbf{u}_\delta \delta(\tau) \right) \, d \tau = \\ 
  & = e^{\mathbf{A}t} \left( \mathbf{x}_0 + \mathbf{B} \mathbf{u}_\delta \right) + \int_{\tau=0^-}^{t} e^{\mathbf{A}(t-\tau)} \mathbf{B} \mathbf{u}_r (\tau) \, d \tau \\
  \mathbf{y}(t)
  & = \mathbf{C} e^{\mathbf{A}t} \left( \mathbf{x}_0 + \mathbf{B} \mathbf{u}_\delta \right) + \int_{\tau=0^-}^{t} \mathbf{C} e^{\mathbf{A}(t-\tau)} \mathbf{B} \mathbf{u}_r (\tau) \, d \tau + \mathbf{D} \mathbf{u}_r(t) + \mathbf{D} \mathbf{u}_\delta(t) \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}
  \hat{\mathbf{x}}(s) & = (s\mathbf{I} - \mathbf{A})^{-1} \mathbf{B} \hat{\mathbf{u}}_r(s) + (s\mathbf{I} - \mathbf{A})^{-1} \left( \mathbf{x}_0 + \mathbf{B} \mathbf{u}_\delta \right) \\
  \hat{\mathbf{y}}(s) & = \left[ \mathbf{C} (s\mathbf{I} - \mathbf{A})^{-1} \mathbf{B} + \mathbf{D} \right] \hat{\mathbf{u}}_r(s) + \mathbf{C} (s\mathbf{I} - \mathbf{A})^{-1} \left( \mathbf{x}_0 + \mathbf{B} \mathbf{u}_\delta \right) + \mathbf{D} \mathbf{u}_{\delta}
\end{split}
\end{equation*}

\section{Properties}
\label{\detokenize{ch/ode/lti:properties}}\label{\detokenize{ch/ode/lti:ode-lti-matrix-properties}}
\sphinxAtStartPar
\sphinxstylestrong{Matrix exponential.}
\begin{equation*}
\begin{split}e^{\mathbf{A} t} = \sum_{k = 0}^{+\infty} \frac{\mathbf{A}^k t^k}{k!} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Assuming it’s possible swap derivative operator and summation (when?), it’s possible to write
\begin{equation*}
\begin{split}\frac{d}{dt} e^{\mathbf{A}t} = \dfrac{d}{dt} \sum_{k = 0}^{+\infty} \frac{\mathbf{A}^k t^k}{k!} = \sum_{k=1}^{+\infty} k t^{k-1} \frac{\mathbf{A}^k t^{k-1}}{k!} = \mathbf{A} e^{\mathbf{A} t} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Laplace transform of exponential matrix.}
\begin{equation*}
\begin{split}\begin{aligned}
  \mathscr{L}\left\{ e^{\mathbf{A}t} \right\}(s)
  & := \int_{t=0^-}^{+\infty} e^{\mathbf{A} t} e^{-s t} \, dt = \\
  & = \int_{t=0^-}^{+\infty} e^{(-s\mathbf{I} + \mathbf{A}) t} \, dt = \\
  & = (-s\mathbf{I} + \mathbf{A})^{-1} \left.e^{(-s\mathbf{I} + \mathbf{A}) t}\right|_{t=0^-}^{+\infty} = \\
  & = (s \mathbf{I} - \mathbf{A})^{-1} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
for all the values of \(s\) for which \(-s\mathbf{I} + \mathbf{A}\) is asymptotically stable, i.e. has all the eignevalues (thus, assuming that the matrix \(\mathbf{A}\) can be diagonalizable. What happens if not? Exploit other matrix decompositions to draw conclusions) with negative real parts, and thus for all the values of \(s > \max \text{re}\{ s_k(\mathbf{A}) \}\), as it’s shown in {\hyperref[\detokenize{ch/ode/lti:matrix-stability-spectrum}]{\sphinxcrossref{Example 16.2.1}}}
\label{ch/ode/lti:matrix-stability-spectrum}
\begin{sphinxadmonition}{note}{Example 16.2.1 (Asymptotic stability of a matrix \protect\(\ \mathbf{A}\protect\))}



\sphinxAtStartPar
An \(N \times N\) diagnonalizable matrix \(\mathbf{A}\),
\begin{equation}\label{equation:ch/ode/lti:eq:matrix-stability:spectrum:A}
\begin{split}\mathbf{A} \mathbf{v}_k = \mathbf{v}_k \, s_k\end{split}
\end{equation}
\sphinxAtStartPar
has all the eigenvalues with negative real part, \(\text{re}\left\{ s_k \right\} < 0\), \(\forall k=1:N\).

\sphinxAtStartPar
The eigenvalues of a matrix \(a \mathbf{I} + \mathbf{A}\) are \(a + s_k\), while the eigenvectors are the same as those of the matrix \(\mathbf{A}\). This can be easily proved adding \(a \mathbf{I} \mathbf{v}_k\) to both sides of equation \eqref{equation:ch/ode/lti:eq:matrix-stability:spectrum:A},
\begin{equation*}
\begin{split}\left( a \mathbf{I} + \mathbf{A} \right) \mathbf{v}_k = \mathbf{v}_k (a + s_k) \ .\end{split}
\end{equation*}\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{Transform of the convolution.}

\sphinxstepscope


\part{Partial Differential Equations}

\sphinxstepscope


\chapter{Introduction to Partial Differential Equations}
\label{\detokenize{ch/pde/intro:introduction-to-partial-differential-equations}}\label{\detokenize{ch/pde/intro:pde}}\label{\detokenize{ch/pde/intro::doc}}
\sphinxAtStartPar
Partial differential equations usually comes from balance equations in \sphinxstylestrong{continuum mechanics}. Integral equations are the most general form of these equations, and an equivalent differential problem only exists if the fields involved in the equations are regular enough, for their derivatives to exist \sphinxhyphen{} and to apply theorems requiring some regularity of the functions.

\sphinxAtStartPar
Classical numerical methods:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{FVM}: directly solves the \sphinxstylestrong{integral problem}, solving integral balance equations for cells in which the domain is divided

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{FDM}: given the problem in \sphinxstylestrong{differential form}, FDM directly approximates space derivatives of the \sphinxstylestrong{strong formulation} of the problem

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{FEM}: given the problem in \sphinxstylestrong{differential form}, FEM projects the \sphinxstylestrong{weak formulation} of the problem on a finite\sphinxhyphen{}dimensional space

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{BEM}: \sphinxstyleemphasis{integro\sphinxhyphen{}differential equation}, \sphinxstyleemphasis{singularities},…

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Spectral methods},…

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{SEM},…

\end{itemize}


\section{Examples}
\label{\detokenize{ch/pde/intro:examples}}\label{\detokenize{ch/pde/intro:pde-examples}}
\sphinxAtStartPar
In Physics:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Advection equation
\begin{equation*}
\begin{split}\partial_t u + \vec{a} \cdot \nabla u = f\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
Diffusion equation
\begin{equation*}
\begin{split}\partial_t u - \nu \nabla^2 u = f\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
Hyperbolic equation/system of equations
\begin{equation*}
\begin{split}\partial_t \mathbf{u} + \nabla \cdot \mathbf{F}(\mathbf{u}) = \mathbf{f} \end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
Wave equation
\begin{equation*}
\begin{split}\frac{1}{c^2} \partial_{tt} u - \nabla^2 u = f\end{split}
\end{equation*}
\end{itemize}


\section{Balance equations in physics}
\label{\detokenize{ch/pde/intro:balance-equations-in-physics}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Small\sphinxhyphen{}strain continuum mechanics
\begin{equation*}
\begin{split}\rho \partial_{tt} \vec{s} = \rho_0 \vec{g} + \nabla \cdot \symbf{\sigma}(\symbf{\varepsilon})\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
Heat conduction

\item {} 
\sphinxAtStartPar
Fluid dynamics
\begin{itemize}
\item {} 
\sphinxAtStartPar
Navier\sphinxhyphen{}Stokes for compressible fluids  (conservative or convective equations)
\begin{equation*}
\begin{split}\begin{cases}
     \end{cases}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
Navier\sphinxhyphen{}Stokes for incompressible fluids (convective form,…)
\begin{equation*}
\begin{split}\begin{cases}
        \rho \partial_t \vec{u} + \rho (\vec{u} \cdot \nabla ) \vec{u} - \mu \nabla^2 \vec{u} + \nabla P = \rho \vec{g} \\
        \nabla \cdot \vec{u} = 0
     \end{cases}\end{split}
\end{equation*}
\end{itemize}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{todo}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Different forms of equations may be more or less convenient for different solution approaches

\item {} 
\sphinxAtStartPar
Most of the physical laws comes from integral balance equation of the form
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{V_t} \rho \mathbf{u} = \int_{V_t} \rho \mathbf{r} + \oint_{\partial V_t} \hat{n} \cdot \mathbf{T}(\mathbf{u})\end{split}
\end{equation*}
\sphinxAtStartPar
whose local \sphinxhyphen{} differential \sphinxhyphen{} form (in case of differentiable functions) readily follows from the application of Reynolds’ transport theorem and divergence theorem to transform time derivative and boundary terms
\begin{equation*}
\begin{split}\begin{aligned}
     & \partial_t \left( \rho \mathbf{u} \right) + \nabla \cdot (\rho \mathbf{u} \vec{u}) = \rho \mathbf{r} + \nabla \cdot \mathbf{T}(\mathbf{u}) \\
     & \partial_t \left( \rho \mathbf{u} \right) + \nabla \cdot \mathbf{F}(\mathbf{u}) = \rho \mathbf{r} \ ,
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and the physical meaning of each term is evident and readily expalinable as flux or volume or surface sources.

\item {} 
\sphinxAtStartPar
Further manipulation/simplification may cover the clear meaning of the terms of the differential equation. As an example, the conservative form of Navier\sphinxhyphen{}Stokes equations for incompressible fluids with constant and uniform density read
\begin{equation*}
\begin{split}\begin{cases}
    \partial_t \left( \rho \vec{u} \right) + \nabla \cdot ( \rho \vec{u} \otimes \vec{u} ) = \rho \vec{g} + \nabla \cdot \mathbb{T} \\
    \nabla \cdot \vec{u} = 0 \ ,
  \end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
where the stress tensor for a Newtonian fluid reads
\begin{equation*}
\begin{split}\begin{aligned}
    \mathbb{T}
    & = - p \mathbb{I} + 2 \mu \mathbb{D} + \lambda \left( \nabla \cdot \vec{u} \right) \mathbb{I} \\
    & = - p \mathbb{I} + \mu \left( \nabla \vec{u} + \nabla^T \vec{u} \right) + \lambda \left( \nabla \cdot \vec{u} \right) \mathbb{I}
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Using the incompressibility constraint \(\nabla \cdot \vec{u}\), and treating the density \(\rho\) as a constant and uniform parameter, the convective form of the Navier\sphinxhyphen{}Stokes equations reads
\begin{equation*}
\begin{split}\begin{cases}
    \rho \partial_t \vec{u} + \rho \left( \vec{u} \cdot \nabla \right) \vec{u} = \rho \vec{g} - \nabla P + 2 \mu \nabla \cdot \mathbb{D} \\
    \nabla \cdot \vec{u} = 0 \ .
  \end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
The divergence of the viscous stress tensor becomes
\begin{equation*}
\begin{split}2 \mu \nabla \cdot \mathbb{D} = \mu \nabla \cdot \left( \nabla \vec{u} + \nabla^T \vec{u} \right) = \mu \left( \nabla^2 \vec{u} + \nabla \underbrace{\left( \nabla \cdot \vec{u} \right)}_{= 0} \right) = \mu \nabla^2 \vec{u} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
so that one of the most common form of incompressible Navier\sphinxhyphen{}Stokes equations follows
\begin{equation*}
\begin{split}\begin{cases}
    \rho \partial_t \vec{u} + \rho ( \vec{u} \cdot \nabla ) \vec{u} - \mu \nabla^2 \vec{u} + \nabla P = \rho \vec{g} \\
    \nabla \cdot \vec{u} = 0 \ .
  \end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
It should be evident that in the latter form of Navier\sphinxhyphen{}Stokes equations no divergence explicitly appears, so that the right expression of surface source terms can’t be found immediately. In momentum equation, surface source terms come from surface stress acting on the boundary of the domain, whose expression reads
\begin{equation*}
\begin{split}\begin{aligned}
    \vec{t}_n 
    & = \hat{n} \cdot \mathbb{T} = \\
    & = \hat{n} \cdot \left(- P \mathbb{I} + 2 \mu \mathbb{D} \right) = \\
    & = \hat{n} \cdot \left(- P \mathbb{I} + \mu \left( \nabla \vec{u} + \nabla^T \vec{u} \right) \right) = \\
    & = - P \hat{n} +  \hat{n} \cdot \left( \mu \left( \nabla \vec{u} + \nabla^T \vec{u} \right) \right) = \\
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
As an example, in \DUrole{xref,myst}{weak formulation of incompressible Navier\sphinxhyphen{}Stokes problem} the \sphinxstylestrong{natural boundary condition} arising in the method depends on the expression of the strong formulation of the NS problem. If one needs to prescribe stress boundary conditions, it could be an idea to start from NS equations w/o extra simplifications.

\end{itemize}

\sphinxstepscope


\chapter{Elliptic equations}
\label{\detokenize{ch/pde/elliptic:elliptic-equations}}\label{\detokenize{ch/pde/elliptic:pde-elliptic}}\label{\detokenize{ch/pde/elliptic::doc}}

\section{Poisson equation}
\label{\detokenize{ch/pde/elliptic:poisson-equation}}\label{\detokenize{ch/pde/elliptic:pde-elliptic-poisson}}
\sphinxAtStartPar
Given the volume density source \(f(\vec{r})\) and the diffusivity \(\nu(\vec{r})\), Poisson equation for the scalar field \(\phi(\vec{r})\) reads
\begin{equation*}
\begin{split}- \nabla \cdot ( \nu \nabla \phi) = f \qquad \vec{r} \in V\end{split}
\end{equation*}
\sphinxAtStartPar
with proper boundary conditions on \(\partial V\). As an example, tipical boundary conditions are:
\begin{equation*}
\begin{split}\begin{aligned}
  & \phi(\vec{r}) = g(\vec{r}) && \vec{r} \in S_D && \text{esserntial - Dirichlet b.c.}  \\
  & \nu \hat{n} \cdot \nabla \phi(\vec{r}) = h(\vec{r}) && \vec{r} \in S_N && \text{natural - Neumann b.c.}  \\
  & a \phi(\vec{r}) + \nu \hat{n} \cdot \nabla \phi(\vec{r}) = b(\vec{r}) && \vec{r} \in S_R && \text{Robin b.c.} \\
\end{aligned}\end{split}
\end{equation*}

\subsection{Weak formulation}
\label{\detokenize{ch/pde/elliptic:weak-formulation}}\label{\detokenize{ch/pde/elliptic:pde-elliptic-poisson-weak}}
\sphinxAtStartPar
For \(\forall w \in \dots\) (functional space, recall some results about existence and uniqueness of the solution, Lax\sphinxhyphen{}Milgram theorem,…)
\begin{equation*}
\begin{split}\begin{aligned}
  0
  &  = \int_V w \, \left\{ \nabla \cdot (\nu \nabla \phi) + f \right\} = \\
  &  = \oint_{\partial V} w \hat{n} \cdot (\nu \nabla \phi) + \int_V \left\{ - \nu \nabla \vec{w} \cdot \nabla \phi  + w f \right\} = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Splitting boundary contribution as the sum from single contributions from different regions, and applying boundary conditions, setting \(w = 0\) for \(\vec{r} \in S_D\) (see the ways to prescribe essential boundary conditions),
\begin{equation*}
\begin{split}\begin{aligned}
  0 = \int_{S_D} \underbrace{w}_{= 0} \hat{n} \cdot (\nu \nabla \phi) + \int_{S_N} w \underbrace{\hat{n} \cdot (\nu \nabla \phi)}_{ = h} + \int_{S_R} w \underbrace{ \hat{n} \cdot (\nu \nabla \phi)}_{ = b - a \phi } + \int_V \left\{ - \nu \nabla \vec{w} \cdot \nabla \phi  + w f \right\} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and rearranging the equation separating terms containing unknowns from known contributions,
\begin{equation*}
\begin{split}\int_{V} \nu \nabla w \cdot \nabla \phi + \int_{S_R} w a \phi = \int_{V} w f + \int_{S_N} w h + \int_{S_R} w b \qquad \forall w \in \dots \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and \(\phi = g\), for \(\vec{r} \in S_D\).
\subsubsection*{Different ways to prescribe essential boundary conditions}

\sphinxAtStartPar
\sphinxstylestrong{Strong formulation.}

\sphinxAtStartPar
\sphinxstylestrong{Using Lagrance multiplier \sphinxhyphen{} weak formulation of essential boundary conditions.} Adding a the essential boundary condition as a constraint with Lagrange multipliers in the weak formulation of the problem,
\begin{equation*}
\begin{split}\dots + \int_{S_D} w_D ( \phi - g ) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
…

\sphinxstepscope


\chapter{Parabolic equations}
\label{\detokenize{ch/pde/parabolic:parabolic-equations}}\label{\detokenize{ch/pde/parabolic:pde-parabolic}}\label{\detokenize{ch/pde/parabolic::doc}}

\section{Heat equation}
\label{\detokenize{ch/pde/parabolic:heat-equation}}\label{\detokenize{ch/pde/parabolic:pde-parabolic-heat}}
\sphinxAtStartPar
Heat equation for a scalar field \(\phi(\vec{r},t)\) can be interpreted as the unsteady equation of a {\hyperref[\detokenize{ch/pde/elliptic:pde-elliptic-poisson}]{\sphinxcrossref{\DUrole{std,std-ref}{Poisson equation}}}},
\begin{equation*}
\begin{split}\partial_t \phi - \nabla \cdot (\nu \nabla \phi) = f \qquad (\vec{r}, t) \in V \times [0, T] \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with proper boundary and initial conditions, \(\phi(\vec{r},0) = \phi_0(\vec{r})\). Common boundary conditions are the same as the one discussed for Poisson problem.


\subsection{Weak formulation}
\label{\detokenize{ch/pde/parabolic:weak-formulation}}\label{\detokenize{ch/pde/parabolic:pde-parabolic-heat-weak}}
\sphinxAtStartPar
For \(\forall w \in \dots\) (functional space, recall some results about existence and uniqueness of the solution, Lax\sphinxhyphen{}Milgram theorem,…)
\begin{equation*}
\begin{split}\begin{aligned}
  0
  &  = \int_V w \, \left\{ - \partial_t \phi + \nabla \cdot (\nu \nabla \phi) + f \right\} = \\
  &  = \oint_{\partial V} w \hat{n} \cdot (\nu \nabla \phi) + \int_V \left\{ - \partial_t \phi - \nu \nabla \vec{w} \cdot \nabla \phi  + w f \right\} = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Splitting boundary contribution as the sum from single contributions from different regions, and applying boundary conditions, setting \(w = 0\) for \(\vec{r} \in S_D\) (see the ways to prescribe essential boundary conditions),
\begin{equation*}
\begin{split}\begin{aligned}
  0 = \int_{S_D} \underbrace{w}_{= 0} \hat{n} \cdot (\nu \nabla \phi) + \int_{S_N} w \underbrace{\hat{n} \cdot (\nu \nabla \phi)}_{ = h} + \int_{S_R} w \underbrace{ \hat{n} \cdot (\nu \nabla \phi)}_{ = k - \phi } + \int_V \left\{ - \partial_t \phi  - \nu \nabla \vec{w} \cdot \nabla \phi  + w f \right\} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and rearranging the equation separating terms containing unknowns from known contributions,
\begin{equation*}
\begin{split}\int_{V} w \partial_t \phi + \int_{V} \nu \nabla w \cdot \nabla \phi + \int_{S_R} w \phi = \int_{V} w f + \int_{S_N} w h + \int_{S_R} w k \qquad \forall w \in \dots \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and \(\phi = g\), for \(\vec{r} \in S_D\).

\sphinxstepscope


\chapter{Hyperbolic problems}
\label{\detokenize{ch/pde/hyperbolic:hyperbolic-problems}}\label{\detokenize{ch/pde/hyperbolic:pde-hyperbolic}}\label{\detokenize{ch/pde/hyperbolic::doc}}
\sphinxAtStartPar
Hyperbolic problems often come from a small\sphinxhyphen{}amplitude linearization, or as the non\sphinxhyphen{}diffusion (or inviscid) limit of a more general problem.

\sphinxAtStartPar
As a result of these simplification, these problems may experience \sphinxstylestrong{shocks} (i.e. discontinuity in the solution, where the differential equations stop to hold, and integral equations and jump conditions are required). \sphinxstylestrong{todo} \sphinxstyleemphasis{classification of discontinuities on the massflow across the surface}

\sphinxAtStartPar
The very nature of these problem also suggest methods for the solution or the analysis of these equations, like \sphinxstylestrong{characteristic method}.


\section{Scalar linear}
\label{\detokenize{ch/pde/hyperbolic:scalar-linear}}\label{\detokenize{ch/pde/hyperbolic:pde-hyperbolic-scalar-linear}}

\subsection{1\sphinxhyphen{}dimensional}
\label{\detokenize{ch/pde/hyperbolic:dimensional}}\begin{equation*}
\begin{split}\partial_t u(x,t) + a \partial_x u(x,t) = f(x,t)\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Caracteristic method.} \(U(t) = u(X(t), t)\), with the caracteristic curves \(X(t)\) defined as those curves where the PDE becomes a ODE. Evaluating the time derivative of the function \(u(X(t),t)\), the hyperbolic equation can be recast as
\begin{equation*}
\begin{split}\dfrac{d U}{dt} + \left[ a(X(t),t) - \dfrac{d X}{d t} \right] \partial_x u = f(X(t),t) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
The equation of characteristic lines is
\begin{equation*}
\begin{split}\dfrac{d X}{d t} = a(X(t), t) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and the PDE on characteristic line becomes the ODE
\begin{equation*}
\begin{split}\dfrac{d U}{d t}(X(t), t) = f(X(t), t) \ .\end{split}
\end{equation*}

\section{Scalar non\sphinxhyphen{}linear}
\label{\detokenize{ch/pde/hyperbolic:scalar-non-linear}}\label{\detokenize{ch/pde/hyperbolic:pde-hyperbolic-scalar-non-linear}}

\section{System linear}
\label{\detokenize{ch/pde/hyperbolic:system-linear}}\label{\detokenize{ch/pde/hyperbolic:pde-hyperbolic-system-linear}}

\subsection{1\sphinxhyphen{}dimensional}
\label{\detokenize{ch/pde/hyperbolic:id1}}\begin{equation*}
\begin{split}\mathbf{u}(x,t)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\partial_t \mathbf{u} + \mathbf{A} \partial_x \mathbf{u} = \mathbf{f}\end{split}
\end{equation*}

\subsubsection{Method of characteristics}
\label{\detokenize{ch/pde/hyperbolic:method-of-characteristics}}
\sphinxAtStartPar
\sphinxstylestrong{Characteristics.} \(\mathbf{U}(t) = \mathbf{u}(X(t), t)\)
\begin{equation*}
\begin{split}\dfrac{d \mathbf{U}}{dt} - \dfrac{d X}{dt} \partial_x \mathbf{u} + \mathbf{A} \partial_x \mathbf{u} = \mathbf{f}\end{split}
\end{equation*}
\sphinxAtStartPar
In order to get the equations of characteristic lines where PDE turns into ODEs, the eigenproblem
\begin{equation*}
\begin{split}\mathbf{A} \partial_x \mathbf{u} = \dfrac{d X}{d t} \partial_x \mathbf{u} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
holds. This problem has non trivial solution if \(\frac{d X}{dt}\) and \(\partial_x \mathbf{u}\) are pairs of eigenvalues and (right) eigenvectors of the array \(\mathbf{A}\).

\sphinxAtStartPar
\sphinxstylestrong{Diagonalization.}
\begin{equation*}
\begin{split}\mathbf{A} = \mathbf{R} \symbf{\Lambda} \mathbf{L}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{L} \left[ \partial_t \mathbf{u} + \mathbf{R} \symbf{\Lambda} \mathbf{L} \partial_x \mathbf{u} \right] = \mathbf{L} \mathbf{f} \end{split}
\end{equation*}
\sphinxAtStartPar
Since \(\mathbf{L} = \mathbf{R}^{-1}\), and defining the \sphinxstylestrong{characteristic variables} by \(d \mathbf{q} = \mathbf{L} d \mathbf{u}\) \sphinxhyphen{} in linear problems matrix \(\mathbf{A}\) is constant, and so its spectral decomoposition, and thus \(\mathbf{q} = \mathbf{L} \mathbf{u}\) \sphinxhyphen{} , it’s possible to recast the original problem in diagonal form
\begin{equation*}
\begin{split}\partial_t \mathbf{q} + \symbf{\Lambda} \partial_x \mathbf{q} = \mathbf{L} \mathbf{f}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\partial_t q_i + \Lambda_i \partial_x q_i = \sum_{k} L_{ik} \, f_k =: F_i \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Thus, on the \(i^{th}\) family of characteristic lines, \(\dfrac{d X}{dt} = \lambda_i\), \(Q_i(t) = q_i(x(t), t)\) evolves as
\begin{equation*}
\begin{split}\dfrac{d Q_i}{d t} = F_i \ .\end{split}
\end{equation*}
\sphinxAtStartPar
If \(F_i = \left[ \mathbf{L} \mathbf{f} \right]_i = 0\), the characteristic variable \(q_i\) is constant along the characteristic lines. Once the characteristic variables are determined, the conservative variables are evalauted as \(\mathbf{u}(x,t) = \mathbf{R} \mathbf{q}(x,t)\).


\subsubsection{Domain of influence and domain of dependence}
\label{\detokenize{ch/pde/hyperbolic:domain-of-influence-and-domain-of-dependence}}

\subsubsection{Riemann problem}
\label{\detokenize{ch/pde/hyperbolic:riemann-problem}}
\sphinxAtStartPar
A Riemann problem is defined as the evolution of the initial state
\begin{equation*}
\begin{split}\mathbf{u}(x,t_0) =
  \begin{cases}
  \mathbf{u}_a \ , \hfill \quad x < x_0 \\
  \mathbf{u}_b \ , \hfill \quad x > x_0 \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
This problem is quite useful in quite a wide range of numerical methods for hyperbolic problems \sphinxhyphen{} Godunov schemes in Finite Volume Methods \sphinxhyphen{}, to evaluate the \sphinxstylestrong{boundary state} to be used numerical flux.

\sphinxAtStartPar
For linear problems, the matrix \(\mathbf{A}\) is constant ad so it is its spectral decomposition, \(\mathbf{A} = \mathbf{R} \symbf{\Lambda} \mathbf{L}\), and the solution of a Riemann problem of an homogeneous linear hyperbolic system can be easily determined analytically with the method of characteristics,

\sphinxAtStartPar
Let’s change the origin of space and time, so that the initial state is in \(t=0\), and the jump in the initial condiiton in \(x = 0\). Each charactersitic variable \(q_k(x, t)\) is constant on its family of characteristic lines, \(x = X_k(t) = x_{0,k} + \lambda_k t\).
\begin{equation*}
\begin{split}q_k(x,t) = q_k(x_{0,k} + \lambda_k t, t) = q_k(x_{0,k}, 0) = q_k(x - \lambda_k t, 0) = L_{ki} u_j(x - \lambda_k t, 0) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Thus, the solution in conservative variables \(\mathbf{u}(x,t)\) in \(x\) at time \(t\) reads
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{u}(x,t) & = \mathbf{R} \mathbf{q}(x,t) \\
  u_i(x,t) & = R_{ik} q_k(x,t) = R_{ik} q_k(x-\lambda_k t, 0) = R_{ik} L_{kj} u_j(x-\lambda_k t, 0) \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
In a Riemann problem for a \(N\)\sphinxhyphen{}dimensional linear system the solution shows \(N+1\) homogeneous regions (at most, in general the same number as the number of the non\sphinxhyphen{}coincident eigenvalues \(+1\)), delimited by the characteristic lines with origin in the discontinuity. Sorting the eigenvalues in increasing order
\begin{equation*}
\begin{split}\lambda_1 > \lambda_2 > \dots > \lambda_N \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and defining the homogeneous regions
\begin{equation*}
\begin{split}\begin{aligned}
  S_0 & : \frac{x}{t} \in (-\infty, \lambda_1) \\
  S_1 & : \frac{x}{t} \in (\lambda_1, \lambda_2) \\
  \dots & \\
  S_i & : \frac{x}{t} \in (\lambda_i, \lambda_{i+1}) \\ 
  \dots & \\
  S_{N-1} & : \frac{x}{t} \in (\lambda_{N-1}, \lambda_{N}) \\ 
  S_{N}   & : \frac{x}{t} \in (\lambda_{N}, +\infty) \\ 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
the solution is in the \(S_i\) region is
\begin{equation*}
\begin{split}u_i(x,t) = \sum_{\lambda_k > \frac{x}{t}} R_{ik} q_{a,k} +  \sum_{\lambda_k < \frac{x}{t}} R_{ik} q_{b,k}\end{split}
\end{equation*}\label{ch/pde/hyperbolic:example-0}
\begin{sphinxadmonition}{note}{Example 20.3.1 (Linear(ized) P\sphinxhyphen{}system)}



\sphinxAtStartPar
The linear(ized) P\sphinxhyphen{}system around a uniform reference state \(\overline{\rho}\), \(\overline{u}\) in convective form reads
\begin{equation*}
\begin{split}
  \partial_t \begin{bmatrix} \rho \\ u \end{bmatrix} + \begin{bmatrix} \overline{u} & \overline{\rho} \\ \frac{a^2}{\overline{\rho}} & \overline{u} \end{bmatrix} \partial_x \begin{bmatrix} \rho \\ u \end{bmatrix} = \mathbf{0} \ .
\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Spectral decomposition.}
\begin{equation*}
\begin{split}0 = \left| -\lambda \mathbf{I} + \mathbf{A} \right| = (\overline{u}-\lambda)^2 - a^2\end{split}
\end{equation*}\begin{equation*}
\begin{split}\lambda_{12} = \overline{u} \mp a \qquad , \qquad \mathbf{r}_{12} = \begin{bmatrix} \overline{\rho} \\ \mp a \end{bmatrix} \end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{R} & = \begin{bmatrix} \overline{\rho} & \overline{\rho} \\ - a & a \end{bmatrix} \\
  \mathbf{L} & = \mathbf{R}^{-1} = \frac{1}{2 \overline{\rho} a} \begin{bmatrix} a & -\overline{\rho} \\ a & \overline{\rho} \end{bmatrix} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Reference state.}
\begin{equation*}
\begin{split}|u| \ : \  
\begin{cases}
   = 0 \hfill \qquad \text{at rest} \\
   < a \hfill \qquad \text{subsonic flow} \\
   > a \hfill \qquad \text{supersonic flow to the left/right} \\
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
Subsonic: the two families of characteristic lines have opposite direction; supersonic: the two families of characteristic lines have the same direction.
\end{sphinxadmonition}
\label{ch/pde/hyperbolic:example-1}
\begin{sphinxadmonition}{note}{Example 20.3.2 (Linearized shallow water equations)}


\end{sphinxadmonition}
\label{ch/pde/hyperbolic:example-2}
\begin{sphinxadmonition}{note}{Example 20.3.3 (Linearized Euler equations (acoustics))}


\end{sphinxadmonition}
\label{ch/pde/hyperbolic:example-3}
\begin{sphinxadmonition}{note}{Example 20.3.4 (Wave equation)}



\sphinxAtStartPar
A wave equation arises in many different fields of science. As an example, 1\sphinxhyphen{}dimensional wave equation descrives the axial dynamics of a truss
\begin{equation*}
\begin{split}m \partial_{tt} u - EA \partial_{xx} u = f \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
that can be recast in the general expression of wave equation
\begin{equation*}
\begin{split}\partial_{tt} u - c^2 \partial_{xx} u = F\end{split}
\end{equation*}
\sphinxAtStartPar
The \(2^{nd}\) order differential operator appearing in 1\sphinxhyphen{}dimensional wave equation can be factored as the “product” of 2 \(1^{st}\) order differentail operators,
\begin{equation*}
\begin{split}\left( \partial_{tt} - c^2 \partial_{xx} \right) u = \left( \partial_t - c \partial_x \right) \left( \partial_t + c \partial_x \right) u\end{split}
\end{equation*}
\sphinxAtStartPar
and thus a wave equation can be written as
\begin{equation*}
\begin{split}\begin{cases}
  \partial_t u + c \partial_x u - w = 0 \\
  \partial_t w - c \partial_x w     = F \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
In the regime of small displacement, the velocity field is the partial time derivative of the dispalcement field, \(v = \partial_t u\), and the axial force reads \(N = EA \partial_x u\). Exploiting Schwartz’s theorem about mixed partial derivatives to write \(\partial_t N = EA \partial_x v\), it’s possible to write the wave function as the following system of hyperbolic equations in the physical unknowns \(v, N\)
\begin{equation*}
\begin{split}\begin{cases}
  \partial_t N - EA \partial_x v = 0 \\
  \partial_t v - \frac{1}{m}\partial_x N = f
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{P\sphinxhyphen{}system and wave equation \sphinxhyphen{} reference state at rest, \(\ \overline{u} = 0\).}
\begin{equation*}
\begin{split}\begin{cases}
  \partial_t \rho + \overline{\rho} \partial_x u = 0 \\
  \partial_t u    + \frac{a^2}{\overline{\rho}} \partial_x \rho = 0 \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Taking time partial derivative of the first and space partial derivative of the second equation times \(\overline{\rho}\), and evaluating their difference, a wave equation for \(rho\) appears
\begin{equation*}
\begin{split}\partial_{tt} \rho - a^2 \partial_{xx} \rho = 0 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Analogously, taking space derivative of the first and time derivative of the second, a wave equation for the velocity field appears
\begin{equation*}
\begin{split}\partial_{tt} u - a^2 \partial_{xx} u = 0 \ .\end{split}
\end{equation*}\end{sphinxadmonition}


\section{System non\sphinxhyphen{}linear}
\label{\detokenize{ch/pde/hyperbolic:system-non-linear}}\label{\detokenize{ch/pde/hyperbolic:pde-hyperbolic-system-non-linear}}

\subsection{1\sphinxhyphen{}dimensional space}
\label{\detokenize{ch/pde/hyperbolic:dimensional-space}}\begin{equation*}
\begin{split}\mathbf{u}(x,t)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  & \partial_t \mathbf{u} + \partial_x \mathbf{F}(\mathbf{u}) = \mathbf{f}  && \text{(conservative form)} \\
  & \partial_t \mathbf{u} + \partial_{\mathbf{u}} \mathbf{F}(\mathbf{u}) \partial_x \mathbf{u} = \mathbf{f}  && \text{(convective form)} \\
\end{aligned}\end{split}
\end{equation*}

\section{n\sphinxhyphen{}dimensional space}
\label{\detokenize{ch/pde/hyperbolic:n-dimensional-space}}\begin{equation*}
\begin{split}\mathbf{u}(\vec{r}, t)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  & \partial_t \mathbf{u} + \nabla \cdot \mathbf{F}(\mathbf{u}) = \mathbf{f}  && \text{(conservative form)} \\
  & \partial_t \mathbf{u} + \nabla \mathbf{u} \cdot \partial_{\mathbf{u}} \mathbf{F}(\mathbf{u}) = \mathbf{f}  && \text{(convective form)} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Different descritpions of integral problem,
\begin{equation*}
\begin{split}\begin{aligned}
  \dfrac{d}{dt} \int_V \mathbf{u} + \oint_{\partial V} \hat{n} \cdot \mathbf{F}(\mathbf{u}) & = \int_V \mathbf{f} && \quad \text{(Eulerian)} \\
  \dfrac{d}{dt} \int_{V_t} \mathbf{u} - \oint_{\partial V_t} \mathbf{u} \vec{u} \cdot \hat{n} + \oint_{\partial V_t} \hat{n} \cdot \mathbf{F}(\mathbf{u}) & = \int_{V_t} \mathbf{f} && \quad \text{(Lagrangian)} \\
  \dfrac{d}{dt} \int_{v_t} \mathbf{u} - \oint_{\partial v_t} \mathbf{u} \vec{u}_b \cdot \hat{n} + \oint_{\partial v_t} \hat{n} \cdot \mathbf{F}(\mathbf{u}) & = \int_{v_t} \mathbf{f} && \quad \text{(arbitrary)}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{in coordinates}
\begin{equation*}
\begin{split}\begin{aligned} 
  f_i
  & = \partial_t u_i + \partial_{x_k} F_{ki} (u_l) = \\
  & = \partial_t u_i + \partial_{x_k} u_m \partial_{u_m} F_{ki} (u_l) = \\
\end{aligned}\end{split}
\end{equation*}\label{ch/pde/hyperbolic:example-4}
\begin{sphinxadmonition}{note}{Example 20.5.1 (P\sphinxhyphen{}system in 1\sphinxhyphen{}dimensional domain)}


\begin{equation*}
\begin{split}\begin{cases}
 \partial_t \rho + u \partial_x \rho + \rho \partial_x u = 0 \\
 \rho \partial_t u + \rho u \partial_x u + \partial_x P = 0 \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\partial_x P = a^2 \partial_x \rho\),

\sphinxAtStartPar
\sphinxstylestrong{Convective form}
\begin{equation*}
\begin{split}\partial_t \begin{bmatrix} \rho \\ u \end{bmatrix} + \begin{bmatrix} u & \rho \\ \frac{a^2}{\rho} & u \end{bmatrix} \partial_x \begin{bmatrix} \rho \\ u \end{bmatrix} = \underline{0} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Conservative form}
\begin{equation*}
\begin{split}\partial_t \begin{bmatrix} \rho \\ \rho u \end{bmatrix} + \partial_x \begin{bmatrix} \rho u \\ \rho u^2 + \rho a^2 \end{bmatrix} = \underline{0} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Spectral decomposition} of \(\mathbf{A}(\mathbf{u})\) gives
\begin{equation*}
\begin{split}0 = \left| \begin{bmatrix} u - s & \rho \\ \frac{a^2}{\rho} & u - s \end{bmatrix} \right| = (u - s)^2  - a^2\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  s_{1,2} & = u \mp a \\
  \mathbf{R} & = \begin{bmatrix} \rho & \rho \\ a & -a  \end{bmatrix} \\
  \mathbf{L} & = \frac{1}{2 \rho a} \begin{bmatrix} a & \rho \\ a & -\rho  \end{bmatrix} \\
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/pde/hyperbolic:example-5}
\begin{sphinxadmonition}{note}{Example 20.5.2 (Euler equations in 1\sphinxhyphen{}dimensional domain)}



\sphinxAtStartPar
\sphinxstylestrong{Conservative form}
\begin{equation*}
\begin{split}\partial_t \begin{bmatrix} \rho \\ \rho u \\ \rho e^t \end{bmatrix} + \partial_x \begin{bmatrix} \rho u \\ \rho u^2 + P \\ \rho u h^t  \end{bmatrix} = \underline{0} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(h^t = e^t + \frac{P}{\rho}\) and \(e^t = e + \frac{u^2}{2}\), and the pressure field can be written as a function of the other thermodynamic variables. As an example, using conservative variables \((\rho, m, E^t) = (\rho, \rho u, \rho e^t) = \left(\rho, \rho u, \rho \left(e + \frac{u^2}{2}\right) \right)\)
\begin{equation*}
\begin{split}P(\rho, e) = P\left(\rho, \frac{E^t}{\rho} - \frac{m^2}{2 \rho^2}\right) = \Pi\left( \rho, m, E^t \right)\end{split}
\end{equation*}
\sphinxAtStartPar
so that
\begin{equation*}
\begin{split}\begin{aligned}
 \partial_{\rho} \Pi
  & = \partial_\rho P \big|_e + \partial_e P \big|_\rho \left( -\frac{E^t}{\rho^2} + \frac{m^2}{\rho^3} \right) = \\
  & = \partial_\rho P \big|_e + \partial_e P \big|_\rho \left( - \frac{e^t}{\rho} + \frac{u^2}{\rho} \right) \\
  & = c^2 - \frac{P}{\rho^2} \partial_e P \big|_\rho + \partial_e P \big|_\rho \left( - \frac{e^t}{\rho} + \frac{u^2}{\rho} \right) \\
  & = c^2 + \partial_e P \big|_\rho \left( - \frac{h^t}{\rho} + \frac{u^2}{\rho} \right) \\
 \partial_{m   } \Pi & = \partial_e P \big|_\rho \left( - \frac{m}{\rho^2}  \right) \\
 \partial_{E^t } \Pi & = \partial_e P \big|_\rho \left( \frac{1}{\rho} \right) \\
\end{aligned}\end{split}
\end{equation*}


\sphinxAtStartPar
The speed of sound reads
\begin{equation*}
\begin{split}\begin{aligned}
  c^2
  & = \partial_\rho P\big|_s = \\
  & = \partial_\rho P\big|_e + \partial_e P\big|_{\rho} \, \partial_\rho e\big|_s = \\
  & = \partial_\rho P\big|_e + \frac{P}{\rho^2} \partial_e P \big|_{\rho} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Conservative form in conservative variables.}
\begin{equation*}
\begin{split}\partial_t \begin{bmatrix} \rho \\ m \\ E^t \end{bmatrix} + \partial_x \begin{bmatrix} m \\ \frac{m^2}{\rho} + \Pi(\rho,m,E^t) \\ \frac{m}{\rho} \left(E^t + \Pi(\rho, m, E^t)\right)  \end{bmatrix} = \underline{0} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Convective form in conservative variables.}
\begin{equation*}
\begin{split}\partial_t \begin{bmatrix} \rho \\ m \\ E^t \end{bmatrix} + \partial_x \begin{bmatrix} 0 & 1 & 0 \\ - \frac{m^2}{\rho^2} + \partial_\rho \Pi & \frac{2 m}{\rho} + \partial_m \Pi & \partial_{E^t} \Pi \\ - \frac{m}{\rho^2}(E^t+\Pi)+ \frac{m}{\rho}\partial_\rho \Pi & \frac{1}{\rho} (E^t + \Pi) + \frac{m}{ \rho} \partial_{m} \Pi & \frac{m}{\rho} \left( 1 + \partial_{E^t} \Pi \right)  \end{bmatrix} \partial_x \begin{bmatrix} \rho \\ m \\ E^t \end{bmatrix}  = \underline{0} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Spectral decomposition} of \(\mathbf{A}(\mathbf{u})\)
\begin{equation*}
\begin{split}
  0
  & = \left| \begin{bmatrix} -s & 1 & 0 \\ 
   -u^2 + \partial_\rho \Pi & 2 u + \partial_m \Pi - s & \partial_{E^t} \Pi \\
   - u \left(e^t+\frac{P}{\rho} \right)+ u \partial_\rho \Pi & e^t + \frac{P}{\rho} + u \partial_{m} \Pi & u \left( 1 + \partial_{E^t} \Pi \right) - s
  \end{bmatrix} \right| = \\
  & = - s \left[ \left( 2 u + \partial_m \Pi - s  \right) \left( u \left( 1 + \partial_{E^t} \Pi \right) - s \right) - \partial_{E^t} \Pi \left( h^t + u \partial_m \Pi \right) \right] + \\
  & \quad - u h^t \partial_{E^t} \Pi + u \partial_\rho \Pi \partial_{E^t} \Pi + \\
  & \quad + (u^2 - \partial_\rho \Pi) \left( u (1 + \partial_{E^t} \Pi) - s \right) = \\
  & = -s^3 + \\
  & \quad + s^2 \left( 2 u + \partial_m \Pi + u + u \partial_{E^t} \Pi  \right) + \\
  & \quad + s   \left( - 2 u^2 - 2u^2 \partial_{E^t} \Pi - u \partial_m \Pi - u \partial_m \Pi \, \partial_{E^t} \Pi + \partial_{E^t} \Pi \, h^t + u \partial_{E^t} \Pi \, \partial_m \Pi - u^2 + \partial_{\rho} \Pi  \right) + \\
  & \quad +     \left( -u h^t \partial_{E^t} \Pi + u \partial_{\rho} \Pi \, \partial_{E^t} \Pi + u^3 + u^3 \partial_{E^t} \Pi - u \partial_{\rho} \Pi - u \partial_{\rho} \Pi \, \partial_{E^t} \Pi \right) + \\
  & = -s^3 + \\
  & \quad + s^2 \left( 3 u + \partial_m \Pi + u \partial_{E^t} \Pi  \right) + \\
  & \quad + s   \left( - 3 u^2 - 2u^2 \partial_{E^t} \Pi - u \partial_m \Pi + \partial_{E^t} \Pi \, h^t + \partial_{\rho} \Pi  \right) + \\
  & \quad +     \left( u^3 - u h^t \partial_{E^t} \Pi + u^3 \partial_{E^t} \Pi - u \partial_{\rho} \Pi \right) = \\
  & = - (s - u)^3 + ( s - u ) c^2 = \\
  & = ( s - u ) \left[ -(s-u)^2 + c^2 \right]
\end{split}
\end{equation*}
\sphinxAtStartPar
being
\begin{equation*}
\begin{split}\begin{aligned}
  \partial_m \Pi + u \partial_{E^t} \Pi
  & = \left( - \frac{u}{\rho}  + \frac{u}{\rho} \right) \partial_\rho P \big|_e = 0 \\
  - 2u^2 \partial_{E^t} \Pi - u \partial_m \Pi + \partial_{E^t} \Pi \, h^t + \partial_{\rho} \Pi 
  & =  - \frac{u^2}{\rho} \partial_\rho P\big|_e + \frac{1}{\rho} \partial_e P\big|_\rho \, h^t + \partial_\rho P\big|_e + \partial_e P\big|_\rho \left( -\frac{e^t}{\rho} + \frac{u^2}{\rho} \right) = \\
  & = \partial_{e} P \big|_{\rho} \frac{P}{\rho^2} + \partial_{\rho} P \big|_e = \\
  & = c^2 \\
 - u \partial_{\rho} \Pi + u^3 \partial_{E^t} \Pi - u h^t \partial_{E^t} \Pi
  & = u \left( - \partial_\rho P \big|_e - \partial_e P \big|_{\rho} \left( -\frac{e^t}{\rho} + \frac{u^2}{\rho} \right) + \frac{u^2}{\rho} \partial_e P\big|_\rho - \frac{h^t}{\rho} \partial_e P\big|_{\rho}  \right) \\
  & = u \left( -\partial_\rho P\big|_e - \frac{P}{\rho^2} \partial_e P \big|_\rho \right) = \\
  & = - u c^2 \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Thus,
\begin{equation*}
\begin{split}s_{1,3} = u \mp c \quad , \quad s_{2} = u \end{split}
\end{equation*}\begin{equation*}
\begin{split}
\mathbf{r}_{1,3} = \begin{bmatrix} 1 \\ u \mp c \\ \dots \end{bmatrix} \hat{\rho}
 \quad , \quad
\mathbf{r}_2 = \begin{bmatrix} \dots \\ 0 \\ \dots \end{bmatrix} \hat{\rho}
\end{split}
\end{equation*}
\sphinxAtStartPar
being
\begin{equation*}
\begin{split}\begin{aligned}
  \hat{E}^t \partial_{E^t} \Pi
  & = \left[  u^2 - \partial_\rho \Pi + ( -u \pm c -\partial_m \Pi ) (u \mp c) \right] \hat{\rho} = \\
  & = \left[  u^2 - \partial_\rho \Pi - u^2 + \pm 2 u c - c^2  -\partial_m \Pi (u \mp c) \right] \hat{\rho} = \\
  & = \left[ - c^2 - \partial_e P \big|_\rho \left( - \frac{h^t}{\rho} + \frac{u^2}{\rho} \right) \pm 2 u c - c^2  + \frac{u}{\rho} \partial_e P \big|_\rho (u \mp c) \right] \hat{\rho} = \\
  & = \left[ - 2 c^2 + \partial_e P \big|_\rho \, \frac{h^t}{\rho} \pm 2 u c  \mp  \frac{u c}{\rho} \partial_e P\big|_\rho \right] \hat{\rho} = \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{R} = \dots \end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{L} = \dots \end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/pde/hyperbolic:example-6}
\begin{sphinxadmonition}{note}{Example 20.5.3 (Shallow water equation in \protect\(1\protect\)\sphinxhyphen{}dimensional domain)}



\sphinxAtStartPar
Let \(b(x)\)…, \(h(x)\) the height of the free surface, \(\eta(x) = h(x) - b(x)\) the depth.

\sphinxAtStartPar
Derivative of integrals with non\sphinxhyphen{}constant extremes
\begin{equation*}
\begin{split}\partial_x \int_{z=0}^{\eta(x,t)} \rho u \, dz = \int_{z=0}^{\eta(x,t)} \partial_x (\rho u) \, dz + \rho u(x,\eta(x,t),t) \partial_x \eta(x,t) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Continuity equation reads
\begin{equation*}
\begin{split}\partial_t \rho + \partial_x (\rho u ) + \partial_z (\rho w) = 0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
for fluids with constant and uniform density
\begin{equation*}
\begin{split}\begin{aligned}
  0
  & = \int_{z=0}^{\eta(x,t)} \left( \partial_t \rho + \partial_x (\rho u) + \partial_z (\rho w) \right) \, dz = \\
  & = \partial_x \int_{z=0}^{\eta(x,t)} (\rho u) \, dz - \rho u(x,\eta,t) \partial_x \eta + \rho w(x,\eta(x,t),t) = \\
  & = \partial_x \int_{z=0}^{\eta(x,t)} (\rho u) \, dz + \rho \partial_t \eta = 
  & \simeq \partial_x \left(  \rho \eta u \right) + \partial_t \left( \rho \eta \right) \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having linked the velocity to the material derivative of the position, whose vertical component reads
\begin{equation*}
\begin{split}w(x,\eta(x,t), t) = \dfrac{D \eta}{Dt} = \partial_t \eta(x,t) + u(x,\eta(x,t),t) \partial_x \eta \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Assuming hydrostatic pressure distribution, \(p = P_a + \rho g z\) at depth \(z\) under the level of local free surface,

\sphinxAtStartPar
Momentum equation reads
\begin{equation*}
\begin{split}\begin{aligned}
  0
  & = \partial_t (\rho u) + \partial_x (\rho u^2) + \partial_z (\rho u w) + \partial_x P \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and integration in \(z\)\sphinxhyphen{}direction \sphinxstylestrong{todo} Explicitly treat the \(z\) term
\begin{equation*}
\begin{split}\begin{aligned}
  0
  & = \partial_t (\rho \eta u) + \partial_x (\rho u^2 \eta) + \partial_x \int_{z=0}^{\eta(x)} (P_a + \rho g z) \, dz = \\
  & = \partial_t (\rho \eta u) + \partial_x \left(\rho u^2 \eta + \frac{1}{2} \rho g \eta^2 \right)  \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Conservative form of the equations.}
\begin{equation*}
\begin{split}\begin{cases}
  \partial_t (\eta) + \partial_x m = 0 \\
  \partial_t m + \partial_x \left( \frac{m^2}{\eta} + \frac{g \eta^2}{2} \right) = 0 \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Convective form of the equations.}
\begin{equation*}
\begin{split}
  \partial_t \begin{bmatrix} \eta \\ m \end{bmatrix} + \begin{bmatrix} 0 & 1 \\ -\frac{m^2}{\eta^2}+g\eta & 2 \frac{m}{\eta} \end{bmatrix} \partial_x \begin{bmatrix} \eta \\ m \end{bmatrix} = \underline{0}
\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Spectrum of matrix \(\mathbf{A}(\mathbf{u})\).}
\begin{equation*}
\begin{split}0 = |\mathbf{A}(\mathbf{u}) - s^2 \mathbf{I}| = -s \left( 2 u - s \right) + u^2 - g \eta = (s-u)^2 - g  \eta \ .\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/pde/hyperbolic:example-7}
\begin{sphinxadmonition}{note}{Example 20.5.4 (P\sphinxhyphen{}system in n\sphinxhyphen{}dimensional domain)}


\begin{itemize}
\item {} 
\sphinxAtStartPar
Conservative variables: \((\rho, \vec{m})\)

\item {} 
\sphinxAtStartPar
Physical variables: e.g. \((\rho, \vec{u})\), \((P, \vec{u})\),…

\end{itemize}
\begin{equation*}
\begin{split}\begin{cases}
  \partial_t \rho + \nabla \cdot \vec{m} = 0 \\
  \partial_t \vec{m} + \nabla \cdot \left[ \frac{\vec{m}\otimes\vec{m}}{\rho} + \rho a^2 \mathbb{I} \right] = 0 \\
\end{cases}\end{split}
\end{equation*}\end{sphinxadmonition}
\label{ch/pde/hyperbolic:example-8}
\begin{sphinxadmonition}{note}{Example 20.5.5 (Euler system in n\sphinxhyphen{}dimensional domain)}


\begin{itemize}
\item {} 
\sphinxAtStartPar
Conservative variables: \((\rho, \vec{m}, E^t)\)

\item {} 
\sphinxAtStartPar
Physical variables: e.g. \((\rho, \vec{u}, e)\),…

\end{itemize}
\begin{equation*}
\begin{split}\begin{cases}
  \partial_t \rho + \nabla \cdot \vec{m} = 0 \\
  \partial_t \vec{m} + \nabla \cdot \left[ \frac{\vec{m}\otimes\vec{m}}{\rho} + \Pi \, \mathbb{I} \right] = \vec{0} \\
  \partial_t E^t + \nabla \cdot \left[ \frac{\vec{m} (E^t + \Pi)}{\rho} \right] = 0
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
where \(\Pi\) represents the pressure field as a function of the conservative varaibles,
\begin{equation*}
\begin{split}\Pi\left(\rho, \vec{m}, E^t\right) = P\left( \rho, e\right) = P\left( \rho, \frac{E^t}{\rho}-\frac{|\vec{m}|^2}{\rho^3}  \right) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and \(P\) the pressure field expressed by the \sphinxstylestrong{equation of state of the fluid} as a function of density and internal energy per unit mass as the pair of independent variables determining the thermodynamic state.
\end{sphinxadmonition}
\label{ch/pde/hyperbolic:example-9}
\begin{sphinxadmonition}{note}{Example 20.5.6 (Shallow water equations in 2\sphinxhyphen{}dimensional domain)}


\begin{equation*}
\begin{split}\begin{cases}
  \partial_t (\rho \eta) + \nabla \cdot (\rho \eta \vec{u}) = 0 \\
  \partial_t (\rho \eta \vec{u}) + \nabla \cdot \left(\rho \eta \vec{u} \vec{u} + \frac{1}{2} \rho g \eta^2 \mathbb{I} \right) = 0 \\
\end{cases}\end{split}
\end{equation*}\end{sphinxadmonition}

\sphinxstepscope


\chapter{Navier\sphinxhyphen{}Cauchy equations}
\label{\detokenize{ch/pde/nc:navier-cauchy-equations}}\label{\detokenize{ch/pde/nc:pde-nc}}\label{\detokenize{ch/pde/nc::doc}}
\sphinxAtStartPar
Navier\sphinxhyphen{}Cauchy equations are the differential balance equation of the momentum of an elastic isotropic medium in the regime of small strain and displacement,
\begin{equation*}
\begin{split}\rho_0 \partial_{tt} \vec{s} = \rho_0 \vec{g} + \nabla \cdot \symbf{\sigma} \ . \end{split}
\end{equation*}
\sphinxAtStartPar
Stress tensor for an isotropic medium reads
\begin{equation*}
\begin{split}\begin{aligned}
  \symbf{\sigma}
   & = 2 \mu \symbf{\varepsilon} + \lambda \, \text{tr} \left( \symbf{\varepsilon} \right) \mathbb{I} = \\
   & = \left( 2 \mu \symbf{\varepsilon} - \frac{2}{3} \mu \, \text{tr}(\symbf{\varepsilon}) \mathbb{I} \right) + \left( \lambda + \frac{2}{3} \mu \right) \, \text{tr} \left( \symbf{\varepsilon} \right) \mathbb{I} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
with the small strain tensor
\begin{equation*}
\begin{split}\symbf{\varepsilon} = \frac{1}{2} \left( \nabla \vec{s} + \nabla^T \vec{s} \right) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Essential, natural and Robin boundary conditions read
\begin{equation*}
\begin{split}\begin{aligned}
  & \vec{s} = \overline{\vec{s}} && \vec{r} \in S_D && \text{esserntial - Dirichlet b.c.}  \\
  & \hat{n} \cdot \symbf{\sigma} = \overline{\vec{t}}_n && \vec{r} \in S_N && \text{natural - Neumann b.c.}  \\
  & a \vec{s} + \hat{n} \cdot \symbf{\sigma} = \vec{b} && \vec{r} \in S_R && \text{Robin b.c.} \\
\end{aligned}\end{split}
\end{equation*}

\section{Weak formulation}
\label{\detokenize{ch/pde/nc:weak-formulation}}
\sphinxAtStartPar
For \(\forall \vec{w} \in \dots\)
\begin{equation*}
\begin{split}\begin{aligned}
  0
  & = - \int_V \rho \vec{w} \cdot \partial_{tt} \vec{s} + \int_V \rho_0 \vec{w} \cdot \vec{g} + \int_{V} \vec{w} \cdot \nabla \cdot \symbf{\sigma} = \\ 
  & = - \int_V \rho \vec{w} \cdot \partial_{tt} \vec{s} + \int_V \rho_0 \vec{w} \cdot \vec{g} + \int_{\partial V} \hat{n} \cdot \symbf{\sigma} \cdot \vec{w} - \int_{V} \nabla \vec{w} : \symbf{\sigma} 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
The volume integral containing the stress tensor can be written either as
\begin{equation*}
\begin{split}\begin{aligned}
  \int_V \nabla \vec{w} : \symbf{\sigma} 
  & = \int_V w_{i/j} \left[ \mu \left( s_{i/j} + s_{j/i} \right) + \lambda s_{k/k} \delta_{ij} \right] = \\
  & = \int_V \mu w_{i/j} \left( s_{i/j} + s_{j/i} \right) + \int_V \lambda w_{j/j} s_{k/k} 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
or
\begin{equation*}
\begin{split}\begin{aligned}
  \int_V \frac{1}{2} \left( \nabla \vec{w} + \nabla^T \vec{w} \right) : \symbf{\sigma} 
  & = \int_V \frac{1}{2} \left( w_{i/j} + w_{j/i} \right) \left[ \mu \left( s_{i/j} + s_{j/i} \right) + \lambda s_{k/k} \delta_{ij} \right] = \\
  & = \int_V \frac{\mu}{2} \left( w_{i/j} + w_{j/i} \right) \left( s_{i/j} + s_{j/i} \right) + \int_{V} \lambda w_{j/j} s_{k/k} 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
The weak formulation of the Navier\sphinxhyphen{}Cauchy equations reads
\begin{equation*}
\begin{split}\int_V \rho_0 \vec{w} \cdot \partial_{tt} \vec{s} + \int_{V} 2 \mu \frac{\nabla \vec{w} + \nabla^T \vec{w}}{2} : \frac{\nabla \vec{s} + \nabla^T \vec{s}}{2} + \int_{V} \lambda \nabla \cdot \vec{w} \, \nabla \cdot \vec{s} + \int_{S_R} \vec{w} \cdot a \vec{s} = \int_{V} \rho_0 \vec{w} \cdot \vec{g} + \int_{S_N} \vec{w} \cdot \overline{\vec{t}}_n + \int_{S_R} \vec{w} \cdot \vec{b} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
for \(\forall \vec{w} \in \dots\), and with \(\vec{s} = \overline{\vec{s}}\) for \(\vec{r} \in S_D\).

\sphinxstepscope


\chapter{Navier\sphinxhyphen{}Stokes equations}
\label{\detokenize{ch/pde/ns:navier-stokes-equations}}\label{\detokenize{ch/pde/ns:pde-ns}}\label{\detokenize{ch/pde/ns::doc}}
\sphinxAtStartPar
Incompressible Navier\sphinxhyphen{}Stokes equations read
\begin{equation*}
\begin{split}\begin{cases}
  \rho \partial_t \vec{u} + \rho \left( \vec{u} \cdot \nabla \right) \vec{u} - \mu \nabla^2 \vec{u} + \nabla P = \rho \vec{g} \\
  \nabla \cdot \vec{u} = 0 \ . 
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Mass balance equation is replaced by the incompressiblity kinematic constraint, \(\nabla \cdot \vec{u} = 0\): this constraint is not dynamic, as time derivative of density does not appear in the equation. With the incompressibility constraint, mass equation tells us that material particles keep their density constant,
\begin{equation*}
\begin{split}0 = \underbrace{\partial_t \rho + \vec{u} \cdot \nabla \rho}_{=\frac{D \vec{\rho}}{D t}} + \rho \underbrace{\nabla \cdot \vec{u}}_{=0} = \frac{D \rho}{D t} \ , \end{split}
\end{equation*}
\sphinxAtStartPar
whose solution can be written using material coordinates \(\vec{r}_0\) as \(\rho(\vec{r}(\vec{r}_0,t), t) = \rho_0(\vec{r}_0, t)\).


\section{Incompressibility constraint}
\label{\detokenize{ch/pde/ns:incompressibility-constraint}}
\sphinxAtStartPar
Incompressibility constraint makes thermodynamic fade, while pressure field is replaced by/contains the contribution of a Lagrangian multiplier related to the incompressiblity constraint.


\subsection{Wave\sphinxhyphen{}vector transformed space}
\label{\detokenize{ch/pde/ns:wave-vector-transformed-space}}
\sphinxAtStartPar
Transforming the fields from physical space to the wave\sphinxhyphen{}vector space \(\widetilde{u}(\vec{\kappa}, t) = \mathscr{F}\left\{ \vec{u}(\vec{r},t) \right\}\), Navier\sphinxhyphen{}Stokes equations for incompressible fluids with uniform and constant density \(\rho(\vec{r},t) = \rho\) becomes
\begin{equation*}
\begin{split}\begin{cases}
  \rho \partial_t \widetilde{u} + \mathscr{F}\left\{ \left( \vec{u} \cdot \nabla \right) \vec{u} \right\} + \mu |\vec{\kappa}|^2 \widetilde{u} + i \vec{k} \widetilde{P} = \rho \widetilde{g} \\
  i \vec{\kappa} \cdot \widetilde{u} = 0 \ .
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Taking the divergence of the momentum balance equation, i.e. taking the scalar product with \(i \vec{\kappa}\) in the transformed space, and using the incompressibility constraint to set \(i \vec{\kappa} \cdot \widetilde{u} = 0\),
\begin{equation*}
\begin{split}i \vec{\kappa} \cdot \mathscr{F}\left\{ (\vec{u} \cdot \nabla ) \vec{u} \right\} - |\vec{\kappa}|^2 \widetilde{P} = i \vec{\kappa} \cdot \rho \widetilde{g} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
so that the transformed pressure field becomes
\begin{equation*}
\begin{split}\widetilde{P} = \frac{i \vec{\kappa}}{|\vec{\kappa}|^2} \cdot \mathscr{F} \left\{ \left( \vec{u} \cdot \nabla \right) \vec{u} - \rho \vec{g} \right\} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
Replacing this expression in the transformed Navier\sphinxhyphen{}Stokes equations, the meaning of the pressure field as a Lagrange multiplier associated with incompressibility constraint becomes clear,
\begin{equation*}
\begin{split}\rho \partial_t \widetilde{u} + \mu |\vec{\kappa}|^2 \widetilde{u} = \left[ 1 - \frac{\vec{\kappa} \vec{\kappa}}{|\vec{\kappa}|^2} \right] \cdot \mathscr{F}\left\{ - (\vec{u} \cdot \nabla) \vec{u} + \rho \widetilde{g} \right\}\end{split}
\end{equation*}
\sphinxAtStartPar
as the orthogonal projector \([ 1 - \frac{\vec{\kappa} \vec{\kappa}}{|\vec{\kappa}|^2}]\) onto the space of divergence\sphinxhyphen{}free functions acts on the non\sphinxhyphen{}linear and forcing terms.




\section{Weak formulation of the problem}
\label{\detokenize{ch/pde/ns:weak-formulation-of-the-problem}}

\begin{equation*}
\begin{split}\begin{aligned}
  0
  & = \int_{V} \vec{w} \cdot \left[ \rho \partial_t \vec{u} + \rho ( \vec{u} \cdot \nabla ) \vec{u} - 2 \mu \nabla \cdot \mathbb{D}(\vec{u}) + \nabla P - \rho \vec{g} \right] - \int_{V} v \nabla \cdot \vec{u} = \\
  & = \int_{V} \vec{w} \cdot \left[ \rho \partial_t \vec{u} + \rho ( \vec{u} \cdot \nabla ) \vec{u} \right] + \int_V 2 \mu \nabla \vec{w} : \mathbb{D} - \int_V \nabla \cdot \vec{w} P - \int_V \vec{w} \cdot \rho \vec{g} - \int_{V} v \nabla \cdot \vec{u} - \int_{\partial V} \hat{n} \cdot \left( \mathbb{S} - P \mathbb{I} \right) \cdot \vec{w} \ ,
\end{aligned}\end{split}
\end{equation*}

\subsection{Weak formulation and incompressibility constraint}
\label{\detokenize{ch/pde/ns:weak-formulation-and-incompressibility-constraint}}\begin{equation*}
\begin{split}\vec{r}(\vec{r}_0, t) = \vec{r}(q(t), t)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\vec{u} = \dfrac{D \vec{r}}{D t} = \dot{q} \dfrac{\partial \vec{r}}{\partial q} + \dfrac{\partial \vec{r}}{\partial t}\end{split}
\end{equation*}
\sphinxAtStartPar
In the weak formulation, using \(\vec{w} = \frac{\partial \vec{r}}{\partial q} = \frac{\partial \vec{u}}{\partial \dot{q}}\)
\begin{equation*}
\begin{split}\begin{aligned}
  0
  & = \int_{V} \vec{w} \cdot \rho \frac{D \vec{u}}{D t} + \int_V 2 \mu \nabla \vec{w} : \mathbb{D} - \int_V \nabla \cdot \vec{w} P - \int_V \rho \vec{w} \cdot \vec{g} - \int_{V} v \nabla \cdot \vec{u} - \int_{\partial V} \vec{t}_{\hat{n}} \cdot \vec{w} \ ,
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \int_V  \vec{w} \cdot \rho \dfrac{D \vec{u}}{Dt} \, dV 
  & = \int_{V_0} \rho_0 \frac{\partial \vec{u}}{\partial \dot{q}} \cdot \dfrac{D \vec{u}}{D t} = \\ 
  & = \int_{V_0} \rho_0 \dfrac{D}{D t} \left( \frac{\partial \vec{u}}{\partial \dot{q}} \cdot \vec{u} \right) \, dV_0
    - \int_{V_0} \rho_0 \dfrac{D}{Dt} \left( \dfrac{\partial \vec{r}}{\partial \dot{q}} \right) \cdot \vec{u} \, dV_0  = \\ 
  & = \int_{V_0} \rho_0 \dfrac{D}{D t} \left( \frac{\partial}{\partial \dot{q}} \frac{|\vec{u}|^2}{2} \right) \, dV_0
    - \int_{V_0} \rho_0 \dfrac{\partial }{\partial q} \frac{|\vec{u}|^2}{2} \, dV_0  = \\ 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
…


\section{Non\sphinxhyphen{}linear term}
\label{\detokenize{ch/pde/ns:non-linear-term}}
\sphinxAtStartPar
Different ways to treat the non\sphinxhyphen{}linear term:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Semi\sphinxhyphen{}linear approximation of the non\sphinxhyphen{}linear term
\begin{equation*}
\begin{split}( \vec{u}(\vec{r}, t^n) \cdot \nabla ) \vec{u}(\vec{r}, t^n) \sim ( \vec{u}^*(\vec{r}, t^n) \cdot \nabla ) \vec{u}(\vec{r}, t^n) \ , \end{split}
\end{equation*}
\sphinxAtStartPar
with \(\vec{u}^*(\vec{r}, t^n)\) an approximation of \(\vec{u}(\vec{r},t^n)\) involving values of the velocity field at previous time\sphinxhyphen{}steps, as an example
\begin{equation*}
\begin{split}\vec{u}^*(\vec{r}, t^n) = 
   \begin{cases}
      \vec{u}(\vec{r}, t^{n-1}) & \text{$1^{st}$-order} \\
      2 \vec{u}(\vec{r}, t^{n-1}) - \vec{u}(\vec{r}, t^{n-2}) & \text{$2^{nd}$-order} \\
   \end{cases}\end{split}
\end{equation*}
\end{itemize}

\sphinxstepscope


\chapter{Arbitrary Lagrangian\sphinxhyphen{}Eulerian description}
\label{\detokenize{ch/pde/ale:arbitrary-lagrangian-eulerian-description}}\label{\detokenize{ch/pde/ale:pde-ale-description}}\label{\detokenize{ch/pde/ale::doc}}
\sphinxAtStartPar
Reynold’s transport theorem allows for the formulation of intergal equations, and grid\sphinxhyphen{}based methods like FVM, on moving grids and changing domains. Rules for derivatives of composite functions provide the relations between time derivatives in a Lagrangian, Eulerian, or arbitrary description,
\begin{equation*}
\begin{split}\begin{aligned}
  & \left.\dfrac{\partial f}{\partial t}\right|_{\vec{r}_0} = \left.\dfrac{\partial f}{\partial t}\right|_{\vec{r}} + \vec{u}   \cdot \nabla f \\
  & \left.\dfrac{\partial f}{\partial t}\right|_{\vec{r}_b} = \left.\dfrac{\partial f}{\partial t}\right|_{\vec{r}} + \vec{u}_b \cdot \nabla f \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Equations governing the motion of the grid are usually required as well. E.g.:
\begin{itemize}
\item {} 
\sphinxAtStartPar
known and prescribed motion of the grid;

\item {} 
\sphinxAtStartPar
boundary conditions only without changing grids (for small displacements)

\item {} 
\sphinxAtStartPar
pseudo\sphinxhyphen{}elastic deformation (usually good for small strain and displacement;

\item {} 
\sphinxAtStartPar
for large displacements of/or models with complex geometry, sliding and/or overlapping grids could an option for grid\sphinxhyphen{}based methods.

\end{itemize}


\section{Integral problem}
\label{\detokenize{ch/pde/ale:integral-problem}}\label{\detokenize{ch/pde/ale:pde-ale-description-integral}}
\sphinxAtStartPar
Application of Reynolds theorem to the balance equation of the quantity \(\mathbf{u}\) for a material volume \(V_t\)
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{V_t} \rho \mathbf{u} = \int_{V_t} \rho \mathbf{f} + \oint_{\partial V_t} \hat{n} \cdot \mathbf{T} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
provides the expression of the balance equation for a geometrical volume \(v_t\) in arbitrary motion,
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_{v_t} \rho \mathbf{u} + \oint_{\partial v_t} \rho \mathbf{u} \left( \vec{u} - \vec{u}_b \right) \cdot \hat{n} = \int_{v_t} \rho \mathbf{f} + \oint_{\partial v_t} \hat{n} \cdot \mathbf{T} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Here, the integral forulation of the problem will be applied to each element of the grid in arbitrary motion, for domains with variable geometry.


\section{Differential problem}
\label{\detokenize{ch/pde/ale:differential-problem}}\label{\detokenize{ch/pde/ale:pde-ale-description-differential}}
\sphinxAtStartPar
Rules for derivatives of composite functions allows to write the differential w.r.t. the variables associated with the points of a moving grid. A balance equation in convective form can be written as
\begin{equation*}
\begin{split}\begin{aligned}
  \rho \dfrac{D \mathbf{u}}{D t} & = \rho \mathbf{f} + \nabla \cdot \mathbf{T} \\
  \rho \left[ \dfrac{\partial \mathbf{u}}{\partial t} + \vec{u} \cdot \nabla \mathbf{u} \right] & = \\
  \rho \left[ \left.\dfrac{\partial \mathbf{u}}{\partial t}\right|_{\vec{r}_b} + \left( \vec{u} - \vec{u}_b \right) \cdot \nabla \mathbf{u} \right] & = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxstepscope


\part{Numerical Methods for PDEs}

\sphinxstepscope


\chapter{Introduction to numerical methods for PDEs}
\label{\detokenize{ch/pde/numerics:introduction-to-numerical-methods-for-pdes}}\label{\detokenize{ch/pde/numerics:pde-numerics}}\label{\detokenize{ch/pde/numerics::doc}}
\sphinxAtStartPar
Different numerical methods for PDEs rely on the discretization of different formulations of the continunuos problems. As an example,
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{FDM, Finite difference methods} rely on the approximation of derivatives of the \sphinxstylestrong{strong formulation} of the problem

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{ch/pde/fem:pde-fem}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{FEM, Finite element methods}}}}} rely on a finite dimensional approximation of the \sphinxstylestrong{weak formulation} of the problem; usually the finite dimensional approximation can be interpreted as a projection of a infinite dimensional continuous problem onto a finite dimensional space, the space of the choosen finite elements

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{ch/pde/fvm:pde-fvm}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{FVM, Finite volume methods}}}}} rely on an approximation of the \sphinxstylestrong{integral formulation} of the problem

\item {} 
\sphinxAtStartPar
\DUrole{xref,myst}{\sphinxstylestrong{BEM, Boundary elemement methods}} rely on an approximation of a \sphinxstylestrong{boundary integral formulation} of  the problem, when it’s feasible and convenient

\item {} 
\sphinxAtStartPar
…\sphinxstyleemphasis{spectral methods}, \sphinxstyleemphasis{spectral element methods},…

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Characteristics.}
\begin{itemize}
\item {} 
\sphinxAtStartPar
grid: domain\sphinxhyphen{}grid\sphinxhyphen{}based, buondary\sphinxhyphen{}grid\sphinxhyphen{}based, grid\sphinxhyphen{}free methods

\item {} 
\sphinxAtStartPar
range of interaction: short in physical space for FDV, FEM, FVM; long\sphinxhyphen{}range for boundary element methods, even though clustering techniques are available, like FMM; (usually) over the whole domain in space, short\sphinxhyphen{}range interaction in wave\sphinxhyphen{}number space for spectral methods;

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Pros and cons.} \sphinxstyleemphasis{More suited methods for each problems…; domain, order,…}

\sphinxAtStartPar
Let’s take Poisson equations for a scalar function \(u(\vec{r})\) to show all the possible approaches above. Here we start from the most general version of the equation, namely the integral form. As it’s shown in \sphinxhref{https://basics2022.github.io/bbooks-physics-continuum-mechanics/ch/continuum/governing-equations.html}{Continuum Mechanics:Governing Equations}, the most general form of balance equations is the integral form, while the differential form can be seamlessly derived only when the quantities involved are regular enough, to apply Stokes’ theorem and for the derivatives appearing to exist.

\sphinxAtStartPar
The problem of interest can be interpreted as the problem of finding the temperature field \(u(\vec{r})\) during steady heat conduction in the domain \(\Omega\), with distributed volume heat source \(f(\vec{r})\). Fourier’s law assume that condcution heat flux is proportional to the gradient of the temperature, \(\vec{q} = - k \nabla u\). Temperature is prescribed, \(u = g\) on the region of the boundary \(S_D\), while the heat flux is prescribed  \(\hat{n} \cdot \vec{q} = h\) on the region of the boundary \(S_N\).

\sphinxAtStartPar
The \sphinxstylestrong{integral formulation} of the problem for all the boundary reads
\begin{equation}\label{equation:ch/pde/numerics:eq:example:pde:poisson:integral}
\begin{split}0 = - \oint_{\partial \Omega} \hat{n} \cdot \vec{q} + \int_{\Omega} f \ .\end{split}
\end{equation}\label{ch/pde/numerics:pde:ex:fvm}
\begin{sphinxadmonition}{note}{Example 24.1 (Finite volume methods)}



\sphinxAtStartPar
Finite volume methods rely on a tassellation of the domain \(\Omega = \cup_k \Omega_k\), to write and solve the integral balance equation \eqref{equation:ch/pde/numerics:eq:example:pde:poisson:integral} for all the elemantary domain \(\Omega_k\).
\begin{equation}\label{equation:ch/pde/numerics:eq:example:pde:poisson:integral:elementary}
\begin{split}0 = - \oint_{\partial \Omega_k} \hat{n} \cdot \vec{q} + \int_{\Omega_k} f \ .\end{split}
\end{equation}
\sphinxAtStartPar
evaluating volume integrals with the internal variables of the cell \(\Omega_k\), and boundary flux with the variables of the cell \(\Omega_k\) and the neighbouring cells \(\Omega_i \in B_k\). Introducing the definition of numerical flux \(F_{ik}(u_i, u_k)\) at the interface between a generic discrete version of the balance equation  \eqref{equation:ch/pde/numerics:eq:example:pde:poisson:integral:elementary} for the \(k^{th}\) element becomes
\begin{equation*}
\begin{split}0 = - \sum_{\Omega_i \in B_k} F_{ik}(u_i, u_k) + S_k(u_k) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Different numerical methods differs in the evaluation of fluxes and sources.
FVM is \sphinxstylestrong{conservative} as it evaluate flux at interfaces and then distribute it to neighoring cells, see {\hyperref[\detokenize{ch/pde/fvm:fvm:property:conservation}]{\sphinxcrossref{Property 24.2.1}}}. A rough elementwise\sphinxhyphen{}uniform variable with jump at interfaces and diffusive flux,
\begin{equation*}
\begin{split}F_{ik} = - A_{ik} \, k \, \frac{u_i - u_k}{d_{ik}} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(d_{ik}\) equal to the distance of the centers of elements \(i\) and \(k\), leads to the balance equation for the internal volume \(\Omega_k\),
\begin{equation*}
\begin{split} 0 = \sum_{i} A_{ik} \, k \, \frac{u_i-u_k}{d_{ik}} + V_k f_k \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Volumes at the boundary are influenced by fluxes at the boundaries and boundary conditions in general.

\sphinxAtStartPar
For regular cubic mesh, \(A_{ik} = \Delta x\), \(d_{ik} = \Delta x\), \(V_k = \Delta x\), and thus the equations for internal elements become
\begin{equation*}
\begin{split}0 = k \sum_{i \in \Omega_k} \frac{u_i - u_k}{\Delta x^2} + f_k \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
where the summation is exactly equal to the center\sphinxhyphen{}difference stencil for the Laplacian, used in finite difference method {\hyperref[\detokenize{ch/pde/numerics:pde:ex:fdm}]{\sphinxcrossref{Example 24.2}}}.
\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{If fields are regular enough} to apply Stokes’ theorem, it’s possible to derive differential problem from the integral formulation,
\begin{equation*}
\begin{split}\begin{aligned}
  0 
    = - \oint_{\partial V} \hat{n} \cdot \vec{q} + \int_{V} f 
    = - \int_{V} \nabla \cdot \vec{q} + \int_{V} f = \int_{V} \left( - \nabla \cdot \vec{q} + f  \right)
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Exploiting the arbitrariety of the volume \(V\), the \sphinxstylestrong{strong form} of the differential problem is the Poisson equation with suitable boundary conditions,
\begin{equation*}
\begin{split}\begin{cases}
  - \nabla \cdot \left( k \nabla u \right) = f(\vec{r}) \ , & \vec{r} \in V \\
  u = g(\vec{r})                                        \ , & \vec{r} \in S_{D} \\
  \hat{n} \cdot \nabla u = h(\vec{r})                   \ , & \vec{r} \in S_{N}  \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
only holds in regions of the domain where the functions involved are continuous and differentiable, i.e. everything written in the problem is not meaningful, i.e. at least it exists.
\label{ch/pde/numerics:pde:ex:fdm}
\begin{sphinxadmonition}{note}{Example 24.2 (Finite difference methods)}



\sphinxAtStartPar
Finite different method approximates the strong form of the problem, building a stencil to evaluate an approximation of the Laplacian. On a cubic regular grid (\(\Delta x = \Delta y = \Delta z\)), the Laplacian van be evaluated with a 7\sphinxhyphen{}point stencil
\begin{equation*}
\begin{split}\begin{aligned}
  \nabla^2 u
  & = \partial_{xx} u + \partial_{yy} u + \partial_{zz} u = \\
  & = \dfrac{u_{i+1,j,k} - 2 u_{i,j,k} + u_{i-1,j,k}}{\Delta x^2} + \dfrac{u_{i,j+1,k} - 2 u_{i,j,k} + u_{i,j-1,k}}{\Delta y^2} + \dfrac{u_{i,j,k+1} - 2 u_{i,j,k} + u_{i,j,k-1}}{\Delta z^2} =  \\
  & = \dfrac{1}{\Delta x^2} \left[ - 6 u_{i,j,k} + u_{i+1,j,k} + u_{i-1,j,k} + u_{i,j+1,k} + u_{i,j-1,k} + u_{i,j,k+1} + u_{i,j,k-1} \right] = \\
  & = \dfrac{1}{\Delta x^2} \sum_{i \in B_k} (u_i - u_k)
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and it’s equal to the same expression already provided for the rough finite volume method with regular grid, in {\hyperref[\detokenize{ch/pde/numerics:pde:ex:fvm}]{\sphinxcrossref{Example 24.1}}}
\end{sphinxadmonition}

\sphinxAtStartPar
Starting from strong formulation of the differential problem, the \sphinxstylestrong{weak formulation} of the problem is derived:
\begin{itemize}
\item {} 
\sphinxAtStartPar
multiplying the strong problem by an arbitrary test function \(w(\vec{r})\) compatible with the essential constraints

\item {} 
\sphinxAtStartPar
integrating over the whole domain

\end{itemize}
\begin{equation*}
\begin{split}\begin{aligned}
  0
  & = \int_{V} w(\vec{r}) \cdot \left[ - \nabla \cdot \left( k \nabla u \right) - f(\vec{r}) \right] = \\
  & = \int_{V} \left\{  k \nabla w(\vec{r}) \cdot  \nabla u(\vec{r}) - w(\vec{r}) f(\vec{r}) \right\} - \oint_{\partial V} w(\vec{r}) \, \hat{n} \cdot \nabla u \qquad \forall w(\vec{r}) \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Using a test function \(w(\vec{r})\) equal to zero on the boundary where essential boundary conditions are prescribed \(\left.w\right|_{S_D} = 0\), and introducing the natural boundary conditions of the Neumann boundary \(S_N\), \(\left. \hat{n} \cdot \nabla u\right|_{S_N} = h\),
\begin{equation*}
\begin{split}\int_{V} k \nabla w \cdot \nabla u = \int_V w f + \int_{S_N} w h \ , \quad \forall w\end{split}
\end{equation*}
\sphinxAtStartPar
compatible with essential boundary conditions.
\label{ch/pde/numerics:pde:ex:fem}
\begin{sphinxadmonition}{note}{Example 24.3 (Finite element methods)}



\sphinxAtStartPar
Finite element methods build an \(N\)\sphinxhyphen{}dimensional systems:
\begin{itemize}
\item {} 
\sphinxAtStartPar
approximating the solution as a linear combination of \(N\) base functions, \(u(\vec{r}) = \sum_j \phi_j(\vec{r}) u_j\)

\item {} 
\sphinxAtStartPar
testing the equation over \(N\) independent test functions \(\psi_i(\vec{r})\)

\end{itemize}

\sphinxAtStartPar
i.e. the \(i^{th}\) equation becomes
\begin{equation*}
\begin{split}\int_{V} k \nabla \psi_i(\vec{r}) \cdot \nabla \phi_j(\vec{r}) \, u_j = \int_{V} \psi_i(\vec{r}) f + \int_{S_N} \psi_i(\vec{r}) h \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
or briefly
\begin{equation*}
\begin{split}K_{ij} u_j = f_i \qquad , \qquad \mathbf{K} \mathbf{u} = \mathbf{f} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
A common choice uses the same functions both as test and base functions, \(\psi_i(\vec{r}) = \phi_i(\vec{r})\).
\end{sphinxadmonition}

\sphinxAtStartPar
The differential problem in strong form can be recast as a boundary element problem exploiting the properties of Green’s functions \(G(\vec{r}; \vec{r}_0)\). The expression of {\hyperref[\detokenize{ch/pde/bem-poisson-helmholtz-waves:math-green-function}]{\sphinxcrossref{\DUrole{std,std-ref}{Green’s function \(G(\vec{r}, \vec{r}_0)\)}}}} is known for some problems of interest like Poisson equation, Helmholtz equation or wave equation. Exploiting the properties of Green’s function and integration by parts, the integral buondary problem is derived as follow
\begin{equation*}
\begin{split}\begin{aligned}
  E(\vec{r}_0) u(\vec{r}_0) 
  & = \int_{\vec{r} \in V} u(\vec{r}) \delta(\vec{r}- \vec{r}_0) \, dV = \\
  & = - \int_{\vec{r} \in V} u(\vec{r}) \nabla^2 G(\vec{r};\vec{r}_0) \, dV = \\
  & = - \oint_{\vec{r} \in \partial V} u(\vec{r}) \hat{n}(\vec{r}) \cdot \nabla G(\vec{r};\vec{r}_0) \, dS 
      + \oint_{\vec{r} \in \partial V} G(\vec{r};\vec{r}_0) \hat{n}(\vec{r}) \cdot \nabla u(\vec{r}) \, dS
      - \int_{\vec{r} \in V} G(\vec{r}; \vec{r}_0) \nabla^2 u (\vec{r}) \, dV  = \\
  & = - \oint_{\vec{r} \in \partial V} u(\vec{r}) \hat{n}(\vec{r}) \cdot \nabla G(\vec{r};\vec{r}_0) \, dS 
      + \oint_{\vec{r} \in \partial V} G(\vec{r};\vec{r}_0) \hat{n}(\vec{r}) \cdot \nabla u(\vec{r}) \, dS
      + \int_{\vec{r} \in V} G(\vec{r}; \vec{r}_0) f(\vec{r}) \, dV \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
It must be paid attention that the integrals may be singular and may produce discontintuities in the fields across the surface \(\partial V\) (\sphinxstyleemphasis{so what’s the value of a field in presence of a discontinuity?…virtual singularities, regularization close to the singularities…one way to correctly interpret them is via Cauchy principal value… evaluating some integrals in a check\sphinxhyphen{}point just inside or outside the domain may make the value of the function \(E(\vec{r}_0)\) change, but the integral involving \(\hat{n} \cdot \nabla G\) \sphinxhyphen{} related to the solid angle seen by the check\sphinxhyphen{}point of the surface \sphinxhyphen{} changes accordingly and keep the sum of these two terms constant=}.

\sphinxAtStartPar
The value of the unknown function or the flux \(\hat{n} \cdot \nabla u\) are known on the Dirichlet and Neumann regions of the boundary respectively, and so the integro\sphinxhyphen{}differential problem becomes
\begin{equation*}
\begin{split}E(\vec{r}_0) u(\vec{r}_0) + \int_{S_N} u \hat{n} \cdot \nabla G \, dS - \int_{S_D} G \, \hat{n} \cdot \nabla u \, dS = \int_{S_D} g \hat{n} \cdot \nabla G \, dS - \int_{S_N} G h \, dS + \int_{\vec{r} \in V} G f \, dV\end{split}
\end{equation*}
\sphinxAtStartPar
The unknown function is approximated on the boundary of the domain \(\partial V\) as an \(N\)\sphinxhyphen{}dimensional approximation, as an example
\begin{equation*}
\begin{split}u(\vec{r}) = \sum_{j} \phi_j(\vec{r}) u_j \qquad , \qquad \vec{r} \in \partial V \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and the integro\sphinxhyphen{}differential equation is evaluated in \(N\) different points \(\vec{r}_{0,i}\) in order to get a \(N,N\) linear equation in the amplitudes \(u_j\) of the base functions,
\begin{equation*}
\begin{split}\left[\mathbf{E} + \mathbf{D}_N + \mathbf{S}_D \right] \mathbf{u} = \mathbf{D}_D \mathbf{g} + \mathbf{S}_N \mathbf{h} + \mathbf{S}_V \mathbf{f} \ .\end{split}
\end{equation*}
\sphinxstepscope


\section{Finite Element Method}
\label{\detokenize{ch/pde/fem:finite-element-method}}\label{\detokenize{ch/pde/fem:pde-fem}}\label{\detokenize{ch/pde/fem::doc}}
\sphinxstepscope


\section{Finite Volume Method}
\label{\detokenize{ch/pde/fvm:finite-volume-method}}\label{\detokenize{ch/pde/fvm:pde-fvm}}\label{\detokenize{ch/pde/fvm::doc}}\label{ch/pde/fvm:fvm:property:conservation}
\begin{sphinxadmonition}{note}{Property 24.2.1}



\sphinxAtStartPar
Evaluate flux on interfaces between cells, and distribute between neighboring cells.
\end{sphinxadmonition}

\sphinxstepscope


\section{Boundary Element Method}
\label{\detokenize{ch/pde/bem:boundary-element-method}}\label{\detokenize{ch/pde/bem:pdf-bem}}\label{\detokenize{ch/pde/bem::doc}}
\sphinxstepscope


\part{Boundary Methods for PDEs}

\sphinxstepscope




\chapter{Green’s function method}
\label{\detokenize{ch/pde/bem-poisson-helmholtz-waves:green-s-function-method}}\label{\detokenize{ch/pde/bem-poisson-helmholtz-waves:math-green-function}}\label{\detokenize{ch/pde/bem-poisson-helmholtz-waves::doc}}

\section{Poisson equation}
\label{\detokenize{ch/pde/bem-poisson-helmholtz-waves:poisson-equation}}\label{\detokenize{ch/pde/bem-poisson-helmholtz-waves:classical-electromagnetism-green-function-poisson}}
\sphinxAtStartPar
General Poisson’s problem
\begin{equation*}
\begin{split}\begin{cases}
  - \nabla^2 \mathbf{u}(\mathbf{r}, t) = \mathbf{f}(\mathbf{r},t) \\
  \text{+ b.c.}
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
with common boundary conditions
\begin{equation*}
\begin{split}\begin{cases}
\mathbf{u} = \mathbf{g} & \quad \text{on $S_D$} \\
\hat{\mathbf{n}} \cdot \nabla \mathbf{u} = \mathbf{h} & \quad \text{on $S_N$}
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
over Dirichlet and Neumann regions of the boundary.

\sphinxAtStartPar
Poisson’s problem for Green’s function, in infinite domain
\begin{equation*}
\begin{split}
  - \nabla_{\mathbf{r}}^2 G(\mathbf{r}; \mathbf{r}_0) = \delta(\mathbf{r} - \mathbf{r}_0) \\
\end{split}
\end{equation*}
\sphinxAtStartPar
Green’s function method
\begin{equation*}
\begin{split}\begin{aligned}
  E(\mathbf{r}_0, t) u_i(\mathbf{r}_0, t) 
  & =   \int_{\mathbf{r} \in \Omega} u_i(\mathbf{r},t) \delta(\mathbf{r}-\mathbf{r}_0) = \\
  & = - \int_{\mathbf{r} \in \Omega} u_i(\mathbf{r},t) \nabla_{\mathbf{r}}^2 G(\mathbf{r}-\mathbf{r}_0) = \\
  & = - \int_{\mathbf{r} \in \Omega} \nabla_{\mathbf{r}} \cdot ( u_i \nabla_{\mathbf{r}} G - G \nabla_{\mathbf{r}} u_i) - \int_{\mathbf{r} \in \Omega} G \nabla^2 u_i= \\
  & = - \oint_{\mathbf{r} \in \partial \Omega} \hat{\mathbf{n}} \cdot ( u_i \nabla_{\mathbf{r}} G - G \nabla_{\mathbf{r}} u_i) + \int_{\mathbf{r} \in \Omega} G(\mathbf{r}-\mathbf{r}_0) f_i(\mathbf{r}, t) . \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
An integro\sphinxhyphen{}differential boundary problem can be written using boundary conditions. As an example, using Dirichlet and Neumann boundary conditions, the integro\sphinxhyphen{}differential problem reads
\begin{equation*}
\begin{split}\begin{aligned}
&  E(\mathbf{r}_0, t) \mathbf{u}(\mathbf{r}_0, t) 
+ \int_{\mathbf{r} \in S_N} \mathbf{u}(\mathbf{r},t) \, \hat{\mathbf{n}} \cdot \nabla_{\mathbf{r}} G(\mathbf{r}-\mathbf{r}_0)
- \int_{\mathbf{r} \in S_D} G(\mathbf{r}-\mathbf{r}_0) \, \hat{\mathbf{n}} \cdot \nabla_{\mathbf{r}} \mathbf{u}(\mathbf{r},t) = \\ 
& =
- \int_{\mathbf{r} \in S_D} \mathbf{g}(\mathbf{r},t) \, \hat{\mathbf{n}} \cdot \nabla_{\mathbf{r}} G(\mathbf{r}-\mathbf{r}_0)
+ \int_{\mathbf{r} \in S_N} G(\mathbf{r}-\mathbf{r}_0) \, \mathbf{h}(\mathbf{r},t)  
+ \int_{\mathbf{r} \in \Omega} G(\mathbf{r}-\mathbf{r}_0) \, \mathbf{f}(\mathbf{r}, t) . \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Green’s function of the Poisson\sphinxhyphen{}Laplace equation reads
\begin{equation*}
\begin{split}G(\mathbf{r};\mathbf{r}_0) = \frac{1}{4 \pi} \frac{1}{\left| \mathbf{r}-\mathbf{r}_0 \right|} \ .\end{split}
\end{equation*}\subsubsection*{Green’s function of the Laplace equation}
\begin{equation*}
\begin{split}-\nabla^2 G = 0 \qquad \text{for $\mathbf{r} \ne \mathbf{r}_0$}\end{split}
\end{equation*}
\sphinxAtStartPar
Solutions with spherical symmetry,
\begin{equation*}
\begin{split}0 = \nabla^2 G = \frac{1}{r^2} \left( r^2 G' \right)'
\quad \rightarrow \quad
G'(r) = \frac{A}{r^2} \quad \rightarrow \quad G(r) = - \frac{A}{r} + B
\end{split}
\end{equation*}
\sphinxAtStartPar
Choosing \(B = 0\) s.t. \(G(r) \rightarrow 0\) as \(r \rightarrow \infty\), and integrating over a sphere centered in \(r=0\) to get \(A = -\frac{1}{4 \pi}\),
\begin{equation*}
\begin{split}1 = \int_{V} \delta(r) = - \int_{V} \nabla^2 G = - \oint_{\partial V} \hat{\mathbf{n}} \cdot \nabla G
= -\oint_{\partial V} \hat{\mathbf{r}} \cdot \hat{\mathbf{r}} \frac{A}{r^2} = - 4 \pi \, A \end{split}
\end{equation*}

\section{Helmholtz equation}
\label{\detokenize{ch/pde/bem-poisson-helmholtz-waves:helmholtz-equation}}\label{\detokenize{ch/pde/bem-poisson-helmholtz-waves:classical-electromagnetism-green-function-helmholtz}}
\sphinxAtStartPar
\sphinxstylestrong{todo} from Fourier to Laplace trasnform in the first lines of this section

\sphinxAtStartPar
A Helmholtz’s equation can be thouoght as the time Fourier transform of a wave equation,
\begin{equation*}
\begin{split}\begin{cases}
  \dfrac{1}{c^2} \partial_{tt} \mathbf{u}(\mathbf{r},t) - \nabla^2 \mathbf{u}(\mathbf{r},t) = \mathbf{f}(\mathbf{r},t) \\
  \text{+ b.c.} \\
  \text{+ i.c.} \ ,
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Fourier transform in time of field \(\mathbf{u}(\mathbf{r},t)\) reads
\begin{equation*}
\begin{split}\tilde{\mathbf{u}}(\mathbf{r}, \omega) = \mathscr{F}\{ \mathbf{u}(\mathbf{r},t) \} = \int_{t=-\infty}^{+\infty} \mathbf{u}(\mathbf{r},t) e^{-i \omega t} \, d \omega\end{split}
\end{equation*}
\sphinxAtStartPar
and, if \(\mathbf{u}(\mathbf{r},t)\) is compact in time, Fourier transform of its time partial derivatives read
\begin{equation*}
\begin{split}\begin{aligned}
  \mathscr{F}\{ \dot{\mathbf{u}}(\mathbf{r},t) \} 
  & = \int_{t=-\infty}^{+\infty} \dot{\mathbf{u}}(\mathbf{r},t) e^{-i \omega t} \, d \omega = \\
  & = \mathbf{u}(\mathbf{r},t) e^{-i \omega t} \big|_{t=-\infty}^{+\infty} + i \omega \int_{t=-\infty}^{+\infty} \mathbf{u}(\mathbf{r},t) e^{-i \omega t} \, d \omega = \\
  & = i \omega \mathscr{F}\{  \mathbf{u}(\mathbf{r},t) \}
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathscr{F}\{ \partial_t^n \mathbf{u}(\mathbf{r},t) \} = (i \omega)^n \tilde{\mathbf{u}} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
The differential problem in the transformed domain thus reads
\begin{equation*}
\begin{split}- \frac{\omega^2}{c^2} \tilde{\mathbf{u}} - \nabla^2 \tilde{\mathbf{u}} = \tilde{\mathbf{f}}\end{split}
\end{equation*}
\sphinxAtStartPar
Green’s function of Helmholtz’e equation reads
\begin{equation*}
\begin{split}G(\mathbf{r}, s) =
  \alpha^+ \frac{e^{ \frac{s|\mathbf{r} - \mathbf{r}_0|}{c}}}{|\mathbf{r} - \mathbf{r}_0|} +
  \alpha^- \frac{e^{-\frac{s|\mathbf{r} - \mathbf{r}_0|}{c}}}{|\mathbf{r} - \mathbf{r}_0|}
\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\alpha^+ + \alpha^- = \frac{1}{4 \pi}\).

\sphinxAtStartPar
Being the Laplace transform,
\begin{equation*}
\begin{split}\mathscr{L}\{ f(t) \} = \int_{t=0^-}^{+\infty} f(t) e^{-st} dt \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
the Laplace transform of a causal function with time delay \(\tau \ge 0\) reads
\begin{equation*}
\begin{split}\mathscr{L}\{ f(t-\tau) \} = \int_{t=0^-}^{+\infty} f(t-\tau) e^{-st} dt = \int_{z = - \tau}^{+\infty} f(z) e^{-s(z+\tau)} \, dz = e^{-s\tau} \, \int_{z = 0}^{+\infty} f(z) e^{-s z} \, dz = e^{-s \tau} \, \mathscr{L}\{ f(t) \}\end{split}
\end{equation*}
\sphinxAtStartPar
having used causality \(f(t) = 0\) for \(t < 0\). Laplace transform of Dirac’s delta \(\delta(t)\) reads
\begin{equation*}
\begin{split}\mathscr{L}\{ \delta(t) \} = \int_{t=0^-}^{+\infty} \delta(t) \, dt = 1 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
so that \(e^{-s \tau} = e^{- s \tau} \, 1 = \mathscr{L}\{ \delta(t-\tau) \}\).

\sphinxAtStartPar
Thus, Green’s function for the wave equation reads
\begin{equation*}
\begin{split}G(\mathbf{r},t; \mathbf{r}_0, t_0) = 
  \alpha^+ \frac{ \delta \left( t - t_0 + \frac{|\mathbf{r}-\mathbf{r}_0|}{c} \right)}{|\mathbf{r} - \mathbf{r}_0|} +
  \alpha^- \frac{ \delta \left( t - t_0 - \frac{|\mathbf{r}-\mathbf{r}_0|}{c} \right)}{|\mathbf{r} - \mathbf{r}_0|}
\end{split}
\end{equation*}
\sphinxAtStartPar
If \(t \ge t_0\), and \(G(\mathbf{r}, t; \mathbf{r}_0, t_0)\) connects the past \(t_0\) with the future \(t\), the first term is not causal, and thus \(\alpha^+ = 0\) and
\begin{equation*}
\begin{split}G(\mathbf{r},t; \mathbf{r}_0, t_0) = \frac{1}{4 \pi} \frac{ \delta \left( t - t_0 - \frac{|\mathbf{r}-\mathbf{r}_0|}{c} \right)}{|\mathbf{r} - \mathbf{r}_0|} \ .\end{split}
\end{equation*}\subsubsection*{Green’s function of Helmholtz’s equation}
\begin{equation*}
\begin{split}\frac{s^2}{c^2} G - \nabla^2 G = \delta(r)\end{split}
\end{equation*}\begin{equation*}
\begin{split}G(r) = \frac{\alpha e^{k r} + \beta e^{-kr}}{r}\end{split}
\end{equation*}
\sphinxAtStartPar
Proof:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Gradient
\begin{equation*}
\begin{split}\nabla G(r) = \hat{\mathbf{r}} \partial_r G = \hat{\mathbf{r}} \frac{\alpha (k r - 1) e^{kr} + \beta(-k r - 1)e^{-kr}}{r^2}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
Laplacian
\begin{equation*}
\begin{split}\begin{aligned}
    \nabla^2 G(r) & = \frac{1}{r^2} \left( r^2 G'(r) \right)' = \\
    & = \frac{1}{r^2} \left(  \alpha (k r - 1) e^{kr} + \beta(-k r - 1)e^{-kr}\right)' = \\
    & = \frac{1}{r^2} \left( \alpha k e^{kr} + \alpha k^2 r  e^{kr} - \alpha k e^{kr} - \beta k e^{-kr} + \beta k^2 r e^{-kr} + \beta k e^{-kr}  \right) = \\
    & = \frac{1}{r} \left( \alpha e^{kr} + \beta e^{-kr} \right) k^2 = k^2 G(r) \ .
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and thus \(k^2 G(r) - \nabla^2 G = 0\), for \(r \ne 0\);

\item {} 
\sphinxAtStartPar
Unity
\begin{equation*}
\begin{split}1 = \int_{V} \delta(r) = \int_V \left( k^2 G - \nabla^2 G \right) = \int_V k^2 G - \oint_{\partial V} \hat{\mathbf{n}} \cdot \nabla G \end{split}
\end{equation*}
\sphinxAtStartPar
the second term is the sum of two contributions of the form
\begin{equation*}
\begin{split}\oint_{\partial V} \hat{\mathbf{n}} \cdot \nabla G^{\pm} = \oint_{\partial V} \frac{\alpha^{\pm}(\pm k r - 1) e^{\pm k r}}{r^2} = 4 \pi \alpha^{\pm} (\pm k r - 1) e^{\pm k r}\end{split}
\end{equation*}
\sphinxAtStartPar
the first term is the sum of two contributions of the form
\begin{equation*}
\begin{split}\begin{aligned}
    k^2 \int_{V} G(r)
      & = k^2 \int_{V} \frac{\alpha^{\pm} e^{\pm k r}}{r} = \\
      & = k^2 \alpha^{\pm} \int_{R = 0}^{r} \int_{\phi=0}^{\pi} \int_{\theta=0}^{2 \pi} \frac{e^{\pm k R}}{R} R^2 \sin \phi \, dR \, d \phi \, d \theta = \\
      & = k^2 \alpha^{\pm} \, 4 \pi \int_{R = 0}^{r} R \, e^{\pm k R} \, dR \ .
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
the last integral can be evaluated with integration by parts
\begin{equation*}
\begin{split}\begin{aligned}
    \int_{R = 0}^{r} R \, e^{\pm k R} \, dR
    & = \left.\left[ \frac{1}{\pm k} e^{\pm k R } R \right]\right|_{R=0}^{r} \mp \frac{1}{k} \int_{R=0}^{r} e^{\pm k R} \, dR = \\
    & = \frac{1}{\pm k} e^{\pm k r } r  - \frac{1}{k^2} e^{\pm k R} + \frac{1}{k^2} = \\
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Thus summing everything together,
\begin{equation*}
\begin{split}\begin{aligned}
    1 & = \alpha^+ \left[ 4 \pi k^2 \left( \frac{r}{k} e^{k r} - \frac{1}{k^2} e^{kr} + \frac{1}{k^2} \right) - 4 \pi \left( k r - 1 \right) e^{kr} \right] + \alpha^- \left[ \dots \right] = \\
      & = 4 \pi \left( \alpha^+ + \alpha^- \right) \ .
  \end{aligned}\end{split}
\end{equation*}
\end{itemize}


\section{Wave equation}
\label{\detokenize{ch/pde/bem-poisson-helmholtz-waves:wave-equation}}\label{\detokenize{ch/pde/bem-poisson-helmholtz-waves:classical-electromagnetism-green-function-waves}}
\sphinxAtStartPar
Wave equation general problem
\begin{equation*}
\begin{split}\begin{cases}
  \dfrac{1}{c^2} \partial_{tt} \mathbf{u}(\mathbf{r},t) - \nabla^2 \mathbf{u}(\mathbf{r},t) = \mathbf{f}(\mathbf{r},t) \\
  \text{+ b.c.} \\
  \text{+ i.c.} \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Green’s problem of the wave equation
\begin{equation*}
\begin{split}\frac{1}{c^2} \partial_{tt} G(\mathbf{r},t;\mathbf{r}_0,t_0) - \nabla_{\mathbf{r}}^2 G(\mathbf{r},t;\mathbf{r}_0,t_0) = \delta(\mathbf{r}-\mathbf{r}_0) \delta(t-t_0)\end{split}
\end{equation*}
\sphinxAtStartPar
Integration by parts
\begin{equation*}
\begin{split}\begin{aligned}
  E(\mathbf{r}_{\alpha}, t_{\alpha}) \mathbf{u}(\mathbf{r}_{\alpha},t_{\alpha}) & = \int_{t \in T} \int_{\mathbf{r} \in V} \delta(t-t_{\alpha}) \delta(\mathbf{r}-\mathbf{r}_{\alpha}) \mathbf{u}(\mathbf{r},t) = \\
  & = \int_{t \in T} \int_{\mathbf{r} \in V} \left\{ \frac{1}{c^2} \partial_{tt} G - \nabla^2_{\mathbf{r}} G \right\} \mathbf{u} = \\
  & = \int_{t \in T} \int_{\mathbf{r} \in V} \left\{ \frac{1}{c^2} \left[ \partial_t \left( \mathbf{u} \partial_t G - G \partial_t \mathbf{u} \right) + G \partial_{tt} \mathbf{u} \right] - \nabla_{\mathbf{r}} \cdot \left( \nabla_{\mathbf{r}} G \, \mathbf{u} - G \nabla_{\mathbf{r}} \mathbf{u} \right) - G \, \nabla^2_{\mathbf{r}} \mathbf{u} \right\} = \\
  & = \int_{\mathbf{r} \in V} \frac{1}{c^2} \left[ \mathbf{u}(\mathbf{r},t) \partial_t G(\mathbf{r},t; \mathbf{r}_{\alpha},t_{\alpha}) - G(\mathbf{r},t; \mathbf{r}_{\alpha},t_{\alpha}) \partial_t \mathbf{u}(\mathbf{r},t) \right] \bigg|_{t_0}^{t_1} + \\
  & \quad + \int_{t \in T} \oint_{\mathbf{r} \in \partial V} \left\{ - \hat{\mathbf{n}}(\mathbf{r},t) \cdot \nabla_{\mathbf{r}} G(\mathbf{r},t; \mathbf{r}_{\alpha},t_{\alpha}) \, \mathbf{u}(\mathbf{r},t) + G(\mathbf{r},t; \mathbf{r}_{\alpha},t_{\alpha}) \, \hat{\mathbf{n}}(\mathbf{r},t) \cdot \nabla_{\mathbf{r}} \mathbf{u}(\mathbf{r},t) \right\} + \\
  & \quad + \int_{t \in T}  \int_{\mathbf{r} \in V} G(\mathbf{r},t; \mathbf{r}_{\alpha},t_{\alpha}) \underbrace{ \left\{ \frac{1}{c^2} \partial_{tt} \mathbf{u}(\mathbf{r},t) - \nabla^2_{\mathbf{r}} \mathbf{u}(\mathbf{r},t) \right\}}_{= \mathbf{f}(\mathbf{r},t)} \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \int_{t \in T} \int_{\mathbf{r} \in V} \frac{1}{4 \pi}\frac{\delta\left( t-t_{\alpha} + \frac{|\mathbf{r} - \mathbf{r}_{\alpha}|}{c} \right)}{|\mathbf{r} - \mathbf{r}_{\alpha}|} \, \mathbf{f}(\mathbf{r},t) 
  & = \int_{\mathbf{r} \in V \cap B_{|\mathbf{r} - \mathbf{r}_{\alpha}| \le c (t_\alpha - t)}} \frac{1}{4 \pi |\mathbf{r} - \mathbf{r}_{\alpha}|} \mathbf{f}\left(\mathbf{r}, t_{\alpha} - \frac{|\mathbf{r}-\mathbf{r}_{\alpha}|}{c}\right)
\end{aligned}\end{split}
\end{equation*}





\renewcommand{\indexname}{Proof Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{definition\sphinxhyphen{}0}
\item\relax\sphinxstyleindexentry{definition\sphinxhyphen{}0}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean:\detokenize{definition-0}}
\indexspace
\bigletter{definition\sphinxhyphen{}1}
\item\relax\sphinxstyleindexentry{definition\sphinxhyphen{}1}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean:\detokenize{definition-1}}
\indexspace
\bigletter{definition\sphinxhyphen{}2}
\item\relax\sphinxstyleindexentry{definition\sphinxhyphen{}2}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean:\detokenize{definition-2}}
\indexspace
\bigletter{definition\sphinxhyphen{}3}
\item\relax\sphinxstyleindexentry{definition\sphinxhyphen{}3}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean:\detokenize{definition-3}}
\indexspace
\bigletter{definition\sphinxhyphen{}4}
\item\relax\sphinxstyleindexentry{definition\sphinxhyphen{}4}\sphinxstyleindexextra{ch/complex/analysis}\sphinxstyleindexpageref{ch/complex/analysis:\detokenize{definition-4}}
\indexspace
\bigletter{definition\sphinxhyphen{}5}
\item\relax\sphinxstyleindexentry{definition\sphinxhyphen{}5}\sphinxstyleindexextra{ch/complex/analysis}\sphinxstyleindexpageref{ch/complex/analysis:\detokenize{definition-5}}
\indexspace
\bigletter{example\sphinxhyphen{}0}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}0}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean\sphinxhyphen{}spherical}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean-spherical:\detokenize{example-0}}
\indexspace
\bigletter{example\sphinxhyphen{}1}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}1}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean\sphinxhyphen{}spherical}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean-spherical:\detokenize{example-1}}
\indexspace
\bigletter{example\sphinxhyphen{}10}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}10}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean:\detokenize{example-10}}
\indexspace
\bigletter{example\sphinxhyphen{}2}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}2}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean\sphinxhyphen{}spherical}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean-spherical:\detokenize{example-2}}
\indexspace
\bigletter{example\sphinxhyphen{}3}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}3}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean\sphinxhyphen{}spherical}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean-spherical:\detokenize{example-3}}
\indexspace
\bigletter{example\sphinxhyphen{}4}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}4}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean\sphinxhyphen{}spherical}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean-spherical:\detokenize{example-4}}
\indexspace
\bigletter{example\sphinxhyphen{}5}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}5}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean\sphinxhyphen{}spherical}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean-spherical:\detokenize{example-5}}
\indexspace
\bigletter{example\sphinxhyphen{}6}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}6}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean\sphinxhyphen{}spherical}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean-spherical:\detokenize{example-6}}
\indexspace
\bigletter{example\sphinxhyphen{}7}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}7}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean:\detokenize{example-7}}
\indexspace
\bigletter{example\sphinxhyphen{}8}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}8}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean:\detokenize{example-8}}
\indexspace
\bigletter{example\sphinxhyphen{}9}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}9}\sphinxstyleindexextra{ch/tensor\sphinxhyphen{}algebra\sphinxhyphen{}calculus/calculus\sphinxhyphen{}euclidean}\sphinxstyleindexpageref{ch/tensor-algebra-calculus/calculus-euclidean:\detokenize{example-9}}
\indexspace
\bigletter{fvm:property:conservation}
\item\relax\sphinxstyleindexentry{fvm:property:conservation}\sphinxstyleindexextra{ch/pde/fvm}\sphinxstyleindexpageref{ch/pde/fvm:\detokenize{fvm:property:conservation}}
\indexspace
\bigletter{matrix\sphinxhyphen{}stability\sphinxhyphen{}spectrum}
\item\relax\sphinxstyleindexentry{matrix\sphinxhyphen{}stability\sphinxhyphen{}spectrum}\sphinxstyleindexextra{ch/ode/lti}\sphinxstyleindexpageref{ch/ode/lti:\detokenize{matrix-stability-spectrum}}
\indexspace
\bigletter{pde:ex:fdm}
\item\relax\sphinxstyleindexentry{pde:ex:fdm}\sphinxstyleindexextra{ch/pde/numerics}\sphinxstyleindexpageref{ch/pde/numerics:\detokenize{pde:ex:fdm}}
\indexspace
\bigletter{pde:ex:fem}
\item\relax\sphinxstyleindexentry{pde:ex:fem}\sphinxstyleindexextra{ch/pde/numerics}\sphinxstyleindexpageref{ch/pde/numerics:\detokenize{pde:ex:fem}}
\indexspace
\bigletter{pde:ex:fvm}
\item\relax\sphinxstyleindexentry{pde:ex:fvm}\sphinxstyleindexextra{ch/pde/numerics}\sphinxstyleindexpageref{ch/pde/numerics:\detokenize{pde:ex:fvm}}
\indexspace
\bigletter{svd\sphinxhyphen{}optimization\sphinxhyphen{}norm}
\item\relax\sphinxstyleindexentry{svd\sphinxhyphen{}optimization\sphinxhyphen{}norm}\sphinxstyleindexextra{ch/linear\sphinxhyphen{}algebra/svd}\sphinxstyleindexpageref{ch/linear-algebra/svd:\detokenize{svd-optimization-norm}}
\indexspace
\bigletter{theorem\sphinxhyphen{}6}
\item\relax\sphinxstyleindexentry{theorem\sphinxhyphen{}6}\sphinxstyleindexextra{ch/complex/analysis}\sphinxstyleindexpageref{ch/complex/analysis:\detokenize{theorem-6}}
\indexspace
\bigletter{thm\sphinxhyphen{}shannon\sphinxhyphen{}nyquist}
\item\relax\sphinxstyleindexentry{thm\sphinxhyphen{}shannon\sphinxhyphen{}nyquist}\sphinxstyleindexextra{ch/complex/fourier\sphinxhyphen{}transforms}\sphinxstyleindexpageref{ch/complex/fourier-transforms:\detokenize{thm-shannon-nyquist}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}